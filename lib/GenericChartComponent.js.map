{"version":3,"file":"GenericChartComponent.js","names":["ALWAYS_TRUE_TYPES","GenericChartComponent","props","context","preCanvasDraw","bind","postCanvasDraw","shouldTypeProceed","preEvaluate","ctx","moreProps","save","margin","ratio","chartConfig","canvasOriginX","origin","left","canvasOriginY","top","width","height","clip","edgeClip","setTransform","scale","beginPath","rect","right","translate","restore","chartConfigList","Array","isArray","chartId","find","each","id","isDefined","ox","oy","mouseXY","x","y","startPos","type","disablePan","indexOf","currentCharts","GenericComponent","propTypes","defaultProps","contextTypes","PropTypes","number","oneOfType","string","isRequired","object"],"sources":["../../src/lib/GenericChartComponent.js"],"sourcesContent":["\r\n\r\nimport PropTypes from \"prop-types\";\r\nimport GenericComponent from \"./GenericComponent\";\r\nimport {\r\n\tisDefined,\r\n\tfind,\r\n} from \"./utils\";\r\n\r\nconst ALWAYS_TRUE_TYPES = [\r\n\t\"drag\",\r\n\t\"dragend\"\r\n];\r\n\r\nclass GenericChartComponent extends GenericComponent {\r\n\tconstructor(props, context) {\r\n\t\tsuper(props, context);\r\n\r\n\t\tthis.preCanvasDraw = this.preCanvasDraw.bind(this);\r\n\t\tthis.postCanvasDraw = this.postCanvasDraw.bind(this);\r\n\t\tthis.shouldTypeProceed = this.shouldTypeProceed.bind(this);\r\n\t\tthis.preEvaluate = this.preEvaluate.bind(this);\r\n\t}\r\n\tpreCanvasDraw(ctx, moreProps) {\r\n\t\tsuper.preCanvasDraw(ctx, moreProps);\r\n\t\tctx.save();\r\n\t\tconst { margin, ratio } = this.context;\r\n\t\tconst { chartConfig } = moreProps;\r\n\r\n\t\tconst canvasOriginX = (0.5 * ratio) + chartConfig.origin[0] + margin.left;\r\n\t\tconst canvasOriginY = (0.5 * ratio) + chartConfig.origin[1] + margin.top;\r\n\r\n\t\tconst { chartConfig: { width, height } } = moreProps;\r\n\t\tconst { clip, edgeClip } = this.props;\r\n\r\n\t\tctx.setTransform(1, 0, 0, 1, 0, 0);\r\n\t\tctx.scale(ratio, ratio);\r\n\t\tif (edgeClip) {\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.rect(-1, canvasOriginY - 10, width + margin.left + margin.right + 1, height + 20);\r\n\t\t\tctx.clip();\r\n\t\t}\r\n\r\n\t\tctx.translate(canvasOriginX, canvasOriginY);\r\n\r\n\t\tif (clip) {\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.rect(-1, -1, width + 1, height + 1);\r\n\t\t\tctx.clip();\r\n\t\t}\r\n\t}\r\n\tpostCanvasDraw(ctx, moreProps) {\r\n\t\tsuper.postCanvasDraw(ctx, moreProps);\r\n\t\tctx.restore();\r\n\t}\r\n\tupdateMoreProps(moreProps) {\r\n\t\tsuper.updateMoreProps(moreProps);\r\n\t\tconst { chartConfig: chartConfigList } = moreProps;\r\n\r\n\t\tif (chartConfigList && Array.isArray(chartConfigList)) {\r\n\t\t\tconst { chartId } = this.context;\r\n\t\t\tconst chartConfig = find(chartConfigList, each => each.id === chartId);\r\n\t\t\tthis.moreProps.chartConfig = chartConfig;\r\n\t\t}\r\n\t\tif (isDefined(this.moreProps.chartConfig)) {\r\n\t\t\tconst { origin: [ox, oy] } = this.moreProps.chartConfig;\r\n\t\t\tif (isDefined(moreProps.mouseXY)) {\r\n\t\t\t\tconst { mouseXY: [x, y] } = moreProps;\r\n\t\t\t\tthis.moreProps.mouseXY = [\r\n\t\t\t\t\tx - ox,\r\n\t\t\t\t\ty - oy\r\n\t\t\t\t];\r\n\t\t\t}\r\n\t\t\tif (isDefined(moreProps.startPos)) {\r\n\t\t\t\tconst { startPos: [x, y] } = moreProps;\r\n\t\t\t\tthis.moreProps.startPos = [\r\n\t\t\t\t\tx - ox,\r\n\t\t\t\t\ty - oy\r\n\t\t\t\t];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tpreEvaluate(/* type, moreProps */) {\r\n\t\t/* if (\r\n\t\t\ttype === \"mousemove\"\r\n\t\t\t&& this.props.onMouseMove\r\n\t\t\t&& isDefined(moreProps)\r\n\t\t\t&& isDefined(moreProps.currentCharts)\r\n\t\t) {\r\n\t\t\tif (moreProps.currentCharts.indexOf(this.context.chartId) === -1) {\r\n\t\t\t\tmoreProps.show = false;\r\n\t\t\t}\r\n\t\t} */\r\n\t}\r\n\tshouldTypeProceed(type, moreProps) {\r\n\t\tif (\r\n\t\t\t(type === \"mousemove\" || type === \"click\")\r\n\t\t\t&& this.props.disablePan) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (\r\n\t\t\tALWAYS_TRUE_TYPES.indexOf(type) === -1\r\n\t\t\t&& isDefined(moreProps)\r\n\t\t\t&& isDefined(moreProps.currentCharts)\r\n\t\t) {\r\n\t\t\treturn (moreProps.currentCharts.indexOf(this.context.chartId) > -1);\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\nGenericChartComponent.propTypes = GenericComponent.propTypes;\r\n\r\nGenericChartComponent.defaultProps = GenericComponent.defaultProps;\r\n\r\nGenericChartComponent.contextTypes = {\r\n\t...GenericComponent.contextTypes,\r\n\tcanvasOriginX: PropTypes.number,\r\n\tcanvasOriginY: PropTypes.number,\r\n\tchartId: PropTypes.oneOfType([PropTypes.number, PropTypes.string]).isRequired,\r\n\tchartConfig: PropTypes.object.isRequired,\r\n\tratio: PropTypes.number.isRequired,\r\n};\r\n\r\nexport default GenericChartComponent;\r\n"],"mappings":"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"}