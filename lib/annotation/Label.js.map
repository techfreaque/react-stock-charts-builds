{"version":3,"file":"Label.js","names":["Label","props","renderSVG","bind","drawOnCanvas","ctx","moreProps","drawOnCanvas2","context","selectCanvas","chartConfig","getYScale","getText","Component","functor","text","Array","isArray","undefined","yScale","propTypes","className","PropTypes","string","func","oneOfType","isRequired","textAnchor","fontFamily","fontSize","number","opacity","rotate","onClick","xAccessor","xScale","datum","object","x","y","contextTypes","canvasOriginX","canvasOriginY","margin","ratio","defaultProps","canvases","bg","save","setTransform","scale","isDefined","translate","left","top","restore","helper","xPos","yPos","fill","radians","Math","PI","font","fillStyle","hexToRGBA","textAlign","beginPath","fillText"],"sources":["../../../src/lib/annotation/Label.js"],"sourcesContent":["\r\n\r\nimport React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport GenericComponent from \"../GenericComponent\";\r\n\r\nimport { isDefined, hexToRGBA, functor } from \"../utils\";\r\nimport LabelAnnotation, { defaultProps, helper } from \"./LabelAnnotation\";\r\n\r\nclass Label extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.renderSVG = this.renderSVG.bind(this);\r\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\r\n\t}\r\n\tdrawOnCanvas(ctx, moreProps) {\r\n\t\tdrawOnCanvas2(ctx, this.props, this.context, moreProps);\r\n\t}\r\n\trender() {\r\n\t\treturn <GenericComponent\r\n\t\t\tcanvasToDraw={this.props.selectCanvas}\r\n\t\t\tsvgDraw={this.renderSVG}\r\n\t\t\tcanvasDraw={this.drawOnCanvas}\r\n\t\t\tdrawOn={[]}\r\n\t\t/>;\r\n\t}\r\n\trenderSVG(moreProps) {\r\n\t\tconst { chartConfig } = moreProps;\r\n\r\n\t\treturn <LabelAnnotation yScale={getYScale(chartConfig)} {...this.props} text={getText(this.props)}/>;\r\n\t}\r\n}\r\n\r\nfunction getText(props) {\r\n\treturn functor(props.text)(props);\r\n}\r\n\r\nfunction getYScale(chartConfig) {\r\n\treturn Array.isArray(chartConfig) ? undefined : chartConfig.yScale;\r\n}\r\n\r\nLabel.propTypes = {\r\n\tclassName: PropTypes.string,\r\n\tselectCanvas: PropTypes.func,\r\n\ttext: PropTypes.oneOfType([\r\n\t\tPropTypes.string,\r\n\t\tPropTypes.func\r\n\t]).isRequired,\r\n\ttextAnchor: PropTypes.string,\r\n\tfontFamily: PropTypes.string,\r\n\tfontSize: PropTypes.number,\r\n\topacity: PropTypes.number,\r\n\trotate: PropTypes.number,\r\n\tonClick: PropTypes.func,\r\n\txAccessor: PropTypes.func,\r\n\txScale: PropTypes.func,\r\n\tyScale: PropTypes.func,\r\n\tdatum: PropTypes.object,\r\n\tx: PropTypes.oneOfType([\r\n\t\tPropTypes.number,\r\n\t\tPropTypes.func\r\n\t]),\r\n\ty: PropTypes.oneOfType([\r\n\t\tPropTypes.number,\r\n\t\tPropTypes.func\r\n\t])\r\n};\r\n\r\nLabel.contextTypes = {\r\n\tcanvasOriginX: PropTypes.number,\r\n\tcanvasOriginY: PropTypes.number,\r\n\r\n\tmargin: PropTypes.object.isRequired,\r\n\tratio: PropTypes.number.isRequired,\r\n};\r\n\r\nLabel.defaultProps = {\r\n\t...defaultProps,\r\n\tselectCanvas: canvases => canvases.bg,\r\n};\r\n\r\nfunction drawOnCanvas2(ctx, props, context, moreProps) {\r\n\tctx.save();\r\n\r\n\tconst { canvasOriginX, canvasOriginY, margin, ratio } = context;\r\n\tctx.setTransform(1, 0, 0, 1, 0, 0);\r\n\tctx.scale(ratio, ratio);\r\n\r\n\r\n\tif (isDefined(canvasOriginX))\r\n\t\tctx.translate(canvasOriginX, canvasOriginY);\r\n\telse\r\n\t\tctx.translate(margin.left + (0.5 * ratio), margin.top + (0.5 * ratio));\r\n\r\n\tdrawOnCanvas(ctx, props, moreProps);\r\n\r\n\tctx.restore();\r\n\r\n}\r\n\r\nfunction drawOnCanvas(ctx, props, moreProps) {\r\n\tconst { textAnchor, fontFamily, fontSize, opacity, rotate } = props;\r\n\tconst { xScale, chartConfig, xAccessor } = moreProps;\r\n\r\n\tconst { xPos, yPos, fill, text } = helper(props, xAccessor, xScale, getYScale(chartConfig));\r\n\r\n\tconst radians = (rotate / 180) * Math.PI;\r\n\tctx.save();\r\n\tctx.translate(xPos, yPos);\r\n\tctx.rotate(radians);\r\n\r\n\tctx.font = `${ fontSize }px ${ fontFamily }`;\r\n\tctx.fillStyle = hexToRGBA(fill, opacity);\r\n\tctx.textAlign = textAnchor === \"middle\" ? \"center\" : textAnchor;\r\n\r\n\tctx.beginPath();\r\n\tctx.fillText(text, 0, 0);\r\n\tctx.restore();\r\n}\r\n\r\n\r\nexport default Label;\r\n"],"mappings":"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"}