{"version":3,"file":"mappedSlidingWindow.js","names":["undefinedValue","undefined","windowSize","accumulator","noop","source","identity","skipInitial","mappedSlidingWindow","data","size","functor","apply","arguments","windowData","accumulatorIdx","undef","result","forEach","d","i","mapped","push","shift","pop","x","length"],"sources":["../../../src/lib/utils/mappedSlidingWindow.js"],"sourcesContent":["\r\n\r\nimport noop from \"./noop\";\r\nimport identity from \"./identity\";\r\nimport { functor } from \"./index\";\r\n\r\nexport default function() {\r\n\r\n\tlet undefinedValue = undefined,\r\n\t\twindowSize = 10,\r\n\t\taccumulator = noop,\r\n\t\tsource = identity,\r\n\t\tskipInitial = 0;\r\n\r\n\t// eslint-disable-next-line prefer-const\r\n\tlet mappedSlidingWindow = function(data) {\r\n\t\tconst size = functor(windowSize).apply(this, arguments);\r\n\t\tconst windowData = [];\r\n\t\tlet accumulatorIdx = 0;\r\n\t\tconst undef = functor(undefinedValue);\r\n\t\t// console.log(skipInitial, size, data.length, windowData.length);\r\n\t\tconst result = [];\r\n\t\tdata.forEach(function(d, i) {\r\n\t\t\t// console.log(d, i, windowData.length);\r\n\t\t\tlet mapped;\r\n\t\t\tif (i < (skipInitial + size - 1)) {\r\n\t\t\t\tmapped = undef(d, i);\r\n\t\t\t\tresult.push(mapped);\r\n\t\t\t\twindowData.push(mapped);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (i >= (skipInitial + size)) {\r\n\t\t\t\t// Treat windowData as FIFO rolling buffer\r\n\t\t\t\twindowData.shift();\r\n\t\t\t}\r\n\t\t\twindowData.push(source(d, i));\r\n\t\t\tmapped = accumulator(windowData, i, accumulatorIdx++);\r\n\t\t\tresult.push(mapped);\r\n\t\t\twindowData.pop();\r\n\t\t\twindowData.push(mapped);\r\n\t\t\treturn;\r\n\t\t});\r\n\t\treturn result;\r\n\t};\r\n\r\n\tmappedSlidingWindow.undefinedValue = function(x) {\r\n\t\tif (!arguments.length) {\r\n\t\t\treturn undefinedValue;\r\n\t\t}\r\n\t\tundefinedValue = x;\r\n\t\treturn mappedSlidingWindow;\r\n\t};\r\n\tmappedSlidingWindow.windowSize = function(x) {\r\n\t\tif (!arguments.length) {\r\n\t\t\treturn windowSize;\r\n\t\t}\r\n\t\twindowSize = x;\r\n\t\treturn mappedSlidingWindow;\r\n\t};\r\n\tmappedSlidingWindow.accumulator = function(x) {\r\n\t\tif (!arguments.length) {\r\n\t\t\treturn accumulator;\r\n\t\t}\r\n\t\taccumulator = x;\r\n\t\treturn mappedSlidingWindow;\r\n\t};\r\n\tmappedSlidingWindow.skipInitial = function(x) {\r\n\t\tif (!arguments.length) {\r\n\t\t\treturn skipInitial;\r\n\t\t}\r\n\t\tskipInitial = x;\r\n\t\treturn mappedSlidingWindow;\r\n\t};\r\n\tmappedSlidingWindow.source = function(x) {\r\n\t\tif (!arguments.length) {\r\n\t\t\treturn source;\r\n\t\t}\r\n\t\tsource = x;\r\n\t\treturn mappedSlidingWindow;\r\n\t};\r\n\r\n\treturn mappedSlidingWindow;\r\n}"],"mappings":";;;;;;;AAEA;;AACA;;AACA;;;;AAEe,oBAAW;EAEzB,IAAIA,cAAc,GAAGC,SAArB;EAAA,IACCC,UAAU,GAAG,EADd;EAAA,IAECC,WAAW,GAAGC,gBAFf;EAAA,IAGCC,MAAM,GAAGC,oBAHV;EAAA,IAICC,WAAW,GAAG,CAJf,CAFyB,CAQzB;;EACA,IAAIC,mBAAmB,GAAG,SAAtBA,mBAAsB,CAASC,IAAT,EAAe;IACxC,IAAMC,IAAI,GAAG,IAAAC,cAAA,EAAQT,UAAR,EAAoBU,KAApB,CAA0B,IAA1B,EAAgCC,SAAhC,CAAb;IACA,IAAMC,UAAU,GAAG,EAAnB;IACA,IAAIC,cAAc,GAAG,CAArB;IACA,IAAMC,KAAK,GAAG,IAAAL,cAAA,EAAQX,cAAR,CAAd,CAJwC,CAKxC;;IACA,IAAMiB,MAAM,GAAG,EAAf;IACAR,IAAI,CAACS,OAAL,CAAa,UAASC,CAAT,EAAYC,CAAZ,EAAe;MAC3B;MACA,IAAIC,MAAJ;;MACA,IAAID,CAAC,GAAIb,WAAW,GAAGG,IAAd,GAAqB,CAA9B,EAAkC;QACjCW,MAAM,GAAGL,KAAK,CAACG,CAAD,EAAIC,CAAJ,CAAd;QACAH,MAAM,CAACK,IAAP,CAAYD,MAAZ;QACAP,UAAU,CAACQ,IAAX,CAAgBD,MAAhB;QACA;MACA;;MACD,IAAID,CAAC,IAAKb,WAAW,GAAGG,IAAxB,EAA+B;QAC9B;QACAI,UAAU,CAACS,KAAX;MACA;;MACDT,UAAU,CAACQ,IAAX,CAAgBjB,MAAM,CAACc,CAAD,EAAIC,CAAJ,CAAtB;MACAC,MAAM,GAAGlB,WAAW,CAACW,UAAD,EAAaM,CAAb,EAAgBL,cAAc,EAA9B,CAApB;MACAE,MAAM,CAACK,IAAP,CAAYD,MAAZ;MACAP,UAAU,CAACU,GAAX;MACAV,UAAU,CAACQ,IAAX,CAAgBD,MAAhB;MACA;IACA,CAnBD;IAoBA,OAAOJ,MAAP;EACA,CA5BD;;EA8BAT,mBAAmB,CAACR,cAApB,GAAqC,UAASyB,CAAT,EAAY;IAChD,IAAI,CAACZ,SAAS,CAACa,MAAf,EAAuB;MACtB,OAAO1B,cAAP;IACA;;IACDA,cAAc,GAAGyB,CAAjB;IACA,OAAOjB,mBAAP;EACA,CAND;;EAOAA,mBAAmB,CAACN,UAApB,GAAiC,UAASuB,CAAT,EAAY;IAC5C,IAAI,CAACZ,SAAS,CAACa,MAAf,EAAuB;MACtB,OAAOxB,UAAP;IACA;;IACDA,UAAU,GAAGuB,CAAb;IACA,OAAOjB,mBAAP;EACA,CAND;;EAOAA,mBAAmB,CAACL,WAApB,GAAkC,UAASsB,CAAT,EAAY;IAC7C,IAAI,CAACZ,SAAS,CAACa,MAAf,EAAuB;MACtB,OAAOvB,WAAP;IACA;;IACDA,WAAW,GAAGsB,CAAd;IACA,OAAOjB,mBAAP;EACA,CAND;;EAOAA,mBAAmB,CAACD,WAApB,GAAkC,UAASkB,CAAT,EAAY;IAC7C,IAAI,CAACZ,SAAS,CAACa,MAAf,EAAuB;MACtB,OAAOnB,WAAP;IACA;;IACDA,WAAW,GAAGkB,CAAd;IACA,OAAOjB,mBAAP;EACA,CAND;;EAOAA,mBAAmB,CAACH,MAApB,GAA6B,UAASoB,CAAT,EAAY;IACxC,IAAI,CAACZ,SAAS,CAACa,MAAf,EAAuB;MACtB,OAAOrB,MAAP;IACA;;IACDA,MAAM,GAAGoB,CAAT;IACA,OAAOjB,mBAAP;EACA,CAND;;EAQA,OAAOA,mBAAP;AACA"}