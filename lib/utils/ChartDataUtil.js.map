{"version":3,"file":"ChartDataUtil.js","names":["getChartOrigin","origin","contextWidth","contextHeight","originCoordinates","getDimensions","chartProps","width","height","chartHeight","availableHeight","values","func","d","obj","isObject","mapObject","isArraySize2AndNumber","yExtentsProp","Array","isArray","length","a","b","getNewChartConfig","innerDimension","children","existingChartConfig","React","Children","map","each","type","toString","Chart","defaultProps","props","id","padding","yExtents","yScaleProp","yScale","flipYScale","yExtentsCalculator","copy","yPan","yPanEnabled","isDefined","functor","undefined","prevChartConfig","find","shallowEqual","originalYExtentsProp","domain","filter","getCurrentCharts","chartConfig","mouseXY","currentCharts","eachConfig","top","bottom","config","setRange","scale","rangeRoundPoints","isNotDefined","invert","isNaN","Error","rangeRound","range","yDomainFromYExtents","plotData","yValues","eachExtent","allYValues","flattenDeep","realYDomain","extent","set","getChartConfigWithUpdatedYScales","xDomain","dy","chartsToPan","xAccessor","displayXAccessor","fullData","yDomains","yDomainDY","prevYDomain","combine","zipper","another","indexOf","newYScale","updatedChartConfig","getCurrentItem","xScale","xValue","item","getClosestItem","idx","x","Math","abs","reduce","getXValue","last","value","round"],"sources":["../../../src/lib/utils/ChartDataUtil.js"],"sourcesContent":["\r\n\r\nimport React from \"react\";\r\nimport { extent } from \"d3-array\";\r\nimport { set } from \"d3-collection\";\r\nimport flattenDeep from \"lodash.flattendeep\";\r\n\r\nimport Chart from \"../Chart\";\r\n\r\nimport {\r\n\tlast,\r\n\tisObject,\r\n\tgetClosestItem,\r\n\tzipper,\r\n\tisDefined,\r\n\tisNotDefined,\r\n\tfunctor,\r\n\tmapObject,\r\n\tfind,\r\n\tshallowEqual\r\n} from \"./index\";\r\n\r\nexport function getChartOrigin(origin, contextWidth, contextHeight) {\r\n\tconst originCoordinates = typeof origin === \"function\"\r\n\t\t? origin(contextWidth, contextHeight)\r\n\t\t: origin;\r\n\treturn originCoordinates;\r\n}\r\n\r\nexport function getDimensions({ width, height }, chartProps) {\r\n\r\n\tconst chartHeight = (chartProps.height || height);\r\n\r\n\treturn {\r\n\t\tavailableHeight: height,\r\n\t\twidth,\r\n\t\theight: chartHeight\r\n\t};\r\n}\r\n\r\nfunction values(func) {\r\n\treturn (d) => {\r\n\t\tconst obj = func(d);\r\n\t\tif (isObject(obj)) {\r\n\t\t\treturn mapObject(obj);\r\n\t\t}\r\n\t\treturn obj;\r\n\t};\r\n}\r\n\r\nfunction isArraySize2AndNumber(yExtentsProp) {\r\n\tif (Array.isArray(yExtentsProp) && yExtentsProp.length === 2) {\r\n\t\tconst [a, b] = yExtentsProp;\r\n\t\treturn (typeof a == \"number\" && typeof b == \"number\");\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nexport function getNewChartConfig(innerDimension, children, existingChartConfig = []) {\r\n\treturn React.Children.map(children, (each) => {\r\n\t\tif (each && each.type.toString() === Chart.toString()) {\r\n\t\t\tconst chartProps = {\r\n\t\t\t\t...Chart.defaultProps,\r\n\t\t\t\t...each.props\r\n\t\t\t};\r\n\t\t\tconst {\r\n\t\t\t\tid,\r\n\t\t\t\torigin,\r\n\t\t\t\tpadding,\r\n\t\t\t\tyExtents: yExtentsProp,\r\n\t\t\t\tyScale: yScaleProp,\r\n\t\t\t\tflipYScale,\r\n\t\t\t\tyExtentsCalculator\r\n\t\t\t} = chartProps;\r\n\r\n\t\t\tconst yScale = yScaleProp.copy();\r\n\t\t\tconst {\r\n\t\t\t\twidth, height, availableHeight\r\n\t\t\t} = getDimensions(innerDimension, chartProps);\r\n\r\n\t\t\tconst { yPan } = chartProps;\r\n\t\t\tlet { yPanEnabled } = chartProps;\r\n\t\t\t// var { yMousePointerRectWidth: rectWidth, yMousePointerRectHeight: rectHeight, yMousePointerArrowWidth: arrowWidth } = each.props;\r\n\t\t\t// var mouseCoordinates = { at, yDisplayFormat, rectHeight, rectWidth, arrowWidth };\r\n\t\t\tconst yExtents = isDefined(yExtentsProp)\r\n\t\t\t\t? (Array.isArray(yExtentsProp) ? yExtentsProp : [yExtentsProp]).map(functor)\r\n\t\t\t\t: undefined;\r\n\r\n\t\t\tconst prevChartConfig = find(existingChartConfig, d => d.id === id);\r\n\r\n\t\t\tif (isArraySize2AndNumber(yExtentsProp)) {\r\n\t\t\t\tif (\r\n\t\t\t\t\tisDefined(prevChartConfig)\r\n\t\t\t\t\t&& prevChartConfig.yPan\r\n\t\t\t\t\t&& prevChartConfig.yPanEnabled\r\n\t\t\t\t\t&& yPan\r\n\t\t\t\t\t&& yPanEnabled\r\n\t\t\t\t\t&& shallowEqual(prevChartConfig.originalYExtentsProp, yExtentsProp)\r\n\t\t\t\t) {\r\n\t\t\t\t\t// console.log(prevChartConfig.originalYExtentsProp, yExtentsProp)\r\n\t\t\t\t\t// console.log(prevChartConfig.yScale.domain())\r\n\t\t\t\t\tyScale.domain(prevChartConfig.yScale.domain());\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst [a, b] = yExtentsProp;\r\n\t\t\t\t\tyScale.domain([a, b]);\r\n\t\t\t\t}\r\n\t\t\t} else if (isDefined(prevChartConfig) && prevChartConfig.yPanEnabled) {\r\n\t\t\t\tif (isArraySize2AndNumber(prevChartConfig.originalYExtentsProp)) {\r\n\t\t\t\t\t// do nothing\r\n\t\t\t\t} else {\r\n\t\t\t\t\tyScale.domain(prevChartConfig.yScale.domain());\r\n\t\t\t\t\tyPanEnabled = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\tid,\r\n\t\t\t\torigin: functor(origin)(width, availableHeight),\r\n\t\t\t\tpadding,\r\n\t\t\t\toriginalYExtentsProp: yExtentsProp,\r\n\t\t\t\tyExtents,\r\n\t\t\t\tyExtentsCalculator,\r\n\t\t\t\tflipYScale,\r\n\t\t\t\t// yScale: setRange(yScale.copy(), height, padding, flipYScale),\r\n\t\t\t\tyScale: yScale,\r\n\t\t\t\tyPan,\r\n\t\t\t\tyPanEnabled,\r\n\t\t\t\t// mouseCoordinates,\r\n\t\t\t\twidth,\r\n\t\t\t\theight\r\n\t\t\t};\r\n\t\t}\r\n\t\treturn undefined;\r\n\t}).filter(each => isDefined(each));\r\n}\r\nexport function getCurrentCharts(chartConfig, mouseXY) {\r\n\tconst currentCharts = chartConfig.filter(eachConfig => {\r\n\t\tconst top = eachConfig.origin[1];\r\n\t\tconst bottom = top + eachConfig.height;\r\n\t\treturn (mouseXY[1] > top && mouseXY[1] < bottom);\r\n\t}).map(config => config.id);\r\n\r\n\treturn currentCharts;\r\n}\r\n\r\nfunction setRange(scale, height, padding, flipYScale) {\r\n\tif (scale.rangeRoundPoints || isNotDefined(scale.invert)) {\r\n\t\tif (isNaN(padding)) throw new Error(\"padding has to be a number for ordinal scale\");\r\n\t\tif (scale.rangeRoundPoints) scale.rangeRoundPoints(flipYScale ? [0, height] : [height, 0], padding);\r\n\t\tif (scale.rangeRound) scale.range(flipYScale ? [0, height] : [height, 0]).padding(padding);\r\n\t} else {\r\n\t\tconst { top, bottom } = isNaN(padding)\r\n\t\t\t? padding\r\n\t\t\t: { top: padding, bottom: padding };\r\n\r\n\t\tscale.range(flipYScale ? [top, height - bottom] : [height - bottom, top]);\r\n\t}\r\n\treturn scale;\r\n}\r\n\r\nfunction yDomainFromYExtents(yExtents, yScale, plotData) {\r\n\tconst yValues = yExtents.map(eachExtent =>\r\n\t\tplotData.map(values(eachExtent)));\r\n\r\n\tconst allYValues = flattenDeep(yValues);\r\n\t// console.log(allYValues)\r\n\tconst realYDomain = (yScale.invert)\r\n\t\t? extent(allYValues)\r\n\t\t: set(allYValues).values();\r\n\r\n\treturn realYDomain;\r\n}\r\n\r\n\r\nexport function getChartConfigWithUpdatedYScales(\r\n\tchartConfig,\r\n\t{ plotData, xAccessor, displayXAccessor, fullData },\r\n\txDomain,\r\n\tdy,\r\n\tchartsToPan\r\n) {\r\n\tconst yDomains = chartConfig\r\n\t\t.map(({ yExtentsCalculator, yExtents, yScale }) => {\r\n\r\n\t\t\tconst realYDomain = isDefined(yExtentsCalculator)\r\n\t\t\t\t? yExtentsCalculator({ plotData, xDomain, xAccessor, displayXAccessor, fullData })\r\n\t\t\t\t: yDomainFromYExtents(yExtents, yScale, plotData);\r\n\r\n\t\t\t// console.log(\"yScale.domain() ->\", yScale.domain())\r\n\r\n\t\t\tconst yDomainDY = isDefined(dy)\r\n\t\t\t\t? yScale.range().map(each => each - dy).map(yScale.invert)\r\n\t\t\t\t: yScale.domain();\r\n\t\t\treturn {\r\n\t\t\t\trealYDomain,\r\n\t\t\t\tyDomainDY,\r\n\t\t\t\tprevYDomain: yScale.domain(),\r\n\t\t\t};\r\n\t\t});\r\n\r\n\tconst combine = zipper()\r\n\t\t.combine((config, { realYDomain, yDomainDY, prevYDomain }) => {\r\n\t\t\tconst { id, padding, height, yScale, yPan, flipYScale, yPanEnabled = false } = config;\r\n\r\n\t\t\tconst another = isDefined(chartsToPan)\r\n\t\t\t\t? chartsToPan.indexOf(id) > -1\r\n\t\t\t\t: true;\r\n\t\t\tconst domain = yPan && yPanEnabled\r\n\t\t\t\t? another ? yDomainDY : prevYDomain\r\n\t\t\t\t: realYDomain;\r\n\r\n\t\t\t// console.log(id, yPan, yPanEnabled, another);\r\n\t\t\t// console.log(domain, realYDomain, prevYDomain);\r\n\t\t\tconst newYScale = setRange(\r\n\t\t\t\tyScale.copy().domain(domain), height, padding, flipYScale\r\n\t\t\t);\r\n\t\t\treturn {\r\n\t\t\t\t...config,\r\n\t\t\t\tyScale: newYScale,\r\n\t\t\t\trealYDomain: realYDomain,\r\n\t\t\t};\r\n\t\t\t// return { ...config, yScale: yScale.copy().domain(domain).range([height - padding, padding]) };\r\n\t\t});\r\n\r\n\tconst updatedChartConfig = combine(chartConfig, yDomains);\r\n\t// console.error(yDomains, dy, chartsToPan, updatedChartConfig.map(d => d.yScale.domain()));\r\n\t// console.log(updatedChartConfig.map(d => ({ id: d.id, domain: d.yScale.domain() })))\r\n\r\n\treturn updatedChartConfig;\r\n}\r\n\r\nexport function getCurrentItem(xScale, xAccessor, mouseXY, plotData) {\r\n\tlet xValue, item;\r\n\tif (xScale.invert) {\r\n\t\txValue = xScale.invert(mouseXY[0]);\r\n\t\titem = getClosestItem(plotData, xValue, xAccessor);\r\n\t} else {\r\n\t\tconst d = xScale.range().map((d, idx) => ({ x: Math.abs(d - mouseXY[0]), idx })).reduce((a, b) => a.x < b.x ? a : b);\r\n\t\titem = isDefined(d) ? plotData[d.idx] : plotData[0];\r\n\t\t// console.log(d, item);\r\n\t}\r\n\treturn item;\r\n}\r\n\r\nexport function getXValue(xScale, xAccessor, mouseXY, plotData) {\r\n\r\n\tlet xValue, item;\r\n\tif (xScale.invert) {\r\n\t\txValue = xScale.invert(mouseXY[0]);\r\n\t\tif (xValue > xAccessor(last(plotData)) && xScale.value) {\r\n\t\t\treturn Math.round(xValue);\r\n\t\t} else {\r\n\t\t\titem = getClosestItem(plotData, xValue, xAccessor);\r\n\t\t}\r\n\t} else {\r\n\t\tconst d = xScale.range().map((d, idx) => ({ x: Math.abs(d - mouseXY[0]), idx })).reduce((a, b) => a.x < b.x ? a : b);\r\n\t\titem = isDefined(d) ? plotData[d.idx] : plotData[0];\r\n\t\t// console.log(d, item);\r\n\t}\r\n\treturn xAccessor(item);\r\n}\r\n"],"mappings":"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"}