{"version":3,"file":"SARSeries.js","names":["SARSeries","props","renderSVG","bind","drawOnCanvas","isHover","moreProps","mouseXY","currentItem","yScale","chartConfig","yAccessor","y","currentY","ctx","fill","opacity","xAccessor","plotData","xScale","hovering","width","last","first","d","length","radius","Math","min","max","forEach","each","centerX","centerY","color","close","falling","rising","fillStyle","hexToRGBA","strokeStyle","beginPath","ellipse","PI","closePath","stroke","className","filter","isDefined","map","idx","highlightOnHover","hoverProps","drawOn","canvasToDraw","getMouseCanvas","getAxisCanvas","onClick","onDoubleClick","onContextMenu","Component","propTypes","PropTypes","string","object","isRequired","func","number","bool","defaultProps","e","console","log"],"sources":["../../../src/lib/series/SARSeries.js"],"sourcesContent":["\r\n\r\nimport React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport GenericChartComponent from \"../GenericChartComponent\";\r\nimport { getAxisCanvas, getMouseCanvas } from \"../GenericComponent\";\r\n\r\nimport { isDefined, first, last, hexToRGBA } from \"../utils\";\r\n\r\nclass SARSeries extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.renderSVG = this.renderSVG.bind(this);\r\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\r\n\t\tthis.isHover = this.isHover.bind(this);\r\n\t}\r\n\tisHover(moreProps) {\r\n\t\tconst { mouseXY, currentItem, chartConfig: { yScale } } = moreProps;\r\n\t\tconst { yAccessor } = this.props;\r\n\t\tconst y = mouseXY[1];\r\n\t\tconst currentY = yScale(yAccessor(currentItem));\r\n\t\treturn y <  currentY + 5 && y > currentY - 5;\r\n\t}\r\n\tdrawOnCanvas(ctx, moreProps) {\r\n\t\tconst { yAccessor, fill, opacity } = this.props;\r\n\t\tconst { xAccessor, plotData, xScale, chartConfig: { yScale }, hovering } = moreProps;\r\n\r\n\t\tconst width = xScale(xAccessor(last(plotData))) - xScale(xAccessor(first(plotData)));\r\n\r\n\t\tconst d = (width / plotData.length) * 0.5 / 2;\r\n\t\tconst radius = Math.min(2, Math.max(0.5,  d)) + (hovering ? 2 : 0);\r\n\r\n\t\tplotData.forEach(each => {\r\n\t\t\tconst centerX = xScale(xAccessor(each));\r\n\t\t\tconst centerY = yScale(yAccessor(each));\r\n\t\t\tconst color = yAccessor(each) > each.close\r\n\t\t\t\t? fill.falling\r\n\t\t\t\t: fill.rising;\r\n\r\n\t\t\tctx.fillStyle = hexToRGBA(color, opacity);\r\n\t\t\tctx.strokeStyle = color;\r\n\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.ellipse(centerX, centerY, radius, radius, 0, 0, 2 * Math.PI);\r\n\t\t\tctx.closePath();\r\n\t\t\tctx.fill();\r\n\t\t\tctx.stroke();\r\n\t\t});\r\n\t}\r\n\trenderSVG(moreProps) {\r\n\t\tconst { className, yAccessor } = this.props;\r\n\t\tconst { xAccessor, plotData, xScale, chartConfig: { yScale } } = moreProps;\r\n\t\t// console.log(moreProps);\r\n\r\n\t\treturn <g className={className}>\r\n\t\t\t{plotData\r\n\t\t\t\t.filter(each => isDefined(yAccessor(each)))\r\n\t\t\t\t.map((each, idx) => {\r\n\t\t\t\t\treturn <circle key={idx} cx={xScale(xAccessor(each))}\r\n\t\t\t\t\t\tcy={yScale(yAccessor(each))} r={3} fill=\"green\" />;\r\n\t\t\t\t})}\r\n\t\t</g>;\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { highlightOnHover } = this.props;\r\n\t\tconst hoverProps = highlightOnHover\r\n\t\t\t? {\r\n\t\t\t\tisHover: this.isHover,\r\n\t\t\t\tdrawOn: [\"mousemove\", \"pan\"],\r\n\t\t\t\tcanvasToDraw: getMouseCanvas\r\n\t\t\t}\r\n\t\t\t: {\r\n\t\t\t\tdrawOn: [\"pan\"],\r\n\t\t\t\tcanvasToDraw: getAxisCanvas\r\n\t\t\t};\r\n\r\n\t\treturn <GenericChartComponent\r\n\t\t\tsvgDraw={this.renderSVG}\r\n\r\n\t\t\tcanvasDraw={this.drawOnCanvas}\r\n\r\n\t\t\tonClickWhenHover={this.props.onClick}\r\n\t\t\tonDoubleClickWhenHover={this.props.onDoubleClick}\r\n\t\t\tonContextMenuWhenHover={this.props.onContextMenu}\r\n\t\t\t{...hoverProps}\r\n\t\t/>;\r\n\t}\r\n}\r\n\r\nSARSeries.propTypes = {\r\n\tclassName: PropTypes.string,\r\n\tfill: PropTypes.object.isRequired,\r\n\tyAccessor: PropTypes.func.isRequired,\r\n\topacity: PropTypes.number.isRequired,\r\n\tonClick: PropTypes.func,\r\n\tonDoubleClick: PropTypes.func,\r\n\tonContextMenu: PropTypes.func,\r\n\thighlightOnHover: PropTypes.bool,\r\n};\r\n\r\nSARSeries.defaultProps = {\r\n\tclassName: \"react-stockcharts-sar\",\r\n\tfill: {\r\n\t\tfalling: \"#4682B4\",\r\n\t\trising: \"#15EC2E\",\r\n\t},\r\n\thighlightOnHover: true,\r\n\topacity: 0.2,\r\n\tonClick: function(e) { console.log(\"Click\", e); },\r\n\tonDoubleClick: function(e) { console.log(\"Double Click\", e); },\r\n\tonContextMenu: function(e) { console.log(\"Right Click\", e); },\r\n};\r\n\r\nexport default SARSeries;\r\n"],"mappings":"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"}