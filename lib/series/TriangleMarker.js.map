{"version":3,"file":"TriangleMarker.js","names":["Triangle","props","className","strokeWidth","opacity","point","width","rotation","getRotationInDegrees","fillColor","getFillColor","strokeColor","getStrokeColor","w","functor","datum","x","y","getTrianglePoints","innerOpposite","innerHypotenuse","points","propTypes","direction","PropTypes","oneOfType","oneOf","func","isRequired","stroke","string","fill","number","shape","object","defaultProps","drawOnCanvas","ctx","strokeStyle","lineWidth","fillStyle","hexToRGBA","drawOnCanvasWithNoStateChange","rotationDeg","beginPath","moveTo","lineTo","save","translate","rotate","Math","PI","restore","cos","tan","Function","directionVal"],"sources":["../../../src/lib/series/TriangleMarker.js"],"sourcesContent":["import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { hexToRGBA, functor } from \"../utils\";\r\n\r\nfunction Triangle(props) {\r\n\r\n\tconst {\r\n\t\tclassName, strokeWidth,\r\n\t\topacity, point, width\r\n\t} = props;\r\n\r\n\tconst rotation = getRotationInDegrees(props, point);\r\n\tif (rotation == null) return null;\r\n\r\n\tconst fillColor = getFillColor(props);\r\n\tconst strokeColor = getStrokeColor(props);\r\n\r\n\tconst w = functor(width)(point.datum);\r\n\tconst { x, y } = point;\r\n\tconst { innerOpposite, innerHypotenuse } = getTrianglePoints(w);\r\n\tconst points = `\r\n\t\t${x} ${y - innerHypotenuse},\r\n\t\t${x + (w / 2)} ${y + innerOpposite},\r\n\t\t${x - (w / 2)} ${y + innerOpposite}\r\n\t`;\r\n\r\n\treturn (\r\n\t\t<polygon\r\n\t\t\tclassName={className}\r\n\t\t\tpoints={points}\r\n\t\t\tstroke={strokeColor}\r\n\t\t\tstrokeWidth={strokeWidth}\r\n\t\t\tfillOpacity={opacity}\r\n\t\t\tfill={fillColor}\r\n\t\t\ttransform={rotation !== 0 ? `rotate(${ rotation }, ${ x }, ${ y })` : null}\r\n\t\t/>\r\n\t);\r\n}\r\nTriangle.propTypes = {\r\n\tdirection: PropTypes.oneOfType( [\r\n\t\tPropTypes.oneOf( [\r\n\t\t\t\"top\",\r\n\t\t\t\"bottom\",\r\n\t\t\t\"left\",\r\n\t\t\t\"right\",\r\n\t\t\t\"hide\"] ),\r\n\t\tPropTypes.func\r\n\t] ).isRequired,\r\n\tstroke: PropTypes.oneOfType( [\r\n\t\tPropTypes.string,\r\n\t\tPropTypes.func\r\n\t] ).isRequired,\r\n\tfill: PropTypes.oneOfType( [\r\n\t\tPropTypes.string,\r\n\t\tPropTypes.func\r\n\t] ).isRequired,\r\n\topacity: PropTypes.number.isRequired,\r\n\tpoint: PropTypes.shape({\r\n\t\tx: PropTypes.number.isRequired,\r\n\t\ty: PropTypes.number.isRequired,\r\n\t\tdatum: PropTypes.object.isRequired,\r\n\t}).isRequired,\r\n\tclassName: PropTypes.string,\r\n\tstrokeWidth: PropTypes.number,\r\n\twidth: PropTypes.oneOfType([\r\n\t\tPropTypes.number,\r\n\t\tPropTypes.func\r\n\t]).isRequired\r\n};\r\nTriangle.defaultProps = {\r\n\tdirection: \"top\",\r\n\tstroke: \"#4682B4\",\r\n\tstrokeWidth: 1,\r\n\topacity: 0.5,\r\n\tfill: \"#4682B4\",\r\n\tclassName: \"react-stockcharts-marker-triangle\",\r\n};\r\nTriangle.drawOnCanvas = (props, point, ctx) => {\r\n\tconst { stroke, fill, opacity, strokeWidth } = props;\r\n\tctx.strokeStyle = stroke;\r\n\tctx.lineWidth = strokeWidth;\r\n\tif (fill !== \"none\") {\r\n\t\tctx.fillStyle = hexToRGBA(fill, opacity);\r\n\t}\r\n\tTriangle.drawOnCanvasWithNoStateChange(props, point, ctx);\r\n};\r\nTriangle.drawOnCanvasWithNoStateChange = (props, point, ctx) => {\r\n\r\n\tconst { width } = props;\r\n\tconst w = functor(width)(point.datum);\r\n\tconst { x, y } = point;\r\n\tconst { innerOpposite, innerHypotenuse } = getTrianglePoints(w);\r\n\tconst rotationDeg = getRotationInDegrees(props, point);\r\n\r\n\tctx.beginPath();\r\n\tctx.moveTo(x, y - innerHypotenuse);\r\n\tctx.lineTo(x + (w / 2), y + innerOpposite);\r\n\tctx.lineTo(x - (w / 2), y + innerOpposite);\r\n\tctx.stroke();\r\n\r\n\t// TODO: rotation does not work\r\n\t// example: https://gist.github.com/geoffb/6392450\r\n\tif ( rotationDeg !== null && rotationDeg !== 0 ) {\r\n\t\tctx.save();\r\n\t\tctx.translate(x, y);\r\n\t\tctx.rotate(rotationDeg * Math.PI / 180); // 45 degrees\r\n\t\tctx.fill();\r\n\t\tctx.restore();\r\n\t}\r\n\tctx.fill();\r\n};\r\nexport default Triangle;\r\n\r\nfunction getTrianglePoints(width) {\r\n\tconst innerHypotenuse = (width / 2) * (1 / Math.cos(30 * Math.PI / 180));\r\n\tconst innerOpposite = (width / 2) * (1 / Math.tan(60 * Math.PI / 180));\r\n\treturn {\r\n\t\tinnerOpposite,\r\n\t\tinnerHypotenuse\r\n\t};\r\n}\r\n\r\nfunction getFillColor( props ) {\r\n\tconst { fill, point } = props;\r\n\treturn fill instanceof Function ? fill( point.datum ) : fill;\r\n}\r\n\r\nfunction getStrokeColor( props ) {\r\n\tconst { stroke, point } = props;\r\n\treturn stroke instanceof Function ? stroke( point.datum ) : stroke;\r\n}\r\n\r\nfunction getRotationInDegrees( props, point ) {\r\n\tconst { direction } = props;\r\n\tconst directionVal = direction instanceof Function ? direction( point.datum ) : direction;\r\n\tif ( directionVal === \"hide\" ) return null;\r\n\r\n\tlet rotate = 0;\r\n\tswitch ( directionVal ) {\r\n\t\tcase \"bottom\":\r\n\t\t\trotate = 180;\r\n\t\t\tbreak;\r\n\t\tcase \"left\":\r\n\t\t\trotate = -90;\r\n\t\t\tbreak;\r\n\t\tcase \"right\":\r\n\t\t\trotate = 90;\r\n\t\t\tbreak;\r\n\t}\r\n\treturn rotate;\r\n}\r\n"],"mappings":"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"}