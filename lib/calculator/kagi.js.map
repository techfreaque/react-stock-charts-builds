{"version":3,"file":"kagi.js","names":["options","defaultOptions","dateAccessor","d","date","dateMutator","calculator","data","reversalType","windowSize","reversal","sourcePath","source","path","reversalThreshold","atrAlgorithm","atr","atrCalculator","merge","algorithm","c","functor","kagiData","prevPeak","prevTrough","direction","line","forEach","isNotDefined","from","open","high","low","close","startOfYear","startOfQuarter","startOfMonth","startOfWeek","volume","Math","max","min","to","priceMovement","changePoint","startAs","changeTo","abs","nextLineOpen","nextChangePoint","nextChangeTo","added","push","undefined","current","dir","reverseAt","x","arguments","length"],"sources":["../../../src/lib/calculator/kagi.js"],"sourcesContent":["\r\n\r\nimport { merge, isNotDefined, path, functor } from \"../utils\";\r\nimport atr from \"./atr\";\r\n\r\nimport { Kagi as defaultOptions } from \"./defaultOptionsForComputation\";\r\n\r\nexport default function() {\r\n\r\n\tlet options = defaultOptions;\r\n\tlet dateAccessor = d => d.date;\r\n\tlet dateMutator = (d, date) => { d.date = date; };\r\n\r\n\tfunction calculator(data) {\r\n\t\tconst { reversalType, windowSize, reversal, sourcePath } = options;\r\n\r\n\t\tconst source = path(sourcePath);\r\n\t\tlet reversalThreshold;\r\n\r\n\t\tif (reversalType === \"ATR\") {\r\n\t\t\t// calculateATR(rawData, period);\r\n\t\t\tconst atrAlgorithm = atr().options({ windowSize });\r\n\r\n\t\t\tconst atrCalculator = merge()\r\n\t\t\t\t.algorithm(atrAlgorithm)\r\n\t\t\t\t.merge((d, c) => { d[\"atr\" + windowSize] = c; } );\r\n\r\n\t\t\tatrCalculator(data);\r\n\t\t\treversalThreshold = d => d[\"atr\" + windowSize];\r\n\t\t} else {\r\n\t\t\treversalThreshold = functor(reversal);\r\n\t\t}\r\n\r\n\t\tconst kagiData = [];\r\n\r\n\t\tlet prevPeak, prevTrough, direction;\r\n\t\tlet line = {};\r\n\r\n\t\tdata.forEach(function(d) {\r\n\t\t\tif (isNotDefined(line.from)) {\r\n\t\t\t\tdateMutator(line, dateAccessor(d));\r\n\t\t\t\tline.from = dateAccessor(d);\r\n\r\n\t\t\t\tif (!line.open) line.open = d.open;\r\n\t\t\t\tline.high = d.high;\r\n\t\t\t\tline.low = d.low;\r\n\t\t\t\tif (!line.close) line.close = source(d);\r\n\t\t\t\tline.startOfYear = d.startOfYear;\r\n\t\t\t\tline.startOfQuarter = d.startOfQuarter;\r\n\t\t\t\tline.startOfMonth = d.startOfMonth;\r\n\t\t\t\tline.startOfWeek = d.startOfWeek;\r\n\t\t\t}\r\n\r\n\t\t\tif (!line.startOfYear) {\r\n\t\t\t\tline.startOfYear = d.startOfYear;\r\n\t\t\t\tif (line.startOfYear) {\r\n\t\t\t\t\tline.date = d.date;\r\n\t\t\t\t\t// line.displayDate = d.displayDate;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!line.startOfQuarter) {\r\n\t\t\t\tline.startOfQuarter = d.startOfQuarter;\r\n\t\t\t\tif (line.startOfQuarter && !line.startOfYear) {\r\n\t\t\t\t\tline.date = d.date;\r\n\t\t\t\t\t// line.displayDate = d.displayDate;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!line.startOfMonth) {\r\n\t\t\t\tline.startOfMonth = d.startOfMonth;\r\n\t\t\t\tif (line.startOfMonth && !line.startOfQuarter) {\r\n\t\t\t\t\tline.date = d.date;\r\n\t\t\t\t\t// line.displayDate = d.displayDate;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!line.startOfWeek) {\r\n\t\t\t\tline.startOfWeek = d.startOfWeek;\r\n\t\t\t\tif (line.startOfWeek && !line.startOfMonth) {\r\n\t\t\t\t\tline.date = d.date;\r\n\t\t\t\t\t// line.displayDate = d.displayDate;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tline.volume = (line.volume || 0) + d.volume;\r\n\t\t\tline.high = Math.max(line.high, d.high);\r\n\t\t\tline.low = Math.min(line.low, d.low);\r\n\t\t\tline.to = dateAccessor(d);\r\n\r\n\t\t\tconst priceMovement = (source(d) - line.close);\r\n\r\n\t\t\t// console.log(source(d), priceMovement)\r\n\t\t\tif ((line.close >= line.open /* going up */ && priceMovement > 0 /* and moving in same direction */)\r\n\t\t\t\t\t|| (line.close < line.open /* going down */ && priceMovement < 0 /* and moving in same direction */)) {\r\n\t\t\t\tline.close = source(d);\r\n\t\t\t\tif (prevTrough && line.close < prevTrough) {\r\n\t\t\t\t\t// going below the prevTrough, so change from yang to yin\r\n\t\t\t\t\t// A yin line forms when a Kagi line breaks below the prior trough.\r\n\t\t\t\t\tline.changePoint = prevTrough;\r\n\t\t\t\t\tif (line.startAs !== \"yin\") {\r\n\t\t\t\t\t\tline.changeTo = \"yin\";\r\n\t\t\t\t\t\t// line.startAs = \"yang\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (prevPeak && line.close > prevPeak) {\r\n\t\t\t\t\t// going above the prevPeak, so change from yin to yang\r\n\t\t\t\t\t// A yang line forms when a Kagi line breaks above the prior peak\r\n\t\t\t\t\tline.changePoint = prevPeak;\r\n\t\t\t\t\tif (line.startAs !== \"yang\") {\r\n\t\t\t\t\t\tline.changeTo = \"yang\";\r\n\t\t\t\t\t\t// line.startAs = \"yin\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if ((line.close >= line.open /* going up */\r\n\t\t\t\t\t\t\t&& priceMovement < 0 /* and moving in other direction */\r\n\t\t\t\t\t\t\t&& Math.abs(priceMovement) > reversalThreshold(d) /* and the movement is big enough for reversal */)\r\n\t\t\t\t\t|| (line.close < line.open /* going down */\r\n\t\t\t\t\t\t\t&& priceMovement > 0 /* and moving in other direction */\r\n\t\t\t\t\t\t\t&& Math.abs(priceMovement) > reversalThreshold(d) /* and the movement is big enough for reversal */)) {\r\n\t\t\t\t// reverse direction\r\n\t\t\t\tconst nextLineOpen = line.close;\r\n\r\n\t\t\t\tdirection = (line.close - line.open) / Math.abs(line.close - line.open);\r\n\r\n\t\t\t\tlet nextChangePoint, nextChangeTo;\r\n\t\t\t\tif (direction < 0 /* if direction so far has been -ve*/) {\r\n\t\t\t\t\t// compare with line.close becomes prevTrough\r\n\t\t\t\t\tif (isNotDefined(prevPeak)) prevPeak = line.open;\r\n\t\t\t\t\tprevTrough = line.close;\r\n\t\t\t\t\tif (source(d) > prevPeak) {\r\n\t\t\t\t\t\tnextChangePoint = prevPeak;\r\n\t\t\t\t\t\tnextChangeTo = \"yang\";\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (isNotDefined(prevTrough)) prevTrough = line.open;\r\n\t\t\t\t\tprevPeak = line.close;\r\n\t\t\t\t\tif (source(d) < prevTrough) {\r\n\t\t\t\t\t\tnextChangePoint = prevTrough;\r\n\t\t\t\t\t\tnextChangeTo = \"yin\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (isNotDefined(line.startAs)) {\r\n\t\t\t\t\tline.startAs = direction > 0 ? \"yang\" : \"yin\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst startAs = line.changeTo || line.startAs;\r\n\t\t\t\tline.added = true;\r\n\t\t\t\tkagiData.push(line);\r\n\t\t\t\tdirection = -1 * direction; // direction is reversed\r\n\r\n\t\t\t\tline = { ...line };\r\n\t\t\t\tline.open = nextLineOpen;\r\n\t\t\t\tline.close = source(d);\r\n\t\t\t\tline.startAs = startAs;\r\n\t\t\t\tline.changePoint = nextChangePoint;\r\n\t\t\t\tline.changeTo = nextChangeTo;\r\n\t\t\t\tline.added = false;\r\n\t\t\t\tline.from = undefined;\r\n\t\t\t\tline.volume = 0;\r\n\t\t\t} else {\r\n\t\t\t\t// console.log(\"MOVING IN REV DIR BUT..\", line.open, line.close, source(d));\r\n\t\t\t}\r\n\t\t\tline.current = source(d);\r\n\t\t\tlet dir = line.close - line.open;\r\n\t\t\tdir = dir === 0 ? 1 : dir / Math.abs(dir);\r\n\t\t\tline.reverseAt = dir > 0 ? line.close - reversalThreshold(d) : line.open - reversalThreshold(d);\r\n\t\t});\r\n\t\tif (!line.added) kagiData.push(line);\r\n\r\n\t\treturn kagiData;\r\n\t}\r\n\tcalculator.options = function(x) {\r\n\t\tif (!arguments.length) {\r\n\t\t\treturn options;\r\n\t\t}\r\n\t\toptions = { ...defaultOptions, ...x };\r\n\t\treturn calculator;\r\n\t};\r\n\tcalculator.dateMutator = function(x) {\r\n\t\tif (!arguments.length) return dateMutator;\r\n\t\tdateMutator = x;\r\n\t\treturn calculator;\r\n\t};\r\n\tcalculator.dateAccessor = function(x) {\r\n\t\tif (!arguments.length) return dateAccessor;\r\n\t\tdateAccessor = x;\r\n\t\treturn calculator;\r\n\t};\r\n\treturn calculator;\r\n}\r\n"],"mappings":"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"}