{"version":3,"file":"wma.js","names":["options","defaultOptions","calculator","data","windowSize","sourcePath","weight","waverage","slidingWindow","accumulator","values","total","sum","v","i","undefinedLength","x","arguments","length"],"sources":["../../../src/lib/calculator/wma.js"],"sourcesContent":["\r\n\r\nimport { sum } from \"d3-array\";\r\n\r\nimport { slidingWindow } from \"../utils\";\r\nimport { WMA as defaultOptions } from \"./defaultOptionsForComputation\";\r\n\r\nexport default function() {\r\n\r\n\tlet options = defaultOptions;\r\n\r\n\tfunction calculator(data)    {\r\n\t\tconst { windowSize, sourcePath } = options;\r\n\r\n\t\tconst weight = windowSize * (windowSize + 1) / 2;\r\n\r\n\t\tconst waverage = slidingWindow()\r\n\t\t\t.windowSize(windowSize)\r\n\t\t\t.sourcePath(sourcePath)\r\n\t\t\t.accumulator(values => {\r\n\t\t\t\tconst total = sum(values, (v, i) => {\r\n\t\t\t\t\treturn (i + 1) * v;\r\n\t\t\t\t});\r\n\t\t\t\treturn total / weight;\r\n\t\t\t});\r\n\r\n\t\treturn waverage(data);\r\n\t}\r\n\tcalculator.undefinedLength = function() {\r\n\t\tconst { windowSize } = options;\r\n\r\n\t\treturn windowSize - 1;\r\n\t};\r\n\tcalculator.options = function(x) {\r\n\t\tif (!arguments.length) {\r\n\t\t\treturn options;\r\n\t\t}\r\n\t\toptions = { ...defaultOptions, ...x };\r\n\t\treturn calculator;\r\n\t};\r\n\r\n\treturn calculator;\r\n}\r\n"],"mappings":";;;;;;;AAEA;;AAEA;;AACA;;;;;;;;AAEe,oBAAW;EAEzB,IAAIA,OAAO,GAAGC,iCAAd;;EAEA,SAASC,UAAT,CAAoBC,IAApB,EAA6B;IAC5B,eAAmCH,OAAnC;IAAA,IAAQI,UAAR,YAAQA,UAAR;IAAA,IAAoBC,UAApB,YAAoBA,UAApB;IAEA,IAAMC,MAAM,GAAGF,UAAU,IAAIA,UAAU,GAAG,CAAjB,CAAV,GAAgC,CAA/C;IAEA,IAAMG,QAAQ,GAAG,IAAAC,oBAAA,IACfJ,UADe,CACJA,UADI,EAEfC,UAFe,CAEJA,UAFI,EAGfI,WAHe,CAGH,UAAAC,MAAM,EAAI;MACtB,IAAMC,KAAK,GAAG,IAAAC,YAAA,EAAIF,MAAJ,EAAY,UAACG,CAAD,EAAIC,CAAJ,EAAU;QACnC,OAAO,CAACA,CAAC,GAAG,CAAL,IAAUD,CAAjB;MACA,CAFa,CAAd;MAGA,OAAOF,KAAK,GAAGL,MAAf;IACA,CARe,CAAjB;IAUA,OAAOC,QAAQ,CAACJ,IAAD,CAAf;EACA;;EACDD,UAAU,CAACa,eAAX,GAA6B,YAAW;IACvC,gBAAuBf,OAAvB;IAAA,IAAQI,UAAR,aAAQA,UAAR;IAEA,OAAOA,UAAU,GAAG,CAApB;EACA,CAJD;;EAKAF,UAAU,CAACF,OAAX,GAAqB,UAASgB,CAAT,EAAY;IAChC,IAAI,CAACC,SAAS,CAACC,MAAf,EAAuB;MACtB,OAAOlB,OAAP;IACA;;IACDA,OAAO,mCAAQC,iCAAR,GAA2Be,CAA3B,CAAP;IACA,OAAOd,UAAP;EACA,CAND;;EAQA,OAAOA,UAAP;AACA"}