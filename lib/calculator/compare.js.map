{"version":3,"file":"compare.js","names":["options","defaultOptions","calculator","data","basePath","mainKeys","compareKeys","base","path","first","head","b","firsts","compareData","map","d","result","forEach","key","Object","keys","subkey","isDefined","isNotDefined","x","arguments","length"],"sources":["../../../src/lib/calculator/compare.js"],"sourcesContent":["\r\n\r\nimport { head, path, isDefined, isNotDefined } from \"../utils\";\r\nimport { Change as defaultOptions } from \"./defaultOptionsForComputation\";\r\n\r\nexport default function() {\r\n\tlet options = defaultOptions;\r\n\r\n\tfunction calculator(data) {\r\n\t\tconst { basePath, mainKeys, compareKeys } = options;\r\n\t\tconst base = path(basePath);\r\n\r\n\t\tconst first = head(data);\r\n\t\tconst b = base(first);\r\n\r\n\t\t// eslint-disable-next-line prefer-const\r\n\t\tlet firsts = {};\r\n\r\n\t\tconst compareData = data.map(d => {\r\n\t\t\t// eslint-disable-next-line prefer-const\r\n\t\t\tlet result = {};\r\n\r\n\t\t\tmainKeys.forEach(key => {\r\n\t\t\t\tif (typeof d[key] === \"object\") {\r\n\t\t\t\t\tresult[key] = {};\r\n\t\t\t\t\tObject.keys(d[key]).forEach(subkey => {\r\n\t\t\t\t\t\tresult[key][subkey] = (d[key][subkey] - b) / b;\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult[key] = (d[key] - b) / b;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tcompareKeys.forEach(key => {\r\n\t\t\t\tif (isDefined(d[key]) && isNotDefined(firsts[key])) {\r\n\t\t\t\t\tfirsts[key] = d[key];\r\n\t\t\t\t}\r\n\t\t\t\tif (isDefined(d[key]) && isDefined(firsts[key])) {\r\n\t\t\t\t\tresult[key] = (d[key] - firsts[key]) / firsts[key];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn result;\r\n\t\t});\r\n\t\t// console.log(compareData[20]);\r\n\t\treturn compareData;\r\n\t}\r\n\tcalculator.options = function(x) {\r\n\t\tif (!arguments.length) {\r\n\t\t\treturn options;\r\n\t\t}\r\n\t\toptions = { ...defaultOptions, ...x };\r\n\t\treturn calculator;\r\n\t};\r\n\treturn calculator;\r\n}"],"mappings":";;;;;;;AAEA;;AACA;;;;;;;;;;AAEe,oBAAW;EACzB,IAAIA,OAAO,GAAGC,oCAAd;;EAEA,SAASC,UAAT,CAAoBC,IAApB,EAA0B;IACzB,eAA4CH,OAA5C;IAAA,IAAQI,QAAR,YAAQA,QAAR;IAAA,IAAkBC,QAAlB,YAAkBA,QAAlB;IAAA,IAA4BC,WAA5B,YAA4BA,WAA5B;IACA,IAAMC,IAAI,GAAG,IAAAC,WAAA,EAAKJ,QAAL,CAAb;IAEA,IAAMK,KAAK,GAAG,IAAAC,WAAA,EAAKP,IAAL,CAAd;IACA,IAAMQ,CAAC,GAAGJ,IAAI,CAACE,KAAD,CAAd,CALyB,CAOzB;;IACA,IAAIG,MAAM,GAAG,EAAb;IAEA,IAAMC,WAAW,GAAGV,IAAI,CAACW,GAAL,CAAS,UAAAC,CAAC,EAAI;MACjC;MACA,IAAIC,MAAM,GAAG,EAAb;MAEAX,QAAQ,CAACY,OAAT,CAAiB,UAAAC,GAAG,EAAI;QACvB,IAAI,QAAOH,CAAC,CAACG,GAAD,CAAR,MAAkB,QAAtB,EAAgC;UAC/BF,MAAM,CAACE,GAAD,CAAN,GAAc,EAAd;UACAC,MAAM,CAACC,IAAP,CAAYL,CAAC,CAACG,GAAD,CAAb,EAAoBD,OAApB,CAA4B,UAAAI,MAAM,EAAI;YACrCL,MAAM,CAACE,GAAD,CAAN,CAAYG,MAAZ,IAAsB,CAACN,CAAC,CAACG,GAAD,CAAD,CAAOG,MAAP,IAAiBV,CAAlB,IAAuBA,CAA7C;UACA,CAFD;QAGA,CALD,MAKO;UACNK,MAAM,CAACE,GAAD,CAAN,GAAc,CAACH,CAAC,CAACG,GAAD,CAAD,GAASP,CAAV,IAAeA,CAA7B;QACA;MACD,CATD;MAWAL,WAAW,CAACW,OAAZ,CAAoB,UAAAC,GAAG,EAAI;QAC1B,IAAI,IAAAI,gBAAA,EAAUP,CAAC,CAACG,GAAD,CAAX,KAAqB,IAAAK,mBAAA,EAAaX,MAAM,CAACM,GAAD,CAAnB,CAAzB,EAAoD;UACnDN,MAAM,CAACM,GAAD,CAAN,GAAcH,CAAC,CAACG,GAAD,CAAf;QACA;;QACD,IAAI,IAAAI,gBAAA,EAAUP,CAAC,CAACG,GAAD,CAAX,KAAqB,IAAAI,gBAAA,EAAUV,MAAM,CAACM,GAAD,CAAhB,CAAzB,EAAiD;UAChDF,MAAM,CAACE,GAAD,CAAN,GAAc,CAACH,CAAC,CAACG,GAAD,CAAD,GAASN,MAAM,CAACM,GAAD,CAAhB,IAAyBN,MAAM,CAACM,GAAD,CAA7C;QACA;MACD,CAPD;MAQA,OAAOF,MAAP;IACA,CAxBmB,CAApB,CAVyB,CAmCzB;;IACA,OAAOH,WAAP;EACA;;EACDX,UAAU,CAACF,OAAX,GAAqB,UAASwB,CAAT,EAAY;IAChC,IAAI,CAACC,SAAS,CAACC,MAAf,EAAuB;MACtB,OAAO1B,OAAP;IACA;;IACDA,OAAO,mCAAQC,oCAAR,GAA2BuB,CAA3B,CAAP;IACA,OAAOtB,UAAP;EACA,CAND;;EAOA,OAAOA,UAAP;AACA"}