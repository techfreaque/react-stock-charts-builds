{"version":3,"file":"BackgroundText.js","names":["BackgroundText","context","chartCanvasType","isDefined","getCanvasContexts","contexts","drawOnCanvas","bg","props","children","componentDidMount","x","y","fill","opacity","stroke","strokeOpacity","fontFamily","fontSize","textAnchor","PureComponent","ctx","getText","interval","clearRect","canvas","width","height","save","setTransform","translate","text","strokeStyle","hexToRGBA","font","fillStyle","textAlign","strokeText","fillText","restore","propTypes","PropTypes","number","isRequired","string","func","defaultProps","contextTypes"],"sources":["../../src/lib/BackgroundText.js"],"sourcesContent":["import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport PureComponent from \"./utils/PureComponent\";\r\n\r\nimport { hexToRGBA, isDefined } from \"./utils\";\r\n\r\nclass BackgroundText extends PureComponent {\r\n\tcomponentDidMount() {\r\n\t\tif (this.context.chartCanvasType !== \"svg\" && isDefined(this.context.getCanvasContexts)) {\r\n\t\t\tconst contexts = this.context.getCanvasContexts();\r\n\t\t\tif (contexts) BackgroundText.drawOnCanvas(contexts.bg, this.props, this.context, this.props.children);\r\n\t\t}\r\n\t}\r\n\tcomponentDidUpdate() {\r\n\t\tthis.componentDidMount();\r\n\t}\r\n\trender() {\r\n\t\tconst { chartCanvasType } = this.context;\r\n\r\n\t\tif (chartCanvasType !== \"svg\") return null;\r\n\r\n\t\tconst { x, y, fill, opacity, stroke, strokeOpacity, fontFamily, fontSize, textAnchor } = this.props;\r\n\t\tconst props = { x, y, fill, opacity, stroke, strokeOpacity, fontFamily, fontSize, textAnchor };\r\n\t\treturn (\r\n\t\t\t<text {...props}>this.props.children(interval)</text>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nBackgroundText.drawOnCanvas = (ctx, props, { interval }, getText) => {\r\n\tctx.clearRect(-1, -1, ctx.canvas.width + 2, ctx.canvas.height + 2);\r\n\tctx.save();\r\n\r\n\tctx.setTransform(1, 0, 0, 1, 0, 0);\r\n\tctx.translate(0.5, 0.5);\r\n\r\n\tconst { x, y, fill, opacity, stroke, strokeOpacity, fontFamily, fontSize, textAnchor } = props;\r\n\r\n\tconst text = getText(interval);\r\n\r\n\tctx.strokeStyle = hexToRGBA(stroke, strokeOpacity);\r\n\r\n\tctx.font = `${ fontSize }px ${ fontFamily }`;\r\n\tctx.fillStyle = hexToRGBA(fill, opacity);\r\n\tctx.textAlign = textAnchor === \"middle\" ? \"center\" : textAnchor;\r\n\r\n\tif (stroke !== \"none\") ctx.strokeText(text, x, y);\r\n\tctx.fillText(text, x, y);\r\n\r\n\tctx.restore();\r\n};\r\n\r\nBackgroundText.propTypes = {\r\n\tx: PropTypes.number.isRequired,\r\n\ty: PropTypes.number.isRequired,\r\n\tfontFamily: PropTypes.string,\r\n\tfontSize: PropTypes.number.isRequired,\r\n\tfill: PropTypes.string,\r\n\tstroke: PropTypes.string,\r\n\topacity: PropTypes.number,\r\n\tstrokeOpacity: PropTypes.number,\r\n\ttextAnchor: PropTypes.string,\r\n\tchildren: PropTypes.func,\r\n};\r\n\r\nBackgroundText.defaultProps = {\r\n\topacity: 0.3,\r\n\tfill: \"#9E7523\",\r\n\tstroke: \"#9E7523\",\r\n\tstrokeOpacity: 1,\r\n\tfontFamily: \"Helvetica Neue, Helvetica, Arial, sans-serif\",\r\n\tfontSize: 12,\r\n\ttextAnchor: \"middle\",\r\n};\r\n\r\nBackgroundText.contextTypes = {\r\n\tinterval: PropTypes.string.isRequired,\r\n\tgetCanvasContexts: PropTypes.func,\r\n\tchartCanvasType: PropTypes.string,\r\n};\r\n\r\nexport default BackgroundText;"],"mappings":"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"}