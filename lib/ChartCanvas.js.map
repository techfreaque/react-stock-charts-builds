{"version":3,"file":"ChartCanvas.js","names":["log","getLogger","CANDIDATES_FOR_RESET","shouldResetChart","thisProps","nextProps","every","key","result","shallowEqual","getCursorStyle","tooltipStyle","getDimensions","props","height","margin","top","bottom","width","left","right","getXScaleDirection","flipXScale","calculateFullData","fullData","data","plotFull","xScale","clamp","pointsPerPxThreshold","xAccessor","displayXAccessor","minPointsPerPxThreshold","useWholeData","isDefined","identity","evaluator","filterData","copy","resetChart","firstCalculation","process","env","NODE_ENV","state","calculateState","initialPlotData","plotData","postCalculator","children","dimensions","chartConfig","getChartConfigWithUpdatedYScales","getNewChartConfig","domain","updateChart","newState","initialXScale","lastItemWasVisible","initialChartConfig","lastItem","last","start","end","padding","maintainPointsPerPixelOnResize","direction","updatedXScale","setXRange","range","rangeStart","rangeEnd","newRangeStart","newRangeEnd","newDomainExtent","newStart","lastItemX","response","fallbackStart","fallbackEnd","dx","map","x","invert","newEnd","inputXAccesor","xExtentsProp","xExtents","i","length","prev","curr","Error","extent","d3Extent","d","functor","each","rangeRoundPoints","isNaN","pinchCoordinates","pinch","touch1Pos","touch2Pos","topLeft","Math","min","bottomRight","max","ChartCanvas","getDataInfo","bind","getCanvasContexts","handleMouseMove","handleMouseEnter","handleMouseLeave","handleZoom","handlePinchZoom","handlePinchZoomEnd","handlePan","handlePanEnd","handleClick","handleMouseDown","handleDoubleClick","handleContextMenu","handleDragStart","handleDrag","handleDragEnd","panHelper","pinchZoomHelper","xAxisZoom","yAxisZoom","resetYDomain","calculateStateForDomain","generateSubscriptionId","draw","redraw","getAllPanConditions","subscriptions","subscribe","unsubscribe","amIOnTop","saveEventCaptureNode","saveCanvasContainerNode","setCursorClass","getMutableState","interactiveState","panInProgress","mutableState","lastSubscriptionId","node","eventCaptureNode","canvasContainerNode","canvases","axes","clearCanvas","mouseCoord","ratio","bg","id","rest","getPanConditions","draggable","panEnabled","concat","filter","className","dragableComponents","mouseXY","e","currentCharts","getCurrentCharts","currentItem","getCurrentItem","triggerEvent","newDomain","currentPlotData","currentDomain","beforePlotData","updatedScale","initialPinch","finalPinch","initialPinchXScale","iTL","iBR","fTL","fBR","xDash","round","yDash","y","cancelDrag","waitingForPinchZoomAnimationFrame","requestAnimationFrame","clearBothCanvas","trigger","clearThreeCanvas","firstItem","head","onLoadMore","setState","zoomDirection","zoomMultiplier","zoomAnchor","item","cx","c","show","chartId","yScale","yPanEnabled","type","forEach","listener","force","chartsToPan","dy","isNotDefined","hackyWayToStopPanBeyondBounds__plotData","hackyWayToStopPanBeyondBounds__domain","mousePosition","panStartXScale","dxdy","waitingForPanAnimationFrame","inputType","waitingForMouseMoveAnimationFrame","prevMouseXY","clearMouseCanvas","startPos","chartCanvasType","reset","interaction","isInteractionEnabled","prevLastItem","calculatedState","changed","newChartConfig","realYDomain","zIndex","defaultFocus","mouseMoveEvent","panEvent","zoomEvent","useCrossHairStyleCursor","onSelect","cursorStyle","cursor","position","idx","disableInteraction","Component","propTypes","PropTypes","number","isRequired","object","oneOf","array","func","oneOfType","string","seriesName","bool","shape","propName","console","warn","defaultProps","noop","mouseBasedZoomAnchor","childContextTypes","arrayOf","origin","yExtents","yExtentsProvider","mouseCoordinates","at","format","ohlcv","date","open","high","low","close","volume"],"sources":["../../src/lib/ChartCanvas.js"],"sourcesContent":["\r\n\r\nimport React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { extent as d3Extent, min, max } from \"d3-array\";\r\n\r\nimport {\r\n\thead,\r\n\tlast,\r\n\tisDefined,\r\n\tisNotDefined,\r\n\tclearCanvas,\r\n\tshallowEqual,\r\n\tidentity,\r\n\tnoop,\r\n\tfunctor,\r\n\tgetLogger,\r\n} from \"./utils\";\r\n\r\n/* eslint-disable no-unused-vars */\r\nimport {\r\n\tmouseBasedZoomAnchor,\r\n\tlastVisibleItemBasedZoomAnchor,\r\n\trightDomainBasedZoomAnchor,\r\n} from \"./utils/zoomBehavior\";\r\n/* eslint-enable no-unused-vars */\r\n\r\nimport { getNewChartConfig, getChartConfigWithUpdatedYScales, getCurrentCharts, getCurrentItem } from \"./utils/ChartDataUtil\";\r\n\r\nimport EventCapture from \"./EventCapture\";\r\n\r\nimport CanvasContainer from \"./CanvasContainer\";\r\nimport evaluator from \"./scale/evaluator\";\r\n\r\nconst log = getLogger(\"ChartCanvas\");\r\n\r\nconst CANDIDATES_FOR_RESET = [\r\n\t\"seriesName\",\r\n\t/* \"data\",*/\r\n\t/* \"xAccessor\",*/\r\n];\r\n\r\nfunction shouldResetChart(thisProps, nextProps) {\r\n\treturn !CANDIDATES_FOR_RESET.every(key => {\r\n\t\tconst result = shallowEqual(thisProps[key], nextProps[key]);\r\n\t\t// console.log(key, result);\r\n\t\treturn result;\r\n\t});\r\n}\r\n\r\nfunction getCursorStyle() {\r\n\tconst tooltipStyle = `\r\n\t.react-stockcharts-grabbing-cursor {\r\n\t\tpointer-events: all;\r\n\t\tcursor: -moz-grabbing;\r\n\t\tcursor: -webkit-grabbing;\r\n\t\tcursor: grabbing;\r\n\t}\r\n\t.react-stockcharts-crosshair-cursor {\r\n\t\tpointer-events: all;\r\n\t\tcursor: crosshair;\r\n\t}\r\n\t.react-stockcharts-tooltip-hover {\r\n\t\tpointer-events: all;\r\n\t\tcursor: pointer;\r\n\t}\r\n\t.react-stockcharts-avoid-interaction {\r\n\t\tpointer-events: none;\r\n\t}\r\n\t.react-stockcharts-enable-interaction {\r\n\t\tpointer-events: all;\r\n\t}\r\n\t.react-stockcharts-tooltip {\r\n\t\tpointer-events: all;\r\n\t\tcursor: pointer;\r\n\t}\r\n\t.react-stockcharts-default-cursor {\r\n\t\tcursor: default;\r\n\t}\r\n\t.react-stockcharts-move-cursor {\r\n\t\tcursor: move;\r\n\t}\r\n\t.react-stockcharts-pointer-cursor {\r\n\t\tcursor: pointer;\r\n\t}\r\n\t.react-stockcharts-ns-resize-cursor {\r\n\t\tcursor: ns-resize;\r\n\t}\r\n\t.react-stockcharts-ew-resize-cursor {\r\n\t\tcursor: ew-resize;\r\n\t}`;\r\n\treturn (<style type=\"text/css\">{tooltipStyle}</style>);\r\n}\r\n\r\nfunction getDimensions(props) {\r\n\treturn {\r\n\t\theight: props.height - props.margin.top - props.margin.bottom,\r\n\t\twidth: props.width - props.margin.left - props.margin.right,\r\n\t};\r\n}\r\n\r\nfunction getXScaleDirection(flipXScale) {\r\n\treturn flipXScale ? -1 : 1;\r\n}\r\n\r\nfunction calculateFullData(props) {\r\n\tconst { data: fullData, plotFull, xScale, clamp, pointsPerPxThreshold, flipXScale } = props;\r\n\tconst { xAccessor, displayXAccessor, minPointsPerPxThreshold } = props;\r\n\r\n\tconst useWholeData = isDefined(plotFull)\r\n\t\t? plotFull\r\n\t\t: xAccessor === identity;\r\n\r\n\tconst { filterData } = evaluator({\r\n\t\txScale,\r\n\t\tuseWholeData,\r\n\t\tclamp,\r\n\t\tpointsPerPxThreshold,\r\n\t\tminPointsPerPxThreshold,\r\n\t\tflipXScale,\r\n\t});\r\n\r\n\treturn {\r\n\t\txAccessor,\r\n\t\tdisplayXAccessor: displayXAccessor || xAccessor,\r\n\t\txScale: xScale.copy(),\r\n\t\tfullData,\r\n\t\tfilterData\r\n\t};\r\n}\r\nfunction resetChart(props, firstCalculation = false) {\r\n\tif (process.env.NODE_ENV !== \"production\") {\r\n\t\tif (!firstCalculation) log(\"CHART RESET\");\r\n\t}\r\n\r\n\tconst state = calculateState(props);\r\n\tconst { xAccessor, displayXAccessor, fullData } = state;\r\n\tconst { plotData: initialPlotData, xScale } = state;\r\n\tconst { postCalculator, children } = props;\r\n\r\n\tconst plotData = postCalculator(initialPlotData);\r\n\r\n\tconst dimensions = getDimensions(props);\r\n\tconst chartConfig = getChartConfigWithUpdatedYScales(\r\n\t\tgetNewChartConfig(dimensions, children),\r\n\t\t{ plotData, xAccessor, displayXAccessor, fullData },\r\n\t\txScale.domain()\r\n\t);\r\n\r\n\treturn {\r\n\t\t...state,\r\n\t\txScale,\r\n\t\tplotData,\r\n\t\tchartConfig,\r\n\t};\r\n}\r\n\r\nfunction updateChart(\r\n\tnewState,\r\n\tinitialXScale,\r\n\tprops,\r\n\tlastItemWasVisible,\r\n\tinitialChartConfig,\r\n) {\r\n\r\n\tconst { fullData, xScale, xAccessor, displayXAccessor, filterData } = newState;\r\n\r\n\tconst lastItem = last(fullData);\r\n\tconst [start, end] = initialXScale.domain();\r\n\r\n\tif (process.env.NODE_ENV !== \"production\") {\r\n\t\tlog(\"TRIVIAL CHANGE\");\r\n\t}\r\n\r\n\tconst { postCalculator, children, padding, flipXScale } = props;\r\n\tconst { maintainPointsPerPixelOnResize } = props;\r\n\tconst direction = getXScaleDirection(flipXScale);\r\n\tconst dimensions = getDimensions(props);\r\n\r\n\tconst updatedXScale = setXRange(xScale, dimensions, padding, direction);\r\n\r\n\t// console.log(\"lastItemWasVisible =\", lastItemWasVisible, end, xAccessor(lastItem), end >= xAccessor(lastItem));\r\n\tlet initialPlotData;\r\n\tif (!lastItemWasVisible || end >= xAccessor(lastItem)) {\r\n\t\t// resize comes here...\r\n\t\t// get plotData between [start, end] and do not change the domain\r\n\t\tconst [rangeStart, rangeEnd] = initialXScale.range();\r\n\t\tconst [newRangeStart, newRangeEnd] = updatedXScale.range();\r\n\t\tconst newDomainExtent = ((newRangeEnd - newRangeStart) / (rangeEnd - rangeStart)) * (end - start);\r\n\t\tconst newStart = maintainPointsPerPixelOnResize\r\n\t\t\t? end - newDomainExtent\r\n\t\t\t: start;\r\n\r\n\t\tconst lastItemX = initialXScale(xAccessor(lastItem));\r\n\t\t// console.log(\"pointsPerPixel => \", newStart, start, end, updatedXScale(end));\r\n\t\tconst response = filterData(\r\n\t\t\tfullData, [newStart, end], xAccessor, updatedXScale,\r\n\t\t\t{ fallbackStart: start, fallbackEnd: { lastItem, lastItemX } }\r\n\t\t);\r\n\t\tinitialPlotData = response.plotData;\r\n\t\tupdatedXScale.domain(response.domain);\r\n\t\t// console.log(\"HERE!!!!!\", start, end);\r\n\t} else if (lastItemWasVisible\r\n\t\t\t&& end < xAccessor(lastItem)) {\r\n\t\t// this is when a new item is added and last item was visible\r\n\t\t// so slide over and show the new item also\r\n\r\n\t\t// get plotData between [xAccessor(l) - (end - start), xAccessor(l)] and DO change the domain\r\n\t\tconst dx = initialXScale(xAccessor(lastItem)) - initialXScale.range()[1];\r\n\t\tconst [newStart, newEnd] = initialXScale.range().map(x => x + dx).map(initialXScale.invert);\r\n\r\n\r\n\t\tconst response = filterData(fullData, [newStart, newEnd], xAccessor, updatedXScale);\r\n\t\tinitialPlotData = response.plotData;\r\n\t\tupdatedXScale.domain(response.domain);\t\t// if last item was visible, then shift\r\n\t}\r\n\t// plotData = getDataOfLength(fullData, showingInterval, plotData.length)\r\n\tconst plotData = postCalculator(initialPlotData);\r\n\tconst chartConfig = getChartConfigWithUpdatedYScales(\r\n\t\tgetNewChartConfig(dimensions, children, initialChartConfig),\r\n\t\t{ plotData, xAccessor, displayXAccessor, fullData },\r\n\t\tupdatedXScale.domain()\r\n\t);\r\n\r\n\treturn {\r\n\t\txScale: updatedXScale,\r\n\t\txAccessor,\r\n\t\tchartConfig,\r\n\t\tplotData,\r\n\t\tfullData,\r\n\t\tfilterData,\r\n\t};\r\n}\r\n\r\nfunction calculateState(props) {\r\n\r\n\tconst {\r\n\t\txAccessor: inputXAccesor, xExtents: xExtentsProp, data, padding, flipXScale\r\n\t} = props;\r\n\r\n\tif (process.env.NODE_ENV !== \"production\" && isDefined(props.xScale.invert)) {\r\n\t\tfor (let i = 1; i < data.length; i++) {\r\n\t\t\tconst prev = data[i - 1];\r\n\t\t\tconst curr = data[i];\r\n\t\t\tif (inputXAccesor(prev) > inputXAccesor(curr)) {\r\n\t\t\t\tthrow new Error(\"'data' is not sorted on 'xAccessor', send 'data' sorted in ascending order of 'xAccessor'\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst direction = getXScaleDirection(flipXScale);\r\n\tconst dimensions = getDimensions(props);\r\n\r\n\tconst extent = typeof xExtentsProp === \"function\"\r\n\t\t? xExtentsProp(data)\r\n\t\t: d3Extent(xExtentsProp.map(d => functor(d)).map(each => each(data, inputXAccesor)));\r\n\r\n\tconst { xAccessor, displayXAccessor, xScale, fullData, filterData } = calculateFullData(props);\r\n\tconst updatedXScale = setXRange(xScale, dimensions, padding, direction);\r\n\r\n\tconst { plotData, domain } = filterData(fullData, extent, inputXAccesor, updatedXScale);\r\n\r\n\tif (process.env.NODE_ENV !== \"production\" && plotData.length <= 1) {\r\n\t\tthrow new Error(`Showing ${plotData.length} datapoints, review the 'xExtents' prop of ChartCanvas`);\r\n\t}\r\n\treturn {\r\n\t\tplotData,\r\n\t\txScale: updatedXScale.domain(domain),\r\n\t\txAccessor,\r\n\t\tdisplayXAccessor,\r\n\t\tfullData,\r\n\t\tfilterData,\r\n\t};\r\n}\r\n\r\nfunction setXRange(xScale, dimensions, padding, direction = 1) {\r\n\tif (xScale.rangeRoundPoints) {\r\n\t\tif (isNaN(padding)) throw new Error(\"padding has to be a number for ordinal scale\");\r\n\t\txScale.rangeRoundPoints([0, dimensions.width], padding);\r\n\t} else if (xScale.padding) {\r\n\t\tif (isNaN(padding)) throw new Error(\"padding has to be a number for ordinal scale\");\r\n\t\txScale.range([0, dimensions.width]);\r\n\t\txScale.padding(padding / 2);\r\n\t} else {\r\n\t\tconst { left, right } = isNaN(padding)\r\n\t\t\t? padding\r\n\t\t\t: { left: padding, right: padding };\r\n\t\tif (direction > 0) {\r\n\t\t\txScale.range([left, dimensions.width - right]);\r\n\t\t} else {\r\n\t\t\txScale.range([dimensions.width - right, left]);\r\n\t\t}\r\n\t}\r\n\treturn xScale;\r\n}\r\n\r\nfunction pinchCoordinates(pinch) {\r\n\tconst { touch1Pos, touch2Pos } = pinch;\r\n\r\n\treturn {\r\n\t\ttopLeft: [Math.min(touch1Pos[0], touch2Pos[0]), Math.min(touch1Pos[1], touch2Pos[1])],\r\n\t\tbottomRight: [Math.max(touch1Pos[0], touch2Pos[0]), Math.max(touch1Pos[1], touch2Pos[1])]\r\n\t};\r\n}\r\n\r\n\r\nclass ChartCanvas extends Component {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.getDataInfo = this.getDataInfo.bind(this);\r\n\t\tthis.getCanvasContexts = this.getCanvasContexts.bind(this);\r\n\r\n\t\tthis.handleMouseMove = this.handleMouseMove.bind(this);\r\n\t\tthis.handleMouseEnter = this.handleMouseEnter.bind(this);\r\n\t\tthis.handleMouseLeave = this.handleMouseLeave.bind(this);\r\n\t\tthis.handleZoom = this.handleZoom.bind(this);\r\n\t\tthis.handlePinchZoom = this.handlePinchZoom.bind(this);\r\n\t\tthis.handlePinchZoomEnd = this.handlePinchZoomEnd.bind(this);\r\n\t\tthis.handlePan = this.handlePan.bind(this);\r\n\t\tthis.handlePanEnd = this.handlePanEnd.bind(this);\r\n\t\tthis.handleClick = this.handleClick.bind(this);\r\n\t\tthis.handleMouseDown = this.handleMouseDown.bind(this);\r\n\t\tthis.handleDoubleClick = this.handleDoubleClick.bind(this);\r\n\t\tthis.handleContextMenu = this.handleContextMenu.bind(this);\r\n\t\tthis.handleDragStart = this.handleDragStart.bind(this);\r\n\t\tthis.handleDrag = this.handleDrag.bind(this);\r\n\t\tthis.handleDragEnd = this.handleDragEnd.bind(this);\r\n\r\n\t\tthis.panHelper = this.panHelper.bind(this);\r\n\t\tthis.pinchZoomHelper = this.pinchZoomHelper.bind(this);\r\n\t\tthis.xAxisZoom = this.xAxisZoom.bind(this);\r\n\t\tthis.yAxisZoom = this.yAxisZoom.bind(this);\r\n\t\tthis.resetYDomain = this.resetYDomain.bind(this);\r\n\t\tthis.calculateStateForDomain = this.calculateStateForDomain.bind(this);\r\n\t\tthis.generateSubscriptionId = this.generateSubscriptionId.bind(this);\r\n\t\tthis.draw = this.draw.bind(this);\r\n\t\tthis.redraw = this.redraw.bind(this);\r\n\t\tthis.getAllPanConditions = this.getAllPanConditions.bind(this);\r\n\r\n\t\tthis.subscriptions = [];\r\n\t\tthis.subscribe = this.subscribe.bind(this);\r\n\t\tthis.unsubscribe = this.unsubscribe.bind(this);\r\n\t\tthis.amIOnTop = this.amIOnTop.bind(this);\r\n\t\tthis.saveEventCaptureNode = this.saveEventCaptureNode.bind(this);\r\n\t\tthis.saveCanvasContainerNode = this.saveCanvasContainerNode.bind(this);\r\n\t\tthis.setCursorClass = this.setCursorClass.bind(this);\r\n\t\tthis.getMutableState = this.getMutableState.bind(this);\r\n\t\t// this.canvasDrawCallbackList = [];\r\n\t\tthis.interactiveState = [];\r\n\t\tthis.panInProgress = false;\r\n\r\n\t\tthis.state = {};\r\n\t\tthis.mutableState = {};\r\n\t\tthis.lastSubscriptionId = 0;\r\n\t}\r\n\tsaveEventCaptureNode(node) {\r\n\t\tthis.eventCaptureNode = node;\r\n\t}\r\n\tsaveCanvasContainerNode(node) {\r\n\t\tthis.canvasContainerNode = node;\r\n\t}\r\n\tgetMutableState() {\r\n\t\treturn this.mutableState;\r\n\t}\r\n\tgetDataInfo() {\r\n\t\treturn {\r\n\t\t\t...this.state,\r\n\t\t\tfullData: this.fullData,\r\n\t\t};\r\n\t}\r\n\tgetCanvasContexts() {\r\n\t\tif (this.canvasContainerNode) {\r\n\t\t\treturn this.canvasContainerNode.getCanvasContexts();\r\n\t\t}\r\n\t}\r\n\tgenerateSubscriptionId() {\r\n\t\tthis.lastSubscriptionId++;\r\n\t\treturn this.lastSubscriptionId;\r\n\t}\r\n\tclearBothCanvas() {\r\n\t\tconst canvases = this.getCanvasContexts();\r\n\t\tif (canvases && canvases.axes) {\r\n\t\t\tclearCanvas([\r\n\t\t\t\tcanvases.axes,\r\n\t\t\t\t// canvases.hover,\r\n\t\t\t\tcanvases.mouseCoord\r\n\t\t\t], this.props.ratio);\r\n\t\t}\r\n\t}\r\n\tclearMouseCanvas() {\r\n\t\tconst canvases = this.getCanvasContexts();\r\n\t\tif (canvases && canvases.mouseCoord) {\r\n\t\t\tclearCanvas([\r\n\t\t\t\tcanvases.mouseCoord,\r\n\t\t\t\t// canvases.hover,\r\n\t\t\t], this.props.ratio);\r\n\t\t}\r\n\t}\r\n\tclearThreeCanvas() {\r\n\t\tconst canvases = this.getCanvasContexts();\r\n\t\tif (canvases && canvases.axes) {\r\n\t\t\tclearCanvas([\r\n\t\t\t\tcanvases.axes,\r\n\t\t\t\t// canvases.hover,\r\n\t\t\t\tcanvases.mouseCoord,\r\n\t\t\t\tcanvases.bg\r\n\t\t\t], this.props.ratio);\r\n\t\t}\r\n\t}\r\n\tsubscribe(id, rest) {\r\n\t\tconst { getPanConditions = functor({\r\n\t\t\tdraggable: false,\r\n\t\t\tpanEnabled: true,\r\n\t\t}) } = rest;\r\n\t\tthis.subscriptions = this.subscriptions.concat({\r\n\t\t\tid,\r\n\t\t\t...rest,\r\n\t\t\tgetPanConditions,\r\n\t\t});\r\n\t}\r\n\tunsubscribe(id) {\r\n\t\tthis.subscriptions = this.subscriptions.filter(each => each.id !== id);\r\n\t}\r\n\tgetAllPanConditions() {\r\n\t\treturn this.subscriptions\r\n\t\t\t.map(each => each.getPanConditions());\r\n\t}\r\n\tsetCursorClass(className) {\r\n\t\tif (this.eventCaptureNode != null) {\r\n\t\t\tthis.eventCaptureNode.setCursorClass(className);\r\n\t\t}\r\n\t}\r\n\tamIOnTop(id) {\r\n\t\tconst dragableComponents = this.subscriptions\r\n\t\t\t.filter(each => each.getPanConditions().draggable);\r\n\r\n\t\treturn dragableComponents.length > 0\r\n\t\t\t&& last(dragableComponents).id === id;\r\n\t}\r\n\thandleContextMenu(mouseXY, e) {\r\n\t\tconst { xAccessor, chartConfig, plotData, xScale } = this.state;\r\n\r\n\t\tconst currentCharts = getCurrentCharts(chartConfig, mouseXY);\r\n\t\tconst currentItem = getCurrentItem(xScale, xAccessor, mouseXY, plotData);\r\n\r\n\t\tthis.triggerEvent(\"contextmenu\", {\r\n\t\t\tmouseXY,\r\n\t\t\tcurrentItem,\r\n\t\t\tcurrentCharts,\r\n\t\t}, e);\r\n\t}\r\n\tcalculateStateForDomain(newDomain) {\r\n\t\tconst {\r\n\t\t\txAccessor,\r\n\t\t\tdisplayXAccessor,\r\n\t\t\txScale: initialXScale,\r\n\t\t\tchartConfig: initialChartConfig,\r\n\t\t\tplotData: initialPlotData\r\n\t\t} = this.state;\r\n\t\tconst { filterData } = this.state;\r\n\t\tconst { fullData } = this;\r\n\t\tconst { postCalculator } = this.props;\r\n\r\n\t\tconst { plotData: beforePlotData, domain } = filterData(\r\n\t\t\tfullData,\r\n\t\t\tnewDomain,\r\n\t\t\txAccessor,\r\n\t\t\tinitialXScale,\r\n\t\t\t{\r\n\t\t\t\tcurrentPlotData: initialPlotData,\r\n\t\t\t\tcurrentDomain: initialXScale.domain()\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tconst plotData = postCalculator(beforePlotData);\r\n\t\tconst updatedScale = initialXScale.copy().domain(domain);\r\n\t\tconst chartConfig = getChartConfigWithUpdatedYScales(\r\n\t\t\tinitialChartConfig,\r\n\t\t\t{ plotData, xAccessor, displayXAccessor, fullData },\r\n\t\t\tupdatedScale.domain()\r\n\t\t);\r\n\r\n\t\treturn {\r\n\t\t\txScale: updatedScale,\r\n\t\t\tplotData,\r\n\t\t\tchartConfig,\r\n\t\t};\r\n\t}\r\n\tpinchZoomHelper(initialPinch, finalPinch) {\r\n\t\tconst { xScale: initialPinchXScale } = initialPinch;\r\n\r\n\t\tconst {\r\n\t\t\txScale: initialXScale,\r\n\t\t\tchartConfig: initialChartConfig,\r\n\t\t\tplotData: initialPlotData,\r\n\t\t\txAccessor,\r\n\t\t\tdisplayXAccessor,\r\n\t\t} = this.state;\r\n\t\tconst { filterData } = this.state;\r\n\t\tconst { fullData } = this;\r\n\t\tconst { postCalculator } = this.props;\r\n\r\n\t\tconst { topLeft: iTL, bottomRight: iBR } = pinchCoordinates(initialPinch);\r\n\t\tconst { topLeft: fTL, bottomRight: fBR } = pinchCoordinates(finalPinch);\r\n\r\n\t\tconst e = initialPinchXScale.range()[1];\r\n\r\n\t\tconst xDash = Math.round(-(iBR[0] * fTL[0] - iTL[0] * fBR[0]) / (iTL[0] - iBR[0]));\r\n\t\tconst yDash = Math.round(e + ((e - iBR[0]) * (e - fTL[0]) - (e - iTL[0]) * (e - fBR[0])) / ((e - iTL[0]) - (e - iBR[0])));\r\n\r\n\t\tconst x = Math.round(-xDash * iTL[0] / (-xDash + fTL[0]));\r\n\t\tconst y = Math.round(e - (yDash - e) * (e - iTL[0]) / (yDash + (e - fTL[0])));\r\n\r\n\t\tconst newDomain = [x, y].map(initialPinchXScale.invert);\r\n\t\t// var domainR = initial.right + right;\r\n\r\n\t\tconst { plotData: beforePlotData, domain } = filterData(\r\n\t\t\tfullData,\r\n\t\t\tnewDomain,\r\n\t\t\txAccessor,\r\n\t\t\tinitialPinchXScale,\r\n\t\t\t{\r\n\t\t\t\tcurrentPlotData: initialPlotData,\r\n\t\t\t\tcurrentDomain: initialXScale.domain()\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tconst plotData = postCalculator(beforePlotData);\r\n\t\tconst updatedScale = initialXScale.copy().domain(domain);\r\n\r\n\t\tconst mouseXY = finalPinch.touch1Pos;\r\n\t\tconst chartConfig = getChartConfigWithUpdatedYScales(\r\n\t\t\tinitialChartConfig,\r\n\t\t\t{ plotData, xAccessor, displayXAccessor, fullData },\r\n\t\t\tupdatedScale.domain()\r\n\t\t);\r\n\t\tconst currentItem = getCurrentItem(updatedScale, xAccessor, mouseXY, plotData);\r\n\r\n\t\treturn {\r\n\t\t\tchartConfig,\r\n\t\t\txScale: updatedScale,\r\n\t\t\tplotData,\r\n\t\t\tmouseXY,\r\n\t\t\tcurrentItem,\r\n\t\t};\r\n\t}\r\n\tcancelDrag() {\r\n\t\tthis.eventCaptureNode.cancelDrag();\r\n\t\tthis.triggerEvent(\"dragcancel\");\r\n\t}\r\n\thandlePinchZoom(initialPinch, finalPinch, e) {\r\n\t\tif (!this.waitingForPinchZoomAnimationFrame) {\r\n\t\t\tthis.waitingForPinchZoomAnimationFrame = true;\r\n\t\t\tconst state = this.pinchZoomHelper(initialPinch, finalPinch);\r\n\r\n\t\t\tthis.triggerEvent(\"pinchzoom\", state, e);\r\n\r\n\t\t\tthis.finalPinch = finalPinch;\r\n\r\n\t\t\trequestAnimationFrame(() => {\r\n\t\t\t\tthis.clearBothCanvas();\r\n\t\t\t\tthis.draw({ trigger: \"pinchzoom\" });\r\n\t\t\t\tthis.waitingForPinchZoomAnimationFrame = false;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\thandlePinchZoomEnd(initialPinch, e) {\r\n\t\tconst { xAccessor } = this.state;\r\n\r\n\t\tif (this.finalPinch) {\r\n\t\t\tconst state = this.pinchZoomHelper(initialPinch, this.finalPinch);\r\n\t\t\tconst { xScale } = state;\r\n\t\t\tthis.triggerEvent(\"pinchzoom\", state, e);\r\n\r\n\t\t\tthis.finalPinch = null;\r\n\r\n\t\t\tthis.clearThreeCanvas();\r\n\r\n\t\t\tconst { fullData } = this;\r\n\t\t\tconst firstItem = head(fullData);\r\n\r\n\t\t\tconst start = head(xScale.domain());\r\n\t\t\tconst end = xAccessor(firstItem);\r\n\t\t\tconst { onLoadMore } = this.props;\r\n\r\n\t\t\tthis.setState(state, () => {\r\n\t\t\t\tif (start < end) {\r\n\t\t\t\t\tonLoadMore(start, end);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\thandleZoom(zoomDirection, mouseXY, e) {\r\n\t\tif (this.panInProgress)\r\n\t\t\treturn;\r\n\t\t// console.log(\"zoomDirection \", zoomDirection, \" mouseXY \", mouseXY);\r\n\t\tconst { xAccessor, xScale: initialXScale, plotData: initialPlotData } = this.state;\r\n\t\tconst { zoomMultiplier, zoomAnchor } = this.props;\r\n\t\tconst { fullData } = this;\r\n\t\tconst item = zoomAnchor({\r\n\t\t\txScale: initialXScale,\r\n\t\t\txAccessor,\r\n\t\t\tmouseXY,\r\n\t\t\tplotData: initialPlotData,\r\n\t\t\tfullData,\r\n\t\t});\r\n\r\n\t\tconst cx = initialXScale(item);\r\n\t\tconst c = zoomDirection > 0 ? 1 * zoomMultiplier : 1 / zoomMultiplier;\r\n\t\tconst newDomain = initialXScale.range().map(x => cx + (x - cx) * c).map(initialXScale.invert);\r\n\r\n\t\tconst { xScale, plotData, chartConfig } = this.calculateStateForDomain(newDomain);\r\n\r\n\t\tconst currentItem = getCurrentItem(xScale, xAccessor, mouseXY, plotData);\r\n\t\tconst currentCharts = getCurrentCharts(chartConfig, mouseXY);\r\n\r\n\t\tthis.clearThreeCanvas();\r\n\r\n\t\tconst firstItem = head(fullData);\r\n\r\n\t\tconst start = head(xScale.domain());\r\n\t\tconst end = xAccessor(firstItem);\r\n\t\tconst { onLoadMore } = this.props;\r\n\r\n\t\tthis.mutableState = {\r\n\t\t\tmouseXY: mouseXY,\r\n\t\t\tcurrentItem: currentItem,\r\n\t\t\tcurrentCharts: currentCharts,\r\n\t\t};\r\n\r\n\t\tthis.triggerEvent(\"zoom\", {\r\n\t\t\txScale,\r\n\t\t\tplotData,\r\n\t\t\tchartConfig,\r\n\t\t\tmouseXY,\r\n\t\t\tcurrentCharts,\r\n\t\t\tcurrentItem,\r\n\t\t\tshow: true,\r\n\t\t}, e);\r\n\r\n\t\tthis.setState({\r\n\t\t\txScale,\r\n\t\t\tplotData,\r\n\t\t\tchartConfig,\r\n\t\t}, () => {\r\n\t\t\tif (start < end) {\r\n\t\t\t\tonLoadMore(start, end);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\txAxisZoom(newDomain) {\r\n\t\tconst { xScale, plotData, chartConfig } = this.calculateStateForDomain(newDomain);\r\n\t\tthis.clearThreeCanvas();\r\n\r\n\t\tconst { xAccessor } = this.state;\r\n\t\tconst { fullData } = this;\r\n\t\tconst firstItem = head(fullData);\r\n\t\tconst start = head(xScale.domain());\r\n\t\tconst end = xAccessor(firstItem);\r\n\t\tconst { onLoadMore } = this.props;\r\n\r\n\t\tthis.setState({\r\n\t\t\txScale,\r\n\t\t\tplotData,\r\n\t\t\tchartConfig,\r\n\t\t}, () => {\r\n\t\t\tif (start < end) onLoadMore(start, end);\r\n\t\t});\r\n\t}\r\n\tyAxisZoom(chartId, newDomain) {\r\n\t\tthis.clearThreeCanvas();\r\n\t\tconst { chartConfig: initialChartConfig } = this.state;\r\n\t\tconst chartConfig = initialChartConfig\r\n\t\t\t.map(each => {\r\n\t\t\t\tif (each.id === chartId) {\r\n\t\t\t\t\tconst { yScale } = each;\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t...each,\r\n\t\t\t\t\t\tyScale: yScale.copy().domain(newDomain),\r\n\t\t\t\t\t\tyPanEnabled: true,\r\n\t\t\t\t\t};\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn each;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\tthis.setState({\r\n\t\t\tchartConfig,\r\n\t\t});\r\n\t}\r\n\ttriggerEvent(type, props, e) {\r\n\t\t// console.log(\"triggering ->\", type);\r\n\r\n\t\tthis.subscriptions.forEach(each => {\r\n\t\t\tconst state = {\r\n\t\t\t\t...this.state,\r\n\t\t\t\tfullData: this.fullData,\r\n\t\t\t\tsubscriptions: this.subscriptions,\r\n\t\t\t};\r\n\t\t\teach.listener(type, props, state, e);\r\n\t\t});\r\n\t}\r\n\tdraw(props) {\r\n\t\tthis.subscriptions.forEach(each => {\r\n\t\t\tif (isDefined(each.draw))\r\n\t\t\t\teach.draw(props);\r\n\t\t});\r\n\t}\r\n\tredraw() {\r\n\t\tthis.clearThreeCanvas();\r\n\t\tthis.draw({ force: true });\r\n\t}\r\n\tpanHelper(mouseXY, initialXScale, { dx, dy }, chartsToPan) {\r\n\t\tconst { xAccessor, displayXAccessor, chartConfig: initialChartConfig } = this.state;\r\n\t\tconst { filterData } = this.state;\r\n\t\tconst { fullData } = this;\r\n\t\tconst { postCalculator } = this.props;\r\n\r\n\t\t// console.log(dx, dy);\r\n\t\tif (isNotDefined(initialXScale.invert))\r\n\t\t\tthrow new Error(\"xScale provided does not have an invert() method.\"\r\n\t\t\t\t+ \"You are likely using an ordinal scale. This scale does not support zoom, pan\");\r\n\r\n\t\tconst newDomain = initialXScale.range().map(x => x - dx).map(initialXScale.invert);\r\n\r\n\t\tconst { plotData: beforePlotData, domain } = filterData(\r\n\t\t\tfullData,\r\n\t\t\tnewDomain,\r\n\t\t\txAccessor,\r\n\t\t\tinitialXScale,\r\n\t\t\t{\r\n\t\t\t\tcurrentPlotData: this.hackyWayToStopPanBeyondBounds__plotData,\r\n\t\t\t\tcurrentDomain: this.hackyWayToStopPanBeyondBounds__domain\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tconst updatedScale = initialXScale.copy().domain(domain);\r\n\t\tconst plotData = postCalculator(beforePlotData);\r\n\t\t// console.log(last(plotData));\r\n\r\n\t\tconst currentItem = getCurrentItem(updatedScale, xAccessor, mouseXY, plotData);\r\n\t\tconst chartConfig = getChartConfigWithUpdatedYScales(\r\n\t\t\tinitialChartConfig,\r\n\t\t\t{ plotData, xAccessor, displayXAccessor, fullData },\r\n\t\t\tupdatedScale.domain(),\r\n\t\t\tdy,\r\n\t\t\tchartsToPan\r\n\t\t);\r\n\t\tconst currentCharts = getCurrentCharts(chartConfig, mouseXY);\r\n\r\n\t\t// console.log(initialXScale.domain(), newDomain, updatedScale.domain());\r\n\t\treturn {\r\n\t\t\txScale: updatedScale,\r\n\t\t\tplotData,\r\n\t\t\tchartConfig,\r\n\t\t\tmouseXY,\r\n\t\t\tcurrentCharts,\r\n\t\t\tcurrentItem,\r\n\t\t};\r\n\t}\r\n\thandlePan(mousePosition, panStartXScale, dxdy, chartsToPan, e) {\r\n\t\tif (!this.waitingForPanAnimationFrame) {\r\n\t\t\tthis.waitingForPanAnimationFrame = true;\r\n\r\n\t\t\tthis.hackyWayToStopPanBeyondBounds__plotData = this.hackyWayToStopPanBeyondBounds__plotData || this.state.plotData;\r\n\t\t\tthis.hackyWayToStopPanBeyondBounds__domain = this.hackyWayToStopPanBeyondBounds__domain || this.state.xScale.domain();\r\n\r\n\t\t\tconst state = this.panHelper(mousePosition, panStartXScale, dxdy, chartsToPan);\r\n\r\n\t\t\tthis.hackyWayToStopPanBeyondBounds__plotData = state.plotData;\r\n\t\t\tthis.hackyWayToStopPanBeyondBounds__domain = state.xScale.domain();\r\n\r\n\t\t\tthis.panInProgress = true;\r\n\t\t\t// console.log(panStartXScale.domain(), state.xScale.domain());\r\n\r\n\t\t\tthis.triggerEvent(\"pan\", state, e);\r\n\r\n\t\t\tthis.mutableState = {\r\n\t\t\t\tmouseXY: state.mouseXY,\r\n\t\t\t\tcurrentItem: state.currentItem,\r\n\t\t\t\tcurrentCharts: state.currentCharts,\r\n\t\t\t};\r\n\t\t\trequestAnimationFrame(() => {\r\n\t\t\t\tthis.waitingForPanAnimationFrame = false;\r\n\t\t\t\tthis.clearBothCanvas();\r\n\t\t\t\tthis.draw({ trigger: \"pan\" });\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\thandlePanEnd(mousePosition, panStartXScale, dxdy, chartsToPan, e) {\r\n\t\tconst state = this.panHelper(mousePosition, panStartXScale, dxdy, chartsToPan);\r\n\t\t// console.log(this.canvasDrawCallbackList.map(d => d.type));\r\n\t\tthis.hackyWayToStopPanBeyondBounds__plotData = null;\r\n\t\tthis.hackyWayToStopPanBeyondBounds__domain = null;\r\n\r\n\t\tthis.panInProgress = false;\r\n\r\n\t\t// console.log(\"PANEND\", panEnd++);\r\n\t\tconst {\r\n\t\t\txScale,\r\n\t\t\tplotData,\r\n\t\t\tchartConfig,\r\n\t\t} = state;\r\n\r\n\t\tthis.triggerEvent(\"panend\", state, e);\r\n\r\n\t\trequestAnimationFrame(() => {\r\n\t\t\tconst { xAccessor } = this.state;\r\n\t\t\tconst { fullData } = this;\r\n\r\n\t\t\tconst firstItem = head(fullData);\r\n\t\t\tconst start = head(xScale.domain());\r\n\t\t\tconst end = xAccessor(firstItem);\r\n\t\t\t// console.log(start, end, start < end ? \"Load more\" : \"I have it\");\r\n\r\n\t\t\tconst { onLoadMore } = this.props;\r\n\r\n\t\t\tthis.clearThreeCanvas();\r\n\r\n\t\t\tthis.setState({\r\n\t\t\t\txScale,\r\n\t\t\t\tplotData,\r\n\t\t\t\tchartConfig,\r\n\t\t\t}, () => {\r\n\t\t\t\tif (start < end) onLoadMore(start, end);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\thandleMouseDown(mousePosition, currentCharts, e) {\r\n\t\tthis.triggerEvent(\"mousedown\", this.mutableState, e);\r\n\t}\r\n\thandleMouseEnter(e) {\r\n\t\tthis.triggerEvent(\"mouseenter\", {\r\n\t\t\tshow: true,\r\n\t\t}, e);\r\n\t}\r\n\thandleMouseMove(mouseXY, inputType, e) {\r\n\t\tif (!this.waitingForMouseMoveAnimationFrame) {\r\n\t\t\tthis.waitingForMouseMoveAnimationFrame = true;\r\n\r\n\t\t\tconst { chartConfig, plotData, xScale, xAccessor } = this.state;\r\n\t\t\tconst currentCharts = getCurrentCharts(chartConfig, mouseXY);\r\n\t\t\tconst currentItem = getCurrentItem(xScale, xAccessor, mouseXY, plotData);\r\n\t\t\tthis.triggerEvent(\"mousemove\", {\r\n\t\t\t\tshow: true,\r\n\t\t\t\tmouseXY,\r\n\t\t\t\t// prevMouseXY is used in interactive components\r\n\t\t\t\tprevMouseXY: this.prevMouseXY,\r\n\t\t\t\tcurrentItem,\r\n\t\t\t\tcurrentCharts,\r\n\t\t\t}, e);\r\n\r\n\t\t\tthis.prevMouseXY = mouseXY;\r\n\t\t\tthis.mutableState = {\r\n\t\t\t\tmouseXY,\r\n\t\t\t\tcurrentItem,\r\n\t\t\t\tcurrentCharts,\r\n\t\t\t};\r\n\r\n\t\t\trequestAnimationFrame(() => {\r\n\t\t\t\tthis.clearMouseCanvas();\r\n\t\t\t\tthis.draw({ trigger: \"mousemove\" });\r\n\t\t\t\tthis.waitingForMouseMoveAnimationFrame = false;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\thandleMouseLeave(e) {\r\n\t\tthis.triggerEvent(\"mouseleave\", { show: false }, e);\r\n\t\tthis.clearMouseCanvas();\r\n\t\tthis.draw({ trigger: \"mouseleave\" });\r\n\t}\r\n\thandleDragStart({ startPos }, e) {\r\n\t\tthis.triggerEvent(\"dragstart\", { startPos }, e);\r\n\t}\r\n\thandleDrag({ startPos, mouseXY }, e) {\r\n\t\tconst { chartConfig, plotData, xScale, xAccessor } = this.state;\r\n\t\tconst currentCharts = getCurrentCharts(chartConfig, mouseXY);\r\n\t\tconst currentItem = getCurrentItem(xScale, xAccessor, mouseXY, plotData);\r\n\r\n\t\tthis.triggerEvent(\"drag\", {\r\n\t\t\tstartPos,\r\n\t\t\tmouseXY,\r\n\t\t\tcurrentItem,\r\n\t\t\tcurrentCharts,\r\n\t\t}, e);\r\n\r\n\t\tthis.mutableState = {\r\n\t\t\tmouseXY,\r\n\t\t\tcurrentItem,\r\n\t\t\tcurrentCharts,\r\n\t\t};\r\n\r\n\t\trequestAnimationFrame(() => {\r\n\t\t\tthis.clearMouseCanvas();\r\n\t\t\tthis.draw({ trigger: \"drag\" });\r\n\t\t});\r\n\t}\r\n\thandleDragEnd({ mouseXY }, e) {\r\n\t\tthis.triggerEvent(\"dragend\", { mouseXY }, e);\r\n\r\n\t\trequestAnimationFrame(() => {\r\n\t\t\tthis.clearMouseCanvas();\r\n\t\t\tthis.draw({ trigger: \"dragend\" });\r\n\t\t});\r\n\t}\r\n\thandleClick(mousePosition, e) {\r\n\t\tthis.triggerEvent(\"click\", this.mutableState, e);\r\n\r\n\t\trequestAnimationFrame(() => {\r\n\t\t\tthis.clearMouseCanvas();\r\n\t\t\tthis.draw({ trigger: \"click\" });\r\n\t\t});\r\n\t}\r\n\thandleDoubleClick(mousePosition, e) {\r\n\t\tthis.triggerEvent(\"dblclick\", {}, e);\r\n\t}\r\n\tgetChildContext() {\r\n\t\tconst dimensions = getDimensions(this.props);\r\n\t\treturn {\r\n\t\t\tfullData: this.fullData,\r\n\t\t\tplotData: this.state.plotData,\r\n\t\t\twidth: dimensions.width,\r\n\t\t\theight: dimensions.height,\r\n\t\t\tchartConfig: this.state.chartConfig,\r\n\t\t\txScale: this.state.xScale,\r\n\t\t\txAccessor: this.state.xAccessor,\r\n\t\t\tdisplayXAccessor: this.state.displayXAccessor,\r\n\t\t\tchartCanvasType: this.props.type,\r\n\t\t\tmargin: this.props.margin,\r\n\t\t\tratio: this.props.ratio,\r\n\t\t\txAxisZoom: this.xAxisZoom,\r\n\t\t\tyAxisZoom: this.yAxisZoom,\r\n\t\t\tgetCanvasContexts: this.getCanvasContexts,\r\n\t\t\tredraw: this.redraw,\r\n\t\t\tsubscribe: this.subscribe,\r\n\t\t\tunsubscribe: this.unsubscribe,\r\n\t\t\tgenerateSubscriptionId: this.generateSubscriptionId,\r\n\t\t\tgetMutableState: this.getMutableState,\r\n\t\t\tamIOnTop: this.amIOnTop,\r\n\t\t\tsetCursorClass: this.setCursorClass,\r\n\t\t};\r\n\t}\r\n\tUNSAFE_componentWillMount() {\r\n\t\tconst { fullData, ...state } = resetChart(this.props, true);\r\n\t\tthis.setState(state);\r\n\t\tthis.fullData = fullData;\r\n\t}\r\n\tUNSAFE_componentWillReceiveProps(nextProps) {\r\n\t\tconst reset = shouldResetChart(this.props, nextProps);\r\n\r\n\t\tconst interaction = isInteractionEnabled(this.state.xScale, this.state.xAccessor, this.state.plotData);\r\n\t\tconst { chartConfig: initialChartConfig } = this.state;\r\n\r\n\t\tlet newState;\r\n\t\tif (!interaction || reset || !shallowEqual(this.props.xExtents, nextProps.xExtents)) {\r\n\t\t\tif (process.env.NODE_ENV !== \"production\") {\r\n\t\t\t\tif (!interaction)\r\n\t\t\t\t\tlog(\"RESET CHART, changes to a non interactive chart\");\r\n\t\t\t\telse if (reset)\r\n\t\t\t\t\tlog(\"RESET CHART, one or more of these props changed\", CANDIDATES_FOR_RESET);\r\n\t\t\t\telse\r\n\t\t\t\t\tlog(\"xExtents changed\");\r\n\t\t\t}\r\n\t\t\t// do reset\r\n\t\t\tnewState = resetChart(nextProps);\r\n\t\t\tthis.mutableState = {};\r\n\t\t} else {\r\n\r\n\t\t\tconst [start, end] = this.state.xScale.domain();\r\n\t\t\tconst prevLastItem = last(this.fullData);\r\n\r\n\t\t\tconst calculatedState = calculateFullData(nextProps);\r\n\t\t\tconst { xAccessor } = calculatedState;\r\n\t\t\tconst lastItemWasVisible = xAccessor(prevLastItem) <= end && xAccessor(prevLastItem) >= start;\r\n\r\n\t\t\tif (process.env.NODE_ENV !== \"production\") {\r\n\t\t\t\tif (this.props.data !== nextProps.data)\r\n\t\t\t\t\tlog(\"data is changed but seriesName did not, change the seriesName if you wish to reset the chart and lastItemWasVisible = \", lastItemWasVisible);\r\n\t\t\t\telse\r\n\t\t\t\t\tlog(\"Trivial change, may be width/height or type changed, but that does not matter\");\r\n\t\t\t}\r\n\r\n\t\t\tnewState = updateChart(\r\n\t\t\t\tcalculatedState,\r\n\t\t\t\tthis.state.xScale,\r\n\t\t\t\tnextProps,\r\n\t\t\t\tlastItemWasVisible,\r\n\t\t\t\tinitialChartConfig,\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tconst { fullData, ...state } = newState;\r\n\r\n\t\tif (this.panInProgress) {\r\n\t\t\tif (process.env.NODE_ENV !== \"production\") {\r\n\t\t\t\tlog(\"Pan is in progress\");\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t/*\r\n\t\t\tif (!reset) {\r\n\t\t\t\tstate.chartConfig\r\n\t\t\t\t\t.forEach((each) => {\r\n\t\t\t\t\t\t// const sourceChartConfig = initialChartConfig.filter(d => d.id === each.id);\r\n\t\t\t\t\t\tconst prevChartConfig = find(initialChartConfig, d => d.id === each.id);\r\n\t\t\t\t\t\tif (isDefined(prevChartConfig) && prevChartConfig.yPanEnabled) {\r\n\t\t\t\t\t\t\teach.yScale.domain(prevChartConfig.yScale.domain());\r\n\t\t\t\t\t\t\teach.yPanEnabled = prevChartConfig.yPanEnabled;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t*/\r\n\t\t\tthis.clearThreeCanvas();\r\n\r\n\t\t\tthis.setState(state);\r\n\t\t}\r\n\t\tthis.fullData = fullData;\r\n\t}\r\n\t/*\r\n\tcomponentDidUpdate(prevProps, prevState) {\r\n\t\tconsole.error(this.state.chartConfig, this.state.chartConfig.map(d => d.yScale.domain()));\r\n\t}\r\n\t*/\r\n\tresetYDomain(chartId) {\r\n\t\tconst { chartConfig } = this.state;\r\n\t\tlet changed = false;\r\n\t\tconst newChartConfig = chartConfig\r\n\t\t\t.map(each => {\r\n\t\t\t\tif ((isNotDefined(chartId) || each.id === chartId)\r\n\t\t\t\t\t\t&& !shallowEqual(each.yScale.domain(), each.realYDomain)) {\r\n\t\t\t\t\tchanged = true;\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t...each,\r\n\t\t\t\t\t\tyScale: each.yScale.domain(each.realYDomain),\r\n\t\t\t\t\t\tyPanEnabled: false,\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\treturn each;\r\n\t\t\t});\r\n\r\n\t\tif (changed) {\r\n\t\t\tthis.clearThreeCanvas();\r\n\t\t\tthis.setState({\r\n\t\t\t\tchartConfig: newChartConfig\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\tshouldComponentUpdate() {\r\n\t\t// console.log(\"Happneing.....\", !this.panInProgress)\r\n\t\treturn !this.panInProgress;\r\n\t}\r\n\trender() {\r\n\r\n\t\tconst { type, height, width, margin, className, zIndex, defaultFocus, ratio, mouseMoveEvent, panEvent, zoomEvent } = this.props;\r\n\t\tconst { useCrossHairStyleCursor, onSelect } = this.props;\r\n\r\n\t\tconst { plotData, xScale, xAccessor, chartConfig } = this.state;\r\n\t\tconst dimensions = getDimensions(this.props);\r\n\r\n\t\tconst interaction = isInteractionEnabled(xScale, xAccessor, plotData);\r\n\r\n\t\tconst cursorStyle = useCrossHairStyleCursor && interaction;\r\n\t\tconst cursor = getCursorStyle();\r\n\t\treturn (\r\n\t\t\t<div style={{ position: \"relative\", width, height }} className={className} onClick={onSelect}>\r\n\t\t\t\t<CanvasContainer ref={this.saveCanvasContainerNode}\r\n\t\t\t\t\ttype={type}\r\n\t\t\t\t\tratio={ratio}\r\n\t\t\t\t\twidth={width} height={height} zIndex={zIndex}/>\r\n\t\t\t\t<svg className={className} width={width} height={height} style={{ position: \"absolute\", zIndex: (zIndex + 5) }}>\r\n\t\t\t\t\t{cursor}\r\n\t\t\t\t\t<defs>\r\n\t\t\t\t\t\t<clipPath id=\"chart-area-clip\">\r\n\t\t\t\t\t\t\t<rect x=\"0\" y=\"0\" width={dimensions.width} height={dimensions.height} />\r\n\t\t\t\t\t\t</clipPath>\r\n\t\t\t\t\t\t{chartConfig\r\n\t\t\t\t\t\t\t.map((each, idx) => <clipPath key={idx} id={`chart-area-clip-${each.id}`}>\r\n\t\t\t\t\t\t\t\t<rect x=\"0\" y=\"0\" width={each.width} height={each.height} />\r\n\t\t\t\t\t\t\t</clipPath>)}\r\n\t\t\t\t\t</defs>\r\n\t\t\t\t\t<g transform={`translate(${margin.left + 0.5}, ${margin.top + 0.5})`}>\r\n\t\t\t\t\t\t<EventCapture\r\n\t\t\t\t\t\t\tref={this.saveEventCaptureNode}\r\n\t\t\t\t\t\t\tuseCrossHairStyleCursor={cursorStyle}\r\n\t\t\t\t\t\t\tmouseMove={mouseMoveEvent && interaction}\r\n\t\t\t\t\t\t\tzoom={zoomEvent && interaction}\r\n\t\t\t\t\t\t\tpan={panEvent && interaction}\r\n\r\n\t\t\t\t\t\t\twidth={dimensions.width}\r\n\t\t\t\t\t\t\theight={dimensions.height}\r\n\t\t\t\t\t\t\tchartConfig={chartConfig}\r\n\t\t\t\t\t\t\txScale={xScale}\r\n\t\t\t\t\t\t\txAccessor={xAccessor}\r\n\t\t\t\t\t\t\tfocus={defaultFocus}\r\n\t\t\t\t\t\t\tdisableInteraction={this.props.disableInteraction}\r\n\r\n\t\t\t\t\t\t\tgetAllPanConditions={this.getAllPanConditions}\r\n\t\t\t\t\t\t\tonContextMenu={this.handleContextMenu}\r\n\t\t\t\t\t\t\tonClick={this.handleClick}\r\n\t\t\t\t\t\t\tonDoubleClick={this.handleDoubleClick}\r\n\t\t\t\t\t\t\tonMouseDown={this.handleMouseDown}\r\n\t\t\t\t\t\t\tonMouseMove={this.handleMouseMove}\r\n\t\t\t\t\t\t\tonMouseEnter={this.handleMouseEnter}\r\n\t\t\t\t\t\t\tonMouseLeave={this.handleMouseLeave}\r\n\r\n\t\t\t\t\t\t\tonDragStart={this.handleDragStart}\r\n\t\t\t\t\t\t\tonDrag={this.handleDrag}\r\n\t\t\t\t\t\t\tonDragComplete={this.handleDragEnd}\r\n\r\n\t\t\t\t\t\t\tonZoom={this.handleZoom}\r\n\t\t\t\t\t\t\tonPinchZoom={this.handlePinchZoom}\r\n\t\t\t\t\t\t\tonPinchZoomEnd={this.handlePinchZoomEnd}\r\n\t\t\t\t\t\t\tonPan={this.handlePan}\r\n\t\t\t\t\t\t\tonPanEnd={this.handlePanEnd}\r\n\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t<g className=\"react-stockcharts-avoid-interaction\">\r\n\t\t\t\t\t\t\t{this.props.children}\r\n\t\t\t\t\t\t</g>\r\n\t\t\t\t\t</g>\r\n\t\t\t\t</svg>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nfunction isInteractionEnabled(xScale, xAccessor, data) {\r\n\tconst interaction = !isNaN(xScale(xAccessor(head(data)))) && isDefined(xScale.invert);\r\n\treturn interaction;\r\n}\r\n\r\nChartCanvas.propTypes = {\r\n\twidth: PropTypes.number.isRequired,\r\n\theight: PropTypes.number.isRequired,\r\n\tmargin: PropTypes.object,\r\n\tratio: PropTypes.number.isRequired,\r\n\t// interval: PropTypes.oneOf([\"D\", \"W\", \"M\"]), // ,\"m1\", \"m5\", \"m15\", \"W\", \"M\"\r\n\ttype: PropTypes.oneOf([\"svg\", \"hybrid\"]),\r\n\tpointsPerPxThreshold: PropTypes.number,\r\n\tminPointsPerPxThreshold: PropTypes.number,\r\n\tdata: PropTypes.array.isRequired,\r\n\t// initialDisplay: PropTypes.number,\r\n\txAccessor: PropTypes.func,\r\n\txExtents: PropTypes.oneOfType([\r\n\t\tPropTypes.array,\r\n\t\tPropTypes.func\r\n\t]),\r\n\tzoomAnchor: PropTypes.func,\r\n\r\n\tclassName: PropTypes.string,\r\n\tseriesName: PropTypes.string.isRequired,\r\n\tzIndex: PropTypes.number,\r\n\tchildren: PropTypes.node.isRequired,\r\n\txScale: PropTypes.func.isRequired,\r\n\tpostCalculator: PropTypes.func,\r\n\tflipXScale: PropTypes.bool,\r\n\tuseCrossHairStyleCursor: PropTypes.bool,\r\n\tpadding: PropTypes.oneOfType([\r\n\t\tPropTypes.number,\r\n\t\tPropTypes.shape({\r\n\t\t\tleft: PropTypes.number,\r\n\t\t\tright: PropTypes.number,\r\n\t\t})\r\n\t]),\r\n\tdefaultFocus: PropTypes.bool,\r\n\tzoomMultiplier: PropTypes.number,\r\n\tonLoadMore: PropTypes.func,\r\n\tdisplayXAccessor: function(props, propName/* , componentName */) {\r\n\t\tif (isNotDefined(props[propName])) {\r\n\t\t\tconsole.warn(\"`displayXAccessor` is not defined,\"\r\n\t\t\t\t+ \" will use the value from `xAccessor` as `displayXAccessor`.\"\r\n\t\t\t\t+ \" This might be ok if you do not use a discontinuous scale\"\r\n\t\t\t\t+ \" but if you do, provide a `displayXAccessor` prop to `ChartCanvas`\");\r\n\t\t} else if (typeof props[propName] !== \"function\") {\r\n\t\t\treturn new Error(\"displayXAccessor has to be a function\");\r\n\t\t}\r\n\t},\r\n\tmouseMoveEvent: PropTypes.bool,\r\n\tpanEvent: PropTypes.bool,\r\n\tclamp: PropTypes.oneOfType([PropTypes.string, PropTypes.bool, PropTypes.func]),\r\n\tzoomEvent: PropTypes.bool,\r\n\tonSelect: PropTypes.func,\r\n\tmaintainPointsPerPixelOnResize: PropTypes.bool,\r\n\tdisableInteraction: PropTypes.bool,\r\n};\r\n\r\nChartCanvas.defaultProps = {\r\n\tmargin: { top: 20, right: 30, bottom: 30, left: 80 },\r\n\ttype: \"hybrid\",\r\n\tpointsPerPxThreshold: 2,\r\n\tminPointsPerPxThreshold: 1 / 100,\r\n\tclassName: \"react-stockchart\",\r\n\tzIndex: 1,\r\n\txExtents: [min, max],\r\n\tpostCalculator: identity,\r\n\tpadding: 0,\r\n\txAccessor: identity,\r\n\tflipXScale: false,\r\n\tuseCrossHairStyleCursor: true,\r\n\tdefaultFocus: true,\r\n\tonLoadMore: noop,\r\n\tonSelect: noop,\r\n\tmouseMoveEvent: true,\r\n\tpanEvent: true,\r\n\tzoomEvent: true,\r\n\tzoomMultiplier: 1.1,\r\n\tclamp: false,\r\n\tzoomAnchor: mouseBasedZoomAnchor,\r\n\tmaintainPointsPerPixelOnResize: true,\r\n\t// ratio: 2,\r\n\tdisableInteraction: false,\r\n};\r\n\r\nChartCanvas.childContextTypes = {\r\n\tplotData: PropTypes.array,\r\n\tfullData: PropTypes.array,\r\n\tchartConfig: PropTypes.arrayOf(\r\n\t\tPropTypes.shape({\r\n\t\t\tid: PropTypes.oneOfType([PropTypes.number, PropTypes.string]).isRequired,\r\n\t\t\torigin: PropTypes.arrayOf(PropTypes.number).isRequired,\r\n\t\t\tpadding: PropTypes.oneOfType([\r\n\t\t\t\tPropTypes.number,\r\n\t\t\t\tPropTypes.shape({\r\n\t\t\t\t\ttop: PropTypes.number,\r\n\t\t\t\t\tbottom: PropTypes.number,\r\n\t\t\t\t})\r\n\t\t\t]),\r\n\t\t\tyExtents: PropTypes.arrayOf(PropTypes.func),\r\n\t\t\tyExtentsProvider: PropTypes.func,\r\n\t\t\tyScale: PropTypes.func.isRequired,\r\n\t\t\tmouseCoordinates: PropTypes.shape({\r\n\t\t\t\tat: PropTypes.string,\r\n\t\t\t\tformat: PropTypes.func\r\n\t\t\t}),\r\n\t\t\twidth: PropTypes.number.isRequired,\r\n\t\t\theight: PropTypes.number.isRequired,\r\n\t\t})\r\n\t).isRequired,\r\n\txScale: PropTypes.func.isRequired,\r\n\txAccessor: PropTypes.func.isRequired,\r\n\tdisplayXAccessor: PropTypes.func.isRequired,\r\n\twidth: PropTypes.number.isRequired,\r\n\theight: PropTypes.number.isRequired,\r\n\tchartCanvasType: PropTypes.oneOf([\"svg\", \"hybrid\"]).isRequired,\r\n\tmargin: PropTypes.object.isRequired,\r\n\tratio: PropTypes.number.isRequired,\r\n\tgetCanvasContexts: PropTypes.func,\r\n\txAxisZoom: PropTypes.func,\r\n\tyAxisZoom: PropTypes.func,\r\n\tamIOnTop: PropTypes.func,\r\n\tredraw: PropTypes.func,\r\n\tsubscribe: PropTypes.func,\r\n\tunsubscribe: PropTypes.func,\r\n\tsetCursorClass: PropTypes.func,\r\n\tgenerateSubscriptionId: PropTypes.func,\r\n\tgetMutableState: PropTypes.func,\r\n};\r\n\r\nChartCanvas.ohlcv = d => ({ date: d.date, open: d.open, high: d.high, low: d.low, close: d.close, volume: d.volume });\r\n\r\nexport default ChartCanvas;\r\n"],"mappings":"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"}