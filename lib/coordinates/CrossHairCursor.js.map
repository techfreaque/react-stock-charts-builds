{"version":3,"file":"CrossHairCursor.js","names":["CrossHairCursor","props","renderSVG","bind","drawOnCanvas","ctx","moreProps","lines","helper","isDefined","context","margin","ratio","originX","left","originY","top","save","setTransform","scale","translate","forEach","line","dashArray","getStrokeDasharray","strokeDasharray","split","map","d","strokeStyle","hexToRGBA","stroke","opacity","setLineDash","beginPath","moveTo","x1","y1","lineTo","x2","y2","restore","className","isNotDefined","idx","rest","getMouseCanvas","Component","propTypes","PropTypes","string","oneOf","strokeDashTypes","contextTypes","object","isRequired","number","customX","xScale","xAccessor","currentItem","mouseXY","snapX","x","Math","round","defaultProps","show","height","width","line1","line2"],"sources":["../../../src/lib/coordinates/CrossHairCursor.js"],"sourcesContent":["\r\n\r\nimport React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport GenericComponent, { getMouseCanvas } from \"../GenericComponent\";\r\n\r\nimport { hexToRGBA, isDefined, isNotDefined, strokeDashTypes, getStrokeDasharray } from \"../utils\";\r\n\r\nclass CrossHairCursor extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.renderSVG = this.renderSVG.bind(this);\r\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\r\n\t}\r\n\tdrawOnCanvas(ctx, moreProps) {\r\n\t\tconst lines = helper(this.props, moreProps);\r\n\r\n\t\tif (isDefined(lines)) {\r\n\r\n\t\t\tconst { margin, ratio } = this.context;\r\n\t\t\tconst originX = 0.5 * ratio + margin.left;\r\n\t\t\tconst originY = 0.5 * ratio + margin.top;\r\n\r\n\t\t\tctx.save();\r\n\t\t\tctx.setTransform(1, 0, 0, 1, 0, 0);\r\n\t\t\tctx.scale(ratio, ratio);\r\n\r\n\t\t\tctx.translate(originX, originY);\r\n\r\n\t\t\tlines.forEach(line => {\r\n\t\t\t\tconst dashArray = getStrokeDasharray(line.strokeDasharray).split(\",\").map(d => +d);\r\n\r\n\t\t\t\tctx.strokeStyle = hexToRGBA(line.stroke, line.opacity);\r\n\t\t\t\tctx.setLineDash(dashArray);\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.moveTo(line.x1, line.y1);\r\n\t\t\t\tctx.lineTo(line.x2, line.y2);\r\n\t\t\t\tctx.stroke();\r\n\t\t\t});\r\n\r\n\t\t\tctx.restore();\r\n\t\t}\r\n\t}\r\n\trenderSVG(moreProps) {\r\n\t\tconst { className } = this.props;\r\n\t\tconst lines = helper(this.props, moreProps);\r\n\r\n\t\tif (isNotDefined(lines)) return null;\r\n\r\n\t\treturn (\r\n\t\t\t<g className={`react-stockcharts-crosshair ${className}`}>\r\n\t\t\t\t{lines.map(({ strokeDasharray, ...rest }, idx) =>\r\n\t\t\t\t\t<line\r\n\t\t\t\t\t\tkey={idx}\r\n\t\t\t\t\t\tstrokeDasharray={getStrokeDasharray(strokeDasharray)}\r\n\t\t\t\t\t\t{...rest} />)}\r\n\t\t\t</g>\r\n\t\t);\r\n\t}\r\n\trender() {\r\n\t\treturn <GenericComponent\r\n\t\t\tsvgDraw={this.renderSVG}\r\n\t\t\tclip={false}\r\n\t\t\tcanvasDraw={this.drawOnCanvas}\r\n\t\t\tcanvasToDraw={getMouseCanvas}\r\n\t\t\tdrawOn={[\"mousemove\", \"pan\", \"drag\"]}\r\n\t\t/>;\r\n\t}\r\n}\r\n\r\nCrossHairCursor.propTypes = {\r\n\tclassName: PropTypes.string,\r\n\tstrokeDasharray: PropTypes.oneOf(strokeDashTypes),\r\n};\r\n\r\nCrossHairCursor.contextTypes = {\r\n\tmargin: PropTypes.object.isRequired,\r\n\tratio: PropTypes.number.isRequired,\r\n\t// xScale for getting update event upon pan end, this is needed to get past the PureComponent shouldComponentUpdate\r\n\t// xScale: PropTypes.func.isRequired,\r\n};\r\n\r\nfunction customX(props, moreProps) {\r\n\tconst { xScale, xAccessor, currentItem, mouseXY } = moreProps;\r\n\tconst { snapX } = props;\r\n\tconst x = snapX\r\n\t\t? Math.round(xScale(xAccessor(currentItem)))\r\n\t\t: mouseXY[0];\r\n\treturn x;\r\n}\r\n\r\n\r\nCrossHairCursor.defaultProps = {\r\n\tstroke: \"#000000\",\r\n\topacity: 0.3,\r\n\tstrokeDasharray: \"ShortDash\",\r\n\tsnapX: true,\r\n\tcustomX,\r\n};\r\n\r\nfunction helper(props, moreProps) {\r\n\tconst {\r\n\t\tmouseXY, currentItem, show, height, width\r\n\t} = moreProps;\r\n\r\n\tconst { customX, stroke, opacity, strokeDasharray } = props;\r\n\r\n\tif (!show || isNotDefined(currentItem)) return null;\r\n\r\n\tconst line1 = {\r\n\t\tx1: 0,\r\n\t\tx2: width,\r\n\t\ty1: mouseXY[1],\r\n\t\ty2: mouseXY[1],\r\n\t\tstroke, strokeDasharray, opacity,\r\n\t};\r\n\tconst x = customX(props, moreProps);\r\n\r\n\tconst line2 = {\r\n\t\tx1: x,\r\n\t\tx2: x,\r\n\t\ty1: 0,\r\n\t\ty2: height,\r\n\t\tstroke, strokeDasharray, opacity,\r\n\t};\r\n\treturn [line1, line2];\r\n}\r\n\r\nexport default CrossHairCursor;\r\n"],"mappings":"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"}