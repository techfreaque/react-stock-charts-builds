{"version":3,"file":"fitWidth.js","names":["getDisplayName","Series","name","displayName","fitWidth","WrappedComponent","withRef","minWidth","ResponsiveComponent","props","handleWindowResize","bind","getWrappedInstance","saveNode","setTestCanvas","state","node","testCanvas","isDefined","context","getContext","devicePixelRatio","window","backingStoreRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","ratio","addEventListener","setState","getRatio","removeEventListener","width","el","getComputedStyle","parentNode","paddingLeft","paddingRight","w","parseFloat","Math","round","max","ref","Component"],"sources":["../../../src/lib/helper/fitWidth.js"],"sourcesContent":["import React, { Component } from \"react\";\r\n// import ReactDOM from \"react-dom\";\r\n\r\nimport { isDefined } from \"../utils\";\r\n\r\nfunction getDisplayName(Series) {\r\n\tconst name = Series.displayName || Series.name || \"Series\";\r\n\treturn name;\r\n}\r\n\r\nexport default function fitWidth(WrappedComponent, withRef = true, minWidth = 100) {\r\n\tclass ResponsiveComponent extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.handleWindowResize = this.handleWindowResize.bind(this);\r\n\t\t\tthis.getWrappedInstance = this.getWrappedInstance.bind(this);\r\n\t\t\tthis.saveNode = this.saveNode.bind(this);\r\n\t\t\tthis.setTestCanvas = this.setTestCanvas.bind(this);\r\n\t\t\tthis.state = {};\r\n\t\t}\r\n\t\tsaveNode(node) {\r\n\t\t\tthis.node = node;\r\n\t\t}\r\n\t\tsetTestCanvas(node) {\r\n\t\t\tthis.testCanvas = node;\r\n\t\t}\r\n\t\tgetRatio() {\r\n\t\t\tif (isDefined(this.testCanvas)) {\r\n\t\t\t\tconst context = this.testCanvas.getContext(\"2d\");\r\n\r\n\t\t\t\tconst devicePixelRatio = window.devicePixelRatio || 1;\r\n\t\t\t\tconst backingStoreRatio = context.webkitBackingStorePixelRatio ||\r\n\t\t\t\t\tcontext.mozBackingStorePixelRatio ||\r\n\t\t\t\t\tcontext.msBackingStorePixelRatio ||\r\n\t\t\t\t\tcontext.oBackingStorePixelRatio ||\r\n\t\t\t\t\tcontext.backingStorePixelRatio || 1;\r\n\r\n\t\t\t\tconst ratio = devicePixelRatio / backingStoreRatio;\r\n\t\t\t\t// console.log(\"ratio = \", ratio);\r\n\t\t\t\treturn ratio;\r\n\t\t\t}\r\n\t\t\treturn 1;\r\n\t\t}\r\n\t\tcomponentDidMount() {\r\n\t\t\twindow.addEventListener(\"resize\", this.handleWindowResize);\r\n\t\t\tthis.handleWindowResize();\r\n\t\t\t/* eslint-disable react/no-did-mount-set-state */\r\n\t\t\tthis.setState({\r\n\t\t\t\tratio: this.getRatio(),\r\n\t\t\t});\r\n\t\t\t/* eslint-enable react/no-did-mount-set-state */\r\n\t\t}\r\n\t\tcomponentWillUnmount() {\r\n\t\t\twindow.removeEventListener(\"resize\", this.handleWindowResize);\r\n\t\t}\r\n\t\thandleWindowResize() {\r\n\t\t\tthis.setState({\r\n\t\t\t\twidth: 0\r\n\t\t\t}, () => {\r\n\t\t\t\tconst el = this.node;\r\n\t\t\t\tconst { width, paddingLeft, paddingRight } = window.getComputedStyle(el.parentNode);\r\n\r\n\t\t\t\tconst w = parseFloat(width) - (parseFloat(paddingLeft) + parseFloat(paddingRight));\r\n\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\twidth: Math.round(Math.max(w, minWidth))\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\tgetWrappedInstance() {\r\n\t\t\treturn this.node;\r\n\t\t}\r\n\t\trender() {\r\n\t\t\tconst ref = withRef ? { ref: this.saveNode } : {};\r\n\r\n\t\t\tif (this.state.width) {\r\n\t\t\t\treturn <WrappedComponent width={this.state.width} ratio={this.state.ratio} {...this.props} {...ref} />;\r\n\t\t\t} else {\r\n\t\t\t\treturn <div {...ref}>\r\n\t\t\t\t\t<canvas ref={this.setTestCanvas}  />\r\n\t\t\t\t</div>;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tResponsiveComponent.displayName = `fitWidth(${ getDisplayName(WrappedComponent) })`;\r\n\r\n\treturn ResponsiveComponent;\r\n}\r\n\r\n"],"mappings":"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"}