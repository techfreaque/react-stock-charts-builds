{"version":3,"file":"SaveChartAsImage.js","names":["dx","dy","SaveChartAsImage","save","doc","container","background","cb","saveAsPng","svgAsDataUri","getElementsByTagName","uri","image","Image","onload","canvas","createElement","width","height","context","getContext","isDefined","fillStyle","fillRect","canvasList","i","length","each","parent","parentNode","getBoundingClientRect","rect","drawImage","left","top","toDataURL","src","saveWithWhiteBG","saveWithBG","saveWithDarkBG","saveChartAsImage","document","a","setAttribute","body","appendChild","addEventListener","removeChild","click"],"sources":["../../../src/lib/helper/SaveChartAsImage.js"],"sourcesContent":["\r\n\r\nimport saveAsPng from \"save-svg-as-png\";\r\nimport { isDefined } from \"../utils\";\r\n\r\nconst dx = 0;\r\nconst dy = 0;\r\n\r\nconst SaveChartAsImage = {\r\n\tsave(doc, container, background, cb) {\r\n\t\tsaveAsPng.svgAsDataUri(container.getElementsByTagName(\"svg\")[0], {}, function(uri) {\r\n\t\t\t// eslint-disable-next-line prefer-const\r\n\t\t\tlet image = new Image();\r\n\t\t\timage.onload = function() {\r\n\r\n\t\t\t\t// eslint-disable-next-line prefer-const\r\n\t\t\t\tlet canvas = doc.createElement(\"canvas\");\r\n\t\t\t\tcanvas.width = image.width;\r\n\t\t\t\tcanvas.height = image.height;\r\n\r\n\t\t\t\t// eslint-disable-next-line prefer-const\r\n\t\t\t\tlet context = canvas.getContext(\"2d\");\r\n\r\n\t\t\t\tif (isDefined(background)) {\r\n\t\t\t\t\tcontext.fillStyle = background;\r\n\t\t\t\t\tcontext.fillRect(0, 0, canvas.width, canvas.height);\r\n\t\t\t\t}\r\n\t\t\t\tconst canvasList = container.getElementsByTagName(\"canvas\");\r\n\t\t\t\tfor (let i = 0; i < canvasList.length; i++) {\r\n\t\t\t\t\tconst each = canvasList[i];\r\n\t\t\t\t\tif (isDefined(each)) {\r\n\t\t\t\t\t\tconst parent = each.parentNode.parentNode.getBoundingClientRect();\r\n\t\t\t\t\t\tconst rect = each.getBoundingClientRect();\r\n\t\t\t\t\t\tcontext.drawImage(each, rect.left - parent.left + dx, rect.top - parent.top + dy);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcontext.drawImage(image, dx, dy);\r\n\t\t\t\tcb(canvas.toDataURL(\"image/png\"));\r\n\t\t\t};\r\n\t\t\timage.src = uri;\r\n\t\t});\r\n\t},\r\n\tsaveWithWhiteBG(doc, container, cb) {\r\n\t\treturn this.saveWithBG(doc, container, \"white\", cb);\r\n\t},\r\n\tsaveWithDarkBG(doc, container, cb) {\r\n\t\treturn this.saveWithBG(doc, container, \"#303030\", cb);\r\n\t},\r\n\tsaveWithBG(doc, container, background, cb) {\r\n\t\treturn this.save(doc, container, background, cb);\r\n\t},\r\n\tsaveChartAsImage(container) {\r\n\t\tthis.saveWithWhiteBG(document, container, function(src) {\r\n\t\t\tconst a = document.createElement(\"a\");\r\n\t\t\ta.setAttribute(\"href\", src);\r\n\t\t\ta.setAttribute(\"download\", \"Chart.png\");\r\n\r\n\t\t\tdocument.body.appendChild(a);\r\n\t\t\ta.addEventListener(\"click\", function(/* e */) {\r\n\t\t\t\ta.parentNode.removeChild(a);\r\n\t\t\t});\r\n\r\n\t\t\ta.click();\r\n\t\t});\r\n\t}\r\n};\r\n\r\nexport default SaveChartAsImage;"],"mappings":"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"}