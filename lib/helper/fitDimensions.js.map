{"version":3,"file":"fitDimensions.js","names":["getDisplayName","Series","name","displayName","fitDimensions","WrappedComponent","props","minWidth","minHeight","ratio","width","height","getDimensions","el","w","parentNode","clientWidth","h","clientHeight","isDefined","Math","max","ResponsiveComponent","handleWindowResize","bind","getWrappedInstance","saveNode","setTestCanvas","state","node","testCanvas","context","getContext","devicePixelRatio","window","backingStoreRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","addEventListener","dimensions","setState","getRatio","removeEventListener","ReactDOM","findDOMNode","ref","Component"],"sources":["../../../src/lib/helper/fitDimensions.js"],"sourcesContent":["import React, { Component } from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\n\r\nimport { isDefined } from \"../utils\";\r\n\r\nfunction getDisplayName(Series) {\r\n\tconst name = Series.displayName || Series.name || \"Series\";\r\n\treturn name;\r\n}\r\n\r\nexport default function fitDimensions(WrappedComponent, props = {}) {\r\n\r\n\tconst {\r\n\t\tminWidth = 100,\r\n\t\tminHeight = 100,\r\n\t\tratio,\r\n\t\twidth,\r\n\t\theight,\r\n\t} = props;\r\n\r\n\tfunction getDimensions(el) {\r\n\t\tconst w = el.parentNode.clientWidth;\r\n\t\tconst h = el.parentNode.clientHeight;\r\n\r\n\t\treturn {\r\n\t\t\twidth: isDefined(width) ? width : Math.max(w, minWidth),\r\n\t\t\theight: isDefined(height) ? height : Math.max(h, minHeight),\r\n\t\t};\r\n\t}\r\n\tclass ResponsiveComponent extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.handleWindowResize = this.handleWindowResize.bind(this);\r\n\t\t\tthis.getWrappedInstance = this.getWrappedInstance.bind(this);\r\n\t\t\tthis.saveNode = this.saveNode.bind(this);\r\n\t\t\tthis.setTestCanvas = this.setTestCanvas.bind(this);\r\n\t\t\tthis.state = {};\r\n\t\t}\r\n\t\tsaveNode(node) {\r\n\t\t\tthis.node = node;\r\n\t\t}\r\n\t\tsetTestCanvas(node) {\r\n\t\t\tthis.testCanvas = node;\r\n\t\t}\r\n\t\tgetRatio() {\r\n\t\t\tif (isDefined(this.testCanvas)) {\r\n\t\t\t\tconst context = this.testCanvas.getContext(\"2d\");\r\n\r\n\t\t\t\tconst devicePixelRatio = window.devicePixelRatio || 1;\r\n\t\t\t\tconst backingStoreRatio = context.webkitBackingStorePixelRatio ||\r\n\t\t\t\t\t\t\t\tcontext.mozBackingStorePixelRatio ||\r\n\t\t\t\t\t\t\t\tcontext.msBackingStorePixelRatio ||\r\n\t\t\t\t\t\t\t\tcontext.oBackingStorePixelRatio ||\r\n\t\t\t\t\t\t\t\tcontext.backingStorePixelRatio || 1;\r\n\r\n\t\t\t\tconst ratio = devicePixelRatio / backingStoreRatio;\r\n\t\t\t\t// console.log(\"ratio = \", ratio);\r\n\t\t\t\treturn ratio;\r\n\t\t\t}\r\n\t\t\treturn 1;\r\n\t\t}\r\n\t\tcomponentDidMount() {\r\n\t\t\twindow.addEventListener(\"resize\", this.handleWindowResize);\r\n\t\t\tconst dimensions = getDimensions(this.node);\r\n\r\n\t\t\t/* eslint-disable react/no-did-mount-set-state */\r\n\t\t\tthis.setState({\r\n\t\t\t\t...dimensions,\r\n\t\t\t\tratio: isDefined(ratio) ? ratio : this.getRatio(),\r\n\t\t\t});\r\n\t\t\t/* eslint-enable react/no-did-mount-set-state */\r\n\t\t}\r\n\t\tcomponentWillUnmount() {\r\n\t\t\twindow.removeEventListener(\"resize\", this.handleWindowResize);\r\n\t\t}\r\n\t\thandleWindowResize() {\r\n\t\t\tconst node = ReactDOM.findDOMNode(this.node); // eslint-disable-line react/no-find-dom-node\r\n\t\t\tthis.setState(getDimensions(node));\r\n\t\t}\r\n\t\tgetWrappedInstance() {\r\n\t\t\treturn this.node;\r\n\t\t}\r\n\t\trender() {\r\n\t\t\tconst ref = { ref: this.saveNode };\r\n\r\n\t\t\tif (this.state.width) {\r\n\t\t\t\treturn <WrappedComponent\r\n\t\t\t\t\theight={this.state.height}\r\n\t\t\t\t\twidth={this.state.width}\r\n\t\t\t\t\tratio={this.state.ratio}\r\n\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t{...ref}\r\n\t\t\t\t/>;\r\n\t\t\t} else {\r\n\t\t\t\treturn <div {...ref}>\r\n\t\t\t\t\t<canvas ref={this.setTestCanvas}  />\r\n\t\t\t\t</div>;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tResponsiveComponent.displayName = `fitDimensions(${ getDisplayName(WrappedComponent) })`;\r\n\r\n\treturn ResponsiveComponent;\r\n}\r\n\r\n"],"mappings":"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"}