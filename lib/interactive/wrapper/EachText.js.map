{"version":3,"file":"EachText.js","names":["EachText","props","handleHover","bind","handleDragStart","handleDrag","isHover","saveNodeType","nodes","state","hover","moreProps","position","mouseXY","yScale","chartConfig","xScale","mouseX","mouseY","textCX","textCY","dx","dy","dragStartPosition","index","onDrag","xAccessor","plotData","xValue","invert","getXValue","xyValue","hovering","setState","bgFill","bgOpacity","bgStroke","bgStrokeWidth","textFill","fontFamily","fontSize","fontWeight","fontStyle","text","hoverText","selected","onDragComplete","hoverHandler","onHover","onUnHover","hoverTextEnabled","enable","hoverTextSelected","selectedText","hoverTextUnselected","restHoverTextProps","Component","propTypes","PropTypes","number","array","isRequired","string","bool","func","object","defaultProps","noop","fill","HoverTextNearMouse","bgHeight","bgWidth"],"sources":["../../../../src/lib/interactive/wrapper/EachText.js"],"sourcesContent":["import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport { noop } from \"../../utils\";\r\nimport { saveNodeType, isHover } from \"../utils\";\r\nimport { getXValue } from \"../../utils/ChartDataUtil\";\r\n\r\nimport HoverTextNearMouse from \"../components/HoverTextNearMouse\";\r\nimport InteractiveText from \"../components/InteractiveText\";\r\n\r\nclass EachText extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.handleHover = this.handleHover.bind(this);\r\n\r\n\t\tthis.handleDragStart = this.handleDragStart.bind(this);\r\n\t\tthis.handleDrag = this.handleDrag.bind(this);\r\n\r\n\t\tthis.isHover = isHover.bind(this);\r\n\t\tthis.saveNodeType = saveNodeType.bind(this);\r\n\t\tthis.nodes = {};\r\n\r\n\t\tthis.state = {\r\n\t\t\thover: false,\r\n\t\t};\r\n\t}\r\n\thandleDragStart(moreProps) {\r\n\t\tconst {\r\n\t\t\tposition,\r\n\t\t} = this.props;\r\n\t\tconst { mouseXY } = moreProps;\r\n\t\tconst { chartConfig: { yScale }, xScale } = moreProps;\r\n\t\tconst [mouseX, mouseY] = mouseXY;\r\n\r\n\t\tconst [textCX, textCY] = position;\r\n\t\tconst dx = mouseX - xScale(textCX);\r\n\t\tconst dy = mouseY - yScale(textCY);\r\n\r\n\t\tthis.dragStartPosition = {\r\n\t\t\tposition, dx, dy\r\n\t\t};\r\n\t}\r\n\thandleDrag(moreProps) {\r\n\t\tconst { index, onDrag } = this.props;\r\n\t\tconst {\r\n\t\t\tmouseXY: [, mouseY],\r\n\t\t\tchartConfig: { yScale },\r\n\t\t\txAccessor,\r\n\t\t\tmouseXY,\r\n\t\t\tplotData,\r\n\t\t\txScale,\r\n\t\t} = moreProps;\r\n\r\n\t\tconst { dx, dy } = this.dragStartPosition;\r\n\t\tconst xValue = xScale.invert(\r\n\t\t\txScale(getXValue(xScale, xAccessor, mouseXY, plotData)) - dx\r\n\t\t);\r\n\t\t// xScale.invert(xScale(xAccessor(currentItem)) - dx);\r\n\t\tconst xyValue = [\r\n\t\t\txValue,\r\n\t\t\tyScale.invert(mouseY - dy)\r\n\t\t];\r\n\r\n\t\tonDrag(index, xyValue);\r\n\t}\r\n\thandleHover(moreProps) {\r\n\t\tif (this.state.hover !== moreProps.hovering) {\r\n\t\t\tthis.setState({\r\n\t\t\t\thover: moreProps.hovering\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tposition,\r\n\t\t\tbgFill,\r\n\t\t\tbgOpacity,\r\n\t\t\tbgStroke,\r\n\t\t\tbgStrokeWidth,\r\n\t\t\ttextFill,\r\n\t\t\tfontFamily,\r\n\t\t\tfontSize,\r\n\t\t\tfontWeight,\r\n\t\t\tfontStyle,\r\n\t\t\ttext,\r\n\t\t\thoverText,\r\n\t\t\tselected,\r\n\t\t\tonDragComplete,\r\n\t\t} = this.props;\r\n\t\tconst { hover } = this.state;\r\n\r\n\t\tconst hoverHandler = {\r\n\t\t\tonHover: this.handleHover,\r\n\t\t\tonUnHover: this.handleHover\r\n\t\t};\r\n\r\n\t\tconst {\r\n\t\t\tenable: hoverTextEnabled,\r\n\t\t\tselectedText: hoverTextSelected,\r\n\t\t\ttext: hoverTextUnselected,\r\n\t\t\t...restHoverTextProps\r\n\t\t} = hoverText;\r\n\r\n\t\treturn <g>\r\n\t\t\t<InteractiveText\r\n\t\t\t\tref={this.saveNodeType(\"text\")}\r\n\t\t\t\tselected={selected || hover}\r\n\t\t\t\tinteractiveCursorClass=\"react-stockcharts-move-cursor\"\r\n\t\t\t\t{...hoverHandler}\r\n\r\n\t\t\t\tonDragStart={this.handleDragStart}\r\n\t\t\t\tonDrag={this.handleDrag}\r\n\t\t\t\tonDragComplete={onDragComplete}\r\n\t\t\t\tposition={position}\r\n\t\t\t\tbgFill={bgFill}\r\n\t\t\t\tbgOpacity={bgOpacity}\r\n\t\t\t\tbgStroke={bgStroke || textFill}\r\n\t\t\t\tbgStrokeWidth={bgStrokeWidth}\r\n\t\t\t\ttextFill={textFill}\r\n\t\t\t\tfontFamily={fontFamily}\r\n\t\t\t\tfontStyle={fontStyle}\r\n\t\t\t\tfontWeight={fontWeight}\r\n\t\t\t\tfontSize={fontSize}\r\n\t\t\t\ttext={text}\r\n\t\t\t/>\r\n\t\t\t<HoverTextNearMouse\r\n\t\t\t\tshow={hoverTextEnabled && hover}\r\n\t\t\t\t{...restHoverTextProps}\r\n\t\t\t\ttext={selected ? hoverTextSelected : hoverTextUnselected}\r\n\t\t\t/>\r\n\t\t</g>;\r\n\t}\r\n}\r\n/*\r\nexport function getNewXY(moreProps, snapTo) {\r\n\tconst { xScale, xAccessor, plotData, mouseXY } = moreProps;\r\n\r\n\tconst currentItem = getCurrentItem(xScale, xAccessor, mouseXY, plotData);\r\n\tconst x = xAccessor(currentItem);\r\n\tconst y = snapTo(currentItem);\r\n\r\n\treturn [x, y];\r\n}\r\n */\r\nEachText.propTypes = {\r\n\tindex: PropTypes.number,\r\n\r\n\tposition: PropTypes.array.isRequired,\r\n\tbgFill: PropTypes.string.isRequired,\r\n\tbgOpacity: PropTypes.number.isRequired,\r\n\tbgStrokeWidth: PropTypes.number.isRequired,\r\n\tbgStroke: PropTypes.string,\r\n\ttextFill: PropTypes.string.isRequired,\r\n\r\n\tfontWeight: PropTypes.string.isRequired,\r\n\tfontFamily: PropTypes.string.isRequired,\r\n\tfontStyle: PropTypes.string.isRequired,\r\n\tfontSize: PropTypes.number.isRequired,\r\n\r\n\ttext: PropTypes.string.isRequired,\r\n\tselected: PropTypes.bool.isRequired,\r\n\r\n\tonDrag: PropTypes.func.isRequired,\r\n\tonDragComplete: PropTypes.func.isRequired,\r\n\r\n\thoverText: PropTypes.object.isRequired,\r\n};\r\n\r\nEachText.defaultProps = {\r\n\tonDrag: noop,\r\n\tonDragComplete: noop,\r\n\tbgOpacity: 1,\r\n\tbgStrokeWidth: 1,\r\n\tselected: false,\r\n\tfill: \"#8AAFE2\",\r\n\thoverText: {\r\n\t\t...HoverTextNearMouse.defaultProps,\r\n\t\tenable: true,\r\n\t\tbgHeight: \"auto\",\r\n\t\tbgWidth: \"auto\",\r\n\t\ttext: \"Click to select object\",\r\n\t}\r\n};\r\n\r\nexport default EachText;"],"mappings":"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"}