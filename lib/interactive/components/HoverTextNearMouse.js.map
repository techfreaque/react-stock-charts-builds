{"version":3,"file":"HoverTextNearMouse.js","names":["PADDING","MIN_WIDTH","HoverTextNearMouse","props","state","textWidth","undefined","textHeight","saveNode","bind","updateTextSize","renderSVG","node","textNode","bgWidth","bgHeight","getBBox","width","height","setState","moreProps","fontFamily","fontSize","fill","bgFill","bgOpacity","textMetaData","helper","getBgWidth","getBgHeight","isDefined","rect","text","x","y","Component","numberOrString","PropTypes","oneOfType","number","oneOf","propTypes","string","isRequired","show","bool","defaultProps","mouseXY","chartConfig","mouseInsideCanvas","cx","cy"],"sources":["../../../../src/lib/interactive/components/HoverTextNearMouse.js"],"sourcesContent":["import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport GenericChartComponent from \"../../GenericChartComponent\";\r\nimport { isDefined } from \"../../utils\";\r\n\r\nconst PADDING = 10;\r\nconst MIN_WIDTH = PADDING;\r\n\r\nclass HoverTextNearMouse extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\ttextWidth: undefined,\r\n\t\t\ttextHeight: undefined,\r\n\t\t};\r\n\r\n\t\tthis.saveNode = this.saveNode.bind(this);\r\n\t\tthis.updateTextSize = this.updateTextSize.bind(this);\r\n\t\tthis.renderSVG = this.renderSVG.bind(this);\r\n\t}\r\n\tsaveNode(node) {\r\n\t\tthis.textNode = node;\r\n\t}\r\n\r\n\tupdateTextSize() {\r\n\t\tconst { bgWidth, bgHeight } = this.props;\r\n\t\tif (bgWidth === \"auto\" || bgHeight === \"auto\") {\r\n\t\t\tconst textNode = this.textNode;\r\n\t\t\tif (textNode) {\r\n\t\t\t\tconst { width, height } = textNode.getBBox();\r\n\t\t\t\tif (this.state.textWidth !== width || this.state.textHeight !== height) {\r\n\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\ttextWidth: width,\r\n\t\t\t\t\t\ttextHeight: height\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.updateTextSize();\r\n\t}\r\n\r\n\tcomponentDidUpdate() {\r\n\t\tthis.updateTextSize();\r\n\t}\r\n\r\n\tgetBgWidth() {\r\n\t\tconst { bgWidth } = this.props;\r\n\t\tconst { textWidth } = this.state;\r\n\r\n\t\tif (bgWidth !== \"auto\") {\r\n\t\t\treturn bgWidth;\r\n\t\t} else if (textWidth !== undefined) {\r\n\t\t\treturn textWidth + PADDING;\r\n\t\t} else {\r\n\t\t\treturn MIN_WIDTH;\r\n\t\t}\r\n\t}\r\n\r\n\tgetBgHeight() {\r\n\t\tconst { bgHeight } = this.props;\r\n\t\tconst { textHeight } = this.state;\r\n\r\n\t\tif (bgHeight !== \"auto\") {\r\n\t\t\treturn bgHeight;\r\n\t\t} else if (textHeight !== undefined) {\r\n\t\t\treturn textHeight + PADDING;\r\n\t\t} else {\r\n\t\t\treturn MIN_WIDTH;\r\n\t\t}\r\n\t}\r\n\r\n\trenderSVG(moreProps) {\r\n\t\tconst {\r\n\t\t\tfontFamily,\r\n\t\t\tfontSize,\r\n\t\t\tfill,\r\n\t\t\tbgFill,\r\n\t\t\tbgOpacity,\r\n\t\t} = this.props;\r\n\r\n\t\t// console.log(moreProps)\r\n\t\tconst textMetaData = helper({\r\n\t\t\t...this.props,\r\n\t\t\tbgWidth: this.getBgWidth(),\r\n\t\t\tbgHeight: this.getBgHeight()\r\n\t\t}, moreProps);\r\n\r\n\t\tif (isDefined(textMetaData)) {\r\n\t\t\tconst { rect, text } = textMetaData;\r\n\t\t\treturn (\r\n\t\t\t\t<g>\r\n\t\t\t\t\t<rect\r\n\t\t\t\t\t\tfillRule={bgFill}\r\n\t\t\t\t\t\tfillOpacity={bgOpacity}\r\n\t\t\t\t\t\tstroke={bgFill}\r\n\t\t\t\t\t\t{...rect}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<text\r\n\t\t\t\t\t\tref={this.saveNode}\r\n\t\t\t\t\t\tfontSize={fontSize}\r\n\t\t\t\t\t\tfontFamily={fontFamily}\r\n\t\t\t\t\t\ttextAnchor=\"start\"\r\n\t\t\t\t\t\talignmentBaseline={\"central\"}\r\n\t\t\t\t\t\tfillRule={fill}\r\n\t\t\t\t\t\tx={text.x}\r\n\t\t\t\t\t\ty={text.y}>{text.text}</text>\r\n\t\t\t\t</g>\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\trender() {\r\n\t\tconst { text } = this.props;\r\n\t\tif (text) {\r\n\t\t\treturn <GenericChartComponent\r\n\t\t\t\tsvgDraw={this.renderSVG}\r\n\t\t\t\tdrawOn={[\"mousemove\"]}\r\n\t\t\t/>;\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst numberOrString = PropTypes.oneOfType([\r\n\tPropTypes.number,\r\n\tPropTypes.oneOf([\"auto\"]),\r\n]);\r\n\r\nHoverTextNearMouse.propTypes = {\r\n\tfontFamily: PropTypes.string.isRequired,\r\n\tfontSize: PropTypes.number.isRequired,\r\n\tfill: PropTypes.string.isRequired,\r\n\ttext: PropTypes.string.isRequired,\r\n\tbgFill: PropTypes.string.isRequired,\r\n\tbgOpacity: PropTypes.number.isRequired,\r\n\tbgWidth: numberOrString.isRequired,\r\n\tbgHeight: numberOrString.isRequired,\r\n\tshow: PropTypes.bool.isRequired,\r\n};\r\n\r\nHoverTextNearMouse.defaultProps = {\r\n\tfontFamily: \"Helvetica Neue, Helvetica, Arial, sans-serif\",\r\n\tfontSize: 12,\r\n\tfill: \"#000000\",\r\n\tbgFill: \"#FA9325\",\r\n\tbgOpacity: 0.5,\r\n};\r\n\r\nfunction helper(props, moreProps) {\r\n\tconst {\r\n\t\tshow,\r\n\t\tbgWidth,\r\n\t\tbgHeight,\r\n\t} = props;\r\n\r\n\tconst {\r\n\t\tmouseXY,\r\n\t\tchartConfig: { height, width },\r\n\t\tshow: mouseInsideCanvas\r\n\t} = moreProps;\r\n\r\n\tif (show && mouseInsideCanvas) {\r\n\t\tconst [x, y] = mouseXY;\r\n\r\n\t\tconst cx = x < width / 2\r\n\t\t\t? x + PADDING\r\n\t\t\t: x - bgWidth - PADDING;\r\n\r\n\t\tconst cy = y < height / 2\r\n\t\t\t? y + PADDING\r\n\t\t\t: y - bgHeight - PADDING;\r\n\r\n\t\tconst rect = {\r\n\t\t\tx: cx,\r\n\t\t\ty: cy,\r\n\t\t\twidth: bgWidth,\r\n\t\t\theight: bgHeight,\r\n\t\t};\r\n\r\n\t\tconst text = {\r\n\t\t\ttext: props.text,\r\n\t\t\tx: cx + PADDING / 2,\r\n\t\t\ty: cy + bgHeight / 2,\r\n\t\t};\r\n\r\n\t\treturn {\r\n\t\t\trect,\r\n\t\t\ttext\r\n\t\t};\r\n\t}\r\n}\r\n\r\nexport default HoverTextNearMouse;\r\n"],"mappings":"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"}