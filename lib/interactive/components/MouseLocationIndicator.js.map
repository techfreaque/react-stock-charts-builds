{"version":3,"file":"MouseLocationIndicator.js","names":["MouseLocationIndicator","props","renderSVG","bind","drawOnCanvas","handleMousePosChange","handleMouseDown","handleClick","xy","mutableState","moreProps","e","pos","isDefined","xValue","yValue","x","y","onMouseDown","onClick","xAccessor","plotData","mouseXY","currentItem","xScale","yScale","chartConfig","enabled","snap","shouldDisableSnap","snapTo","getXValue","getClosestValue","invert","shallowEqual","mousXY","prevMouseXY","onMouseMove","ctx","r","stroke","strokeWidth","show","lineWidth","strokeStyle","moveTo","beginPath","arc","Math","PI","opacity","disablePan","handleContextMenu","getMouseCanvas","Component","propTypes","PropTypes","bool","isRequired","func","number","string","defaultProps","noop","functor"],"sources":["../../../../src/lib/interactive/components/MouseLocationIndicator.js"],"sourcesContent":["import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport GenericChartComponent from \"../../GenericChartComponent\";\r\nimport { getMouseCanvas } from \"../../GenericComponent\";\r\n\r\nimport { isDefined, getClosestValue, noop, shallowEqual, functor } from \"../../utils\";\r\nimport { getXValue } from \"../../utils/ChartDataUtil\";\r\n\r\nclass MouseLocationIndicator extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.renderSVG = this.renderSVG.bind(this);\r\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\r\n\r\n\t\tthis.handleMousePosChange = this.handleMousePosChange.bind(this);\r\n\t\tthis.handleMouseDown = this.handleMouseDown.bind(this);\r\n\t\tthis.handleClick = this.handleClick.bind(this);\r\n\t\tthis.xy = this.xy.bind(this);\r\n\r\n\t\tthis.mutableState = {};\r\n\t}\r\n\thandleMouseDown(moreProps, e) {\r\n\t\tconst pos = this.xy(moreProps, e);\r\n\t\tif (isDefined(pos)) {\r\n\t\t\tconst { xValue, yValue, x, y } = pos;\r\n\t\t\tthis.mutableState = { x, y };\r\n\t\t\tthis.props.onMouseDown([xValue, yValue], moreProps, e);\r\n\t\t}\r\n\t}\r\n\thandleClick(moreProps, e) {\r\n\t\tconst pos = this.xy(moreProps, e);\r\n\t\tif (isDefined(pos)) {\r\n\t\t\tconst { xValue, yValue, x, y } = pos;\r\n\t\t\tthis.mutableState = { x, y };\r\n\t\t\tthis.props.onClick([xValue, yValue], moreProps, e);\r\n\t\t}\r\n\t}\r\n\txy(moreProps, e) {\r\n\t\tconst { xAccessor, plotData } = moreProps;\r\n\t\tconst { mouseXY, currentItem, xScale, chartConfig: { yScale } } = moreProps;\r\n\t\tconst { enabled, snap, shouldDisableSnap, snapTo } = this.props;\r\n\r\n\t\tif (enabled && isDefined(currentItem) && isDefined(e)) {\r\n\t\t\tconst xValue =  snap && !shouldDisableSnap(e)\r\n\t\t\t\t? xAccessor(currentItem)\r\n\t\t\t\t: getXValue(xScale, xAccessor, mouseXY, plotData);\r\n\t\t\tconst yValue = snap && !shouldDisableSnap(e)\r\n\t\t\t\t? getClosestValue(snapTo(currentItem), yScale.invert(mouseXY[1]))\r\n\t\t\t\t: yScale.invert(mouseXY[1]);\r\n\r\n\t\t\tconst x = xScale(xValue);\r\n\t\t\tconst y = yScale(yValue);\r\n\r\n\t\t\treturn { xValue, yValue, x, y };\r\n\t\t}\r\n\t}\r\n\thandleMousePosChange(moreProps, e) {\r\n\t\tif (!shallowEqual(moreProps.mousXY, moreProps.prevMouseXY)) {\r\n\t\t\tconst pos = this.xy(moreProps, e);\r\n\t\t\tif (isDefined(pos)) {\r\n\t\t\t\tconst { xValue, yValue, x, y } = pos;\r\n\t\t\t\tthis.mutableState = { x, y };\r\n\t\t\t\tthis.props.onMouseMove([xValue, yValue], e);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tdrawOnCanvas(ctx, moreProps) {\r\n\t\tconst { enabled, r, stroke, strokeWidth } = this.props;\r\n\t\tconst { x, y } = this.mutableState;\r\n\t\tconst { show } = moreProps;\r\n\t\t// console.log(show)\r\n\t\tif (enabled && show && isDefined(x)) {\r\n\t\t\tctx.lineWidth = strokeWidth;\r\n\t\t\tctx.strokeStyle = stroke;\r\n\t\t\tctx.moveTo(x, y);\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.arc(x, y, r, 0, 2 * Math.PI, false);\r\n\t\t\tctx.stroke();\r\n\t\t\t// ctx.fill();\r\n\t\t}\r\n\t}\r\n\trenderSVG(moreProps) {\r\n\t\tconst { enabled, r, stroke, strokeWidth, opacity } = this.props;\r\n\t\tconst { x, y } = this.mutableState;\r\n\t\tconst { show } = moreProps;\r\n\r\n\t\t// console.log(\"HERE\")\r\n\t\t// console.log(stroke, strokeWidth, opacity)\r\n\r\n\t\treturn enabled && show && isDefined(x)\r\n\t\t\t? <circle\r\n\t\t\t\tcx={x}\r\n\t\t\t\tcy={y}\r\n\t\t\t\tr={r}\r\n\t\t\t\tstroke={stroke}\r\n\t\t\t\topacity={opacity}\r\n\t\t\t\tfillRule=\"none\"\r\n\t\t\t\tstrokeWidth={strokeWidth} />\r\n\t\t\t: null;\r\n\r\n\t}\r\n\trender() {\r\n\t\tconst { enabled, disablePan } = this.props;\r\n\t\treturn <GenericChartComponent\r\n\t\t\tonMouseDown={this.handleMouseDown}\r\n\t\t\tonClick={this.handleClick}\r\n\t\t\tonContextMenu={this.handleContextMenu}\r\n\t\t\tonMouseMove={this.handleMousePosChange}\r\n\t\t\tonPan={this.handleMousePosChange}\r\n\r\n\t\t\tdisablePan={enabled && disablePan}\r\n\r\n\t\t\tsvgDraw={this.renderSVG}\r\n\r\n\t\t\tcanvasDraw={this.drawOnCanvas}\r\n\t\t\tcanvasToDraw={getMouseCanvas}\r\n\r\n\t\t\tdrawOn={[\"mousemove\", \"pan\"]}\r\n\t\t/>;\r\n\t}\r\n}\r\n\r\nMouseLocationIndicator.propTypes = {\r\n\tenabled: PropTypes.bool.isRequired,\r\n\tsnap: PropTypes.bool.isRequired,\r\n\tshouldDisableSnap: PropTypes.func.isRequired,\r\n\tsnapTo: PropTypes.func,\r\n\r\n\tonMouseMove: PropTypes.func.isRequired,\r\n\tonMouseDown: PropTypes.func.isRequired,\r\n\tonClick: PropTypes.func.isRequired,\r\n\tr: PropTypes.number.isRequired,\r\n\tstroke: PropTypes.string.isRequired,\r\n\tstrokeWidth: PropTypes.number.isRequired,\r\n\topacity: PropTypes.number.isRequired,\r\n\tdisablePan: PropTypes.bool.isRequired,\r\n};\r\n\r\nMouseLocationIndicator.defaultProps = {\r\n\tonMouseMove: noop,\r\n\tonMouseDown: noop,\r\n\tonClick: noop,\r\n\tshouldDisableSnap: functor(false),\r\n\tstroke: \"#000000\",\r\n\tstrokeWidth: 1,\r\n\topacity: 1,\r\n\tdisablePan: true,\r\n};\r\n\r\nexport default MouseLocationIndicator;"],"mappings":"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"}