{"version":3,"file":"ClickableShape.js","names":["ClickableShape","props","saveNode","bind","drawOnCanvas","isHover","node","moreProps","mouseXY","closeIcon","textBox","x","y","halfWidth","width","start1","end1","start2","end2","isHovering2","ctx","stroke","strokeWidth","strokeOpacity","hovering","helper","beginPath","lineWidth","strokeStyle","hexToRGBA","moveTo","lineTo","Error","interactiveCursorClass","show","onHover","onUnHover","onClick","renderSVG","getMouseCanvas","Component","yValue","text","fontFamily","fontStyle","fontWeight","fontSize","font","yScale","chartConfig","left","padding","measureText","right","propTypes","PropTypes","string","isRequired","number","object","bool","func","defaultProps","fillOpacity"],"sources":["../../../../src/lib/interactive/components/ClickableShape.js"],"sourcesContent":["import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport GenericChartComponent from \"../../GenericChartComponent\";\r\nimport { getMouseCanvas } from \"../../GenericComponent\";\r\n\r\nimport { isHovering2 } from \"./StraightLine\";\r\nimport { hexToRGBA } from \"../../utils\";\r\n\r\nclass ClickableShape extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.saveNode = this.saveNode.bind(this);\r\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\r\n\t\tthis.isHover = this.isHover.bind(this);\r\n\t}\r\n\tsaveNode(node) {\r\n\t\tthis.node = node;\r\n\t}\r\n\tisHover(moreProps) {\r\n\t\tconst { mouseXY } = moreProps;\r\n\t\tif (this.closeIcon) {\r\n\t\t\tconst { textBox } = this.props;\r\n\t\t\tconst { x, y } = this.closeIcon;\r\n\t\t\tconst halfWidth = textBox.closeIcon.width / 2;\r\n\r\n\t\t\tconst start1 = [x - halfWidth, y - halfWidth];\r\n\t\t\tconst end1 = [x + halfWidth, y + halfWidth];\r\n\t\t\tconst start2 = [x - halfWidth, y + halfWidth];\r\n\t\t\tconst end2 = [x + halfWidth, y - halfWidth];\r\n\r\n\t\t\tif (isHovering2(start1, end1, mouseXY, 3) || isHovering2(start2, end2, mouseXY, 3)) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\tdrawOnCanvas(ctx, moreProps) {\r\n\t\tconst { stroke, strokeWidth, strokeOpacity, hovering, textBox } = this.props;\r\n\r\n\t\tconst [x, y] = helper(this.props, moreProps, ctx);\r\n\r\n\t\tthis.closeIcon = { x, y };\r\n\t\tctx.beginPath();\r\n\r\n\t\tctx.lineWidth = hovering ? strokeWidth + 1 : strokeWidth;\r\n\t\tctx.strokeStyle = hexToRGBA(stroke, strokeOpacity);\r\n\t\tconst halfWidth = textBox.closeIcon.width / 2;\r\n\t\tctx.moveTo(x - halfWidth, y - halfWidth);\r\n\t\tctx.lineTo(x + halfWidth, y + halfWidth);\r\n\t\tctx.moveTo(x - halfWidth, y + halfWidth);\r\n\t\tctx.lineTo(x + halfWidth, y - halfWidth);\r\n\t\tctx.stroke();\r\n\t}\r\n\trenderSVG() {\r\n\t\tthrow new Error(\"svg not implemented\");\r\n\t}\r\n\trender() {\r\n\t\tconst { interactiveCursorClass } = this.props;\r\n\t\tconst { show } = this.props;\r\n\t\tconst { onHover, onUnHover, onClick } = this.props;\r\n\r\n\t\treturn show\r\n\t\t\t? <GenericChartComponent ref={this.saveNode}\r\n\t\t\t\tinteractiveCursorClass={interactiveCursorClass}\r\n\t\t\t\tisHover={this.isHover}\r\n\r\n\t\t\t\tonClickWhenHover={onClick}\r\n\r\n\t\t\t\tsvgDraw={this.renderSVG}\r\n\r\n\t\t\t\tcanvasDraw={this.drawOnCanvas}\r\n\t\t\t\tcanvasToDraw={getMouseCanvas}\r\n\r\n\t\t\t\tonHover={onHover}\r\n\t\t\t\tonUnHover={onUnHover}\r\n\r\n\t\t\t\tdrawOn={[\"pan\", \"mousemove\", \"drag\"]}\r\n\t\t\t/>\r\n\t\t\t: null;\r\n\t}\r\n}\r\n\r\nfunction helper(props, moreProps, ctx) {\r\n\tconst { yValue, text, textBox } = props;\r\n\tconst { fontFamily, fontStyle, fontWeight, fontSize } = props;\r\n\tctx.font = `${fontStyle} ${fontWeight} ${fontSize}px ${fontFamily}`;\r\n\r\n\tconst { chartConfig: { yScale } } = moreProps;\r\n\r\n\tconst x = textBox.left\r\n\t\t+ textBox.padding.left\r\n\t\t+ ctx.measureText(text).width\r\n\t\t+ textBox.padding.right\r\n\t\t+ textBox.closeIcon.padding.left\r\n\t\t+ textBox.closeIcon.width / 2;\r\n\r\n\tconst y = yScale(yValue);\r\n\r\n\treturn [x, y];\r\n\r\n}\r\n\r\nClickableShape.propTypes = {\r\n\tstroke: PropTypes.string.isRequired,\r\n\tstrokeOpacity: PropTypes.number.isRequired,\r\n\tstrokeWidth: PropTypes.number.isRequired,\r\n\ttextBox: PropTypes.object.isRequired,\r\n\thovering: PropTypes.bool,\r\n\tinteractiveCursorClass: PropTypes.string,\r\n\tshow: PropTypes.bool,\r\n\tonHover: PropTypes.func,\r\n\tonUnHover: PropTypes.func,\r\n\tonClick: PropTypes.func,\r\n};\r\n\r\n\r\nClickableShape.defaultProps = {\r\n\tshow: false,\r\n\tfillOpacity: 1,\r\n\tstrokeOpacity: 1,\r\n\tstrokeWidth: 1,\r\n};\r\n\r\nexport default ClickableShape;\r\n"],"mappings":"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"}