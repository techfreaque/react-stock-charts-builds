{"version":3,"file":"EventCapture.js","names":["EventCapture","props","handleEnter","bind","handleLeave","handleWheel","handleMouseMove","handleMouseDown","handlePanEnd","handlePan","handleTouchStart","handleTouchMove","handlePinchZoom","handlePinchZoomEnd","handleClick","handleRightClick","handleDrag","handleDragEnd","shouldPan","canPan","setCursorClass","saveNode","mouseInside","mouseInteraction","state","panInProgress","node","focus","select","on","MOUSEENTER","MOUSELEAVE","componentDidMount","win","d3Window","MOUSEMOVE","e","d3Event","onMouseEnter","dragInProgress","onMouseLeave","zoom","onZoom","yZoom","Math","abs","deltaY","deltaX","mouseXY","mousePosition","preventDefault","zoomDir","panStart","panStartXScale","chartsToPan","lastNewPos","panHappened","dx","dy","dxdy","onPan","xScale","chartConfig","currentCharts","getCurrentCharts","setState","panOrigin","queuePanEnd","isDefined","panEndTimeout","clearTimeout","setTimeout","onMouseMove","mouseMove","newPos","mouse","onClick","onDoubleClick","dragHappened","clicked","stopPropagation","onContextMenu","onPanEnd","getBoundingClientRect","MOUSEUP","onDrag","startPos","dragStartPosition","onDragComplete","getAllPanConditions","initialPanEnabled","pan","reduce","returnObj","a","draggable","panEnabled","somethingSelected","button","onMouseDown","onDragStart","touches","TOUCHMOVE","TOUCHEND","touchXY","touchPosition","getTouchProps","length","touch1Pos","touch2Pos","pinchZoomStart","range","zoomEnabled","onPinchZoom","initialPinch","onPinchZoomEnd","cursorOverrideClass","height","width","disableInteraction","useCrossHairStyleCursor","className","interactionProps","onWheel","onTouchStart","onTouchMove","opacity","Component","propTypes","PropTypes","bool","isRequired","panSpeedMultiplier","number","array","func","xAccessor","children","defaultProps","noop"],"sources":["../../src/lib/EventCapture.js"],"sourcesContent":["\r\n\r\nimport React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { select, event as d3Event, mouse, touches } from \"d3-selection\";\r\n\r\nimport {\r\n\tisDefined, mousePosition, touchPosition, getTouchProps,\r\n\td3Window,\r\n\tMOUSEMOVE, MOUSEUP,\r\n\tMOUSEENTER, MOUSELEAVE,\r\n\tTOUCHMOVE, TOUCHEND,\r\n\tnoop\r\n} from \"./utils\";\r\nimport { getCurrentCharts } from \"./utils/ChartDataUtil\";\r\n// import { clearTimeout, setTimeout } from \"timers\";\r\n\r\nclass EventCapture extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.handleEnter = this.handleEnter.bind(this);\r\n\t\tthis.handleLeave = this.handleLeave.bind(this);\r\n\t\tthis.handleWheel = this.handleWheel.bind(this);\r\n\t\tthis.handleMouseMove = this.handleMouseMove.bind(this);\r\n\t\tthis.handleMouseDown = this.handleMouseDown.bind(this);\r\n\t\tthis.handlePanEnd = this.handlePanEnd.bind(this);\r\n\t\tthis.handlePan = this.handlePan.bind(this);\r\n\t\tthis.handleTouchStart = this.handleTouchStart.bind(this);\r\n\t\tthis.handleTouchMove = this.handleTouchMove.bind(this);\r\n\t\tthis.handlePinchZoom = this.handlePinchZoom.bind(this);\r\n\t\tthis.handlePinchZoomEnd = this.handlePinchZoomEnd.bind(this);\r\n\r\n\t\tthis.handleClick = this.handleClick.bind(this);\r\n\r\n\t\tthis.handleRightClick = this.handleRightClick.bind(this);\r\n\t\tthis.handleDrag = this.handleDrag.bind(this);\r\n\t\tthis.handleDragEnd = this.handleDragEnd.bind(this);\r\n\r\n\t\tthis.shouldPan = this.shouldPan.bind(this);\r\n\t\tthis.canPan = this.canPan.bind(this);\r\n\r\n\t\tthis.setCursorClass = this.setCursorClass.bind(this);\r\n\t\tthis.saveNode = this.saveNode.bind(this);\r\n\r\n\t\tthis.mouseInside = false;\r\n\r\n\t\tthis.mouseInteraction = true;\r\n\t\tthis.state = {\r\n\t\t\tpanInProgress: false,\r\n\t\t};\r\n\t}\r\n\tsaveNode(node) {\r\n\t\tthis.node = node;\r\n\t}\r\n\tUNSAFE_componentWillMount() {\r\n\t\tthis.focus = this.props.focus;\r\n\t}\r\n\tcomponentDidMount() {\r\n\t\tif (this.node) {\r\n\t\t\tselect(this.node)\r\n\t\t\t\t.on(MOUSEENTER, this.handleEnter)\r\n\t\t\t\t.on(MOUSELEAVE, this.handleLeave);\r\n\t\t}\r\n\t}\r\n\tcomponentDidUpdate() {\r\n\t\tthis.componentDidMount();\r\n\t}\r\n\tcomponentWillUnmount() {\r\n\t\tif (this.node) {\r\n\t\t\tselect(this.node)\r\n\t\t\t\t.on(MOUSEENTER, null)\r\n\t\t\t\t.on(MOUSELEAVE, null);\r\n\t\t\tconst win = d3Window(this.node);\r\n\t\t\tselect(win)\r\n\t\t\t\t.on(MOUSEMOVE, null);\r\n\t\t}\r\n\t}\r\n\thandleEnter() {\r\n\t\tconst e = d3Event;\r\n\r\n\t\tconst { onMouseEnter } = this.props;\r\n\t\tthis.mouseInside = true;\r\n\t\tif (!this.state.panInProgress\r\n\t\t\t\t&& !this.state.dragInProgress) {\r\n\t\t\tconst win = d3Window(this.node);\r\n\t\t\tselect(win)\r\n\t\t\t\t.on(MOUSEMOVE, this.handleMouseMove);\r\n\t\t}\r\n\t\tonMouseEnter(e);\r\n\t}\r\n\thandleLeave(e) {\r\n\t\tconst { onMouseLeave } = this.props;\r\n\t\tthis.mouseInside = false;\r\n\t\tif (!this.state.panInProgress\r\n\t\t\t\t&& !this.state.dragInProgress) {\r\n\t\t\tconst win = d3Window(this.node);\r\n\t\t\tselect(win)\r\n\t\t\t\t.on(MOUSEMOVE, null);\r\n\t\t}\r\n\t\tonMouseLeave(e);\r\n\t}\r\n\thandleWheel(e) {\r\n\t\tconst { zoom, onZoom } = this.props;\r\n\t\tconst { panInProgress } = this.state;\r\n\r\n\t\tconst yZoom = Math.abs(e.deltaY) > Math.abs(e.deltaX) && Math.abs(e.deltaY) > 0;\r\n\t\t// const xPan = Math.abs(e.deltaY) < Math.abs(e.deltaX) && Math.abs(e.deltaX) > 0;\r\n\t\tconst mouseXY = mousePosition(e);\r\n\t\te.preventDefault();\r\n\r\n\t\tif (zoom && this.focus && yZoom && !panInProgress) {\r\n\t\t\tconst zoomDir = e.deltaY > 0 ? 1 : -1;\r\n\r\n\t\t\tonZoom(zoomDir, mouseXY, e);\r\n\t\t} else if (this.focus) {\r\n\t\t\tif (this.shouldPan()) {\r\n\t\t\t\t// console.log(\"Do pan now...\")\r\n\t\t\t\t// pan already in progress\r\n\t\t\t\tconst {\r\n\t\t\t\t\tpanStartXScale,\r\n\t\t\t\t\tchartsToPan\r\n\t\t\t\t} = this.state.panStart;\r\n\t\t\t\tthis.lastNewPos = mouseXY;\r\n\t\t\t\tthis.panHappened = true;\r\n\r\n\t\t\t\tthis.dx += e.deltaX;\r\n\t\t\t\tthis.dy += e.deltaY;\r\n\t\t\t\tconst dxdy = { dx: this.dx, dy: this.dy };\r\n\r\n\t\t\t\tthis.props.onPan(mouseXY, panStartXScale, dxdy, chartsToPan, e);\r\n\t\t\t} else {\r\n\t\t\t\t// console.log(\"Pan start...\")\r\n\t\t\t\t// pan start\r\n\r\n\t\t\t\tconst { xScale, chartConfig } = this.props;\r\n\t\t\t\tconst currentCharts = getCurrentCharts(chartConfig, mouseXY);\r\n\r\n\t\t\t\tthis.dx = 0;\r\n\t\t\t\tthis.dy = 0;\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tpanInProgress: true,\r\n\t\t\t\t\tpanStart: {\r\n\t\t\t\t\t\tpanStartXScale: xScale,\r\n\t\t\t\t\t\tpanOrigin: mouseXY,\r\n\t\t\t\t\t\tchartsToPan: currentCharts\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tthis.queuePanEnd();\r\n\t\t}\r\n\t}\r\n\tqueuePanEnd() {\r\n\t\tif (isDefined(this.panEndTimeout)) {\r\n\t\t\tclearTimeout(this.panEndTimeout);\r\n\t\t}\r\n\t\tthis.panEndTimeout = setTimeout(() => {\r\n\t\t\tthis.handlePanEnd();\r\n\t\t}, 100);\r\n\t}\r\n\thandleMouseMove() {\r\n\t\tconst e = d3Event;\r\n\r\n\t\tconst { onMouseMove, mouseMove } = this.props;\r\n\r\n\t\tif (this.mouseInteraction\r\n\t\t\t\t&& mouseMove\r\n\t\t\t\t&& !this.state.panInProgress) {\r\n\r\n\t\t\tconst newPos = mouse(this.node);\r\n\r\n\t\t\tonMouseMove(newPos, \"mouse\", e);\r\n\t\t}\r\n\t}\r\n\thandleClick(e) {\r\n\t\tconst mouseXY = mousePosition(e);\r\n\t\tconst { onClick, onDoubleClick } = this.props;\r\n\r\n\t\tif (!this.panHappened && !this.dragHappened) {\r\n\t\t\tif (this.clicked) {\r\n\t\t\t\tonDoubleClick(mouseXY, e);\r\n\t\t\t\tthis.clicked = false;\r\n\t\t\t} else {\r\n\t\t\t\tonClick(mouseXY, e);\r\n\t\t\t\tthis.clicked = true;\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tif (this.clicked) {\r\n\t\t\t\t\t\tthis.clicked = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 400);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\thandleRightClick(e) {\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\t\tconst { onContextMenu, onPanEnd } = this.props;\r\n\r\n\t\tconst mouseXY = mousePosition(e, this.node.getBoundingClientRect());\r\n\r\n\t\tif (isDefined(this.state.panStart)) {\r\n\t\t\tconst { panStartXScale, panOrigin, chartsToPan } = this.state.panStart;\r\n\t\t\tif (this.panHappened) {\r\n\t\t\t\tonPanEnd(mouseXY, panStartXScale, panOrigin, chartsToPan, e);\r\n\t\t\t}\r\n\t\t\tconst win = d3Window(this.node);\r\n\t\t\tselect(win)\r\n\t\t\t\t.on(MOUSEMOVE, null)\r\n\t\t\t\t.on(MOUSEUP, null);\r\n\r\n\t\t\tthis.setState({\r\n\t\t\t\tpanInProgress: false,\r\n\t\t\t\tpanStart: null,\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tonContextMenu(mouseXY, e);\r\n\t}\r\n\r\n\thandleDrag() {\r\n\t\tconst e = d3Event;\r\n\t\tif (this.props.onDrag) {\r\n\t\t\tthis.dragHappened = true;\r\n\t\t\tconst mouseXY = mouse(this.node);\r\n\t\t\tthis.props.onDrag({\r\n\t\t\t\tstartPos: this.state.dragStartPosition,\r\n\t\t\t\tmouseXY\r\n\t\t\t}, e);\r\n\t\t}\r\n\t}\r\n\tcancelDrag() {\r\n\t\tconst win = d3Window(this.node);\r\n\t\tselect(win)\r\n\t\t\t.on(MOUSEMOVE, this.mouseInside ? this.handleMouseMove : null)\r\n\t\t\t.on(MOUSEUP, null);\r\n\r\n\t\tthis.setState({\r\n\t\t\tdragInProgress: false,\r\n\t\t});\r\n\t\tthis.mouseInteraction = true;\r\n\t}\r\n\thandleDragEnd() {\r\n\t\tconst e = d3Event;\r\n\t\tconst mouseXY = mouse(this.node);\r\n\r\n\t\tconst win = d3Window(this.node);\r\n\t\tselect(win)\r\n\t\t\t.on(MOUSEMOVE, this.mouseInside ? this.handleMouseMove : null)\r\n\t\t\t.on(MOUSEUP, null);\r\n\r\n\t\tif (this.dragHappened) {\r\n\t\t\tthis.props.onDragComplete({\r\n\t\t\t\tmouseXY\r\n\t\t\t}, e);\r\n\t\t}\r\n\r\n\t\tthis.setState({\r\n\t\t\tdragInProgress: false,\r\n\t\t});\r\n\t\tthis.mouseInteraction = true;\r\n\t}\r\n\tcanPan() {\r\n\t\tconst { getAllPanConditions } = this.props;\r\n\t\tconst { pan: initialPanEnabled } = this.props;\r\n\r\n\t\tconst {\r\n\t\t\tpanEnabled,\r\n\t\t\tdraggable: somethingSelected\r\n\t\t} = getAllPanConditions()\r\n\t\t\t.reduce((returnObj, a) => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tdraggable: returnObj.draggable || a.draggable,\r\n\t\t\t\t\tpanEnabled: returnObj.panEnabled && a.panEnabled,\r\n\t\t\t\t};\r\n\t\t\t}, {\r\n\t\t\t\tdraggable: false,\r\n\t\t\t\tpanEnabled: initialPanEnabled,\r\n\t\t\t});\r\n\r\n\t\treturn {\r\n\t\t\tpanEnabled,\r\n\t\t\tsomethingSelected\r\n\t\t};\r\n\t}\r\n\thandleMouseDown(e) {\r\n\t\tif (e.button !== 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst { xScale, chartConfig, onMouseDown } = this.props;\r\n\r\n\t\tthis.panHappened = false;\r\n\t\tthis.dragHappened = false;\r\n\t\tthis.focus = true;\r\n\r\n\t\tif (!this.state.panInProgress\r\n\t\t\t&& this.mouseInteraction\r\n\t\t) {\r\n\r\n\t\t\tconst mouseXY = mousePosition(e);\r\n\t\t\tconst currentCharts = getCurrentCharts(chartConfig, mouseXY);\r\n\t\t\tconst {\r\n\t\t\t\tpanEnabled, somethingSelected\r\n\t\t\t} = this.canPan();\r\n\t\t\tconst pan = panEnabled && !somethingSelected;\r\n\r\n\t\t\tif (pan) {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tpanInProgress: pan,\r\n\t\t\t\t\tpanStart: {\r\n\t\t\t\t\t\tpanStartXScale: xScale,\r\n\t\t\t\t\t\tpanOrigin: mouseXY,\r\n\t\t\t\t\t\tchartsToPan: currentCharts\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\r\n\t\t\t\tconst win = d3Window(this.node);\r\n\t\t\t\tselect(win)\r\n\t\t\t\t\t.on(MOUSEMOVE, this.handlePan)\r\n\t\t\t\t\t.on(MOUSEUP, this.handlePanEnd);\r\n\r\n\t\t\t} else if (somethingSelected) {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tpanInProgress: false,\r\n\t\t\t\t\tdragInProgress: true,\r\n\t\t\t\t\tpanStart: null,\r\n\t\t\t\t\tdragStartPosition: mouseXY,\r\n\t\t\t\t});\r\n\t\t\t\tthis.props.onDragStart({ startPos: mouseXY }, e);\r\n\t\t\t\t// this.mouseInteraction = false;\r\n\r\n\t\t\t\tconst win = d3Window(this.node);\r\n\t\t\t\tselect(win)\r\n\t\t\t\t\t.on(MOUSEMOVE, this.handleDrag)\r\n\t\t\t\t\t.on(MOUSEUP, this.handleDragEnd);\r\n\t\t\t}\r\n\r\n\t\t\tonMouseDown(mouseXY, currentCharts, e);\r\n\t\t}\r\n\t\te.preventDefault();\r\n\t}\r\n\tshouldPan() {\r\n\t\tconst { pan: panEnabled, onPan } = this.props;\r\n\t\treturn panEnabled\r\n\t\t\t&& onPan\r\n\t\t\t&& isDefined(this.state.panStart);\r\n\t}\r\n\thandlePan() {\r\n\t\tconst e = d3Event;\r\n\r\n\t\tif (this.shouldPan()) {\r\n\t\t\tthis.panHappened = true;\r\n\r\n\t\t\tconst { panStartXScale, panOrigin, chartsToPan } = this.state.panStart;\r\n\r\n\t\t\tconst mouseXY = this.mouseInteraction\r\n\t\t\t\t? mouse(this.node)\r\n\t\t\t\t: touches(this.node)[0];\r\n\r\n\t\t\tthis.lastNewPos = mouseXY;\r\n\t\t\tconst dx = mouseXY[0] - panOrigin[0];\r\n\t\t\tconst dy = mouseXY[1] - panOrigin[1];\r\n\r\n\t\t\tthis.dx = dx;\r\n\t\t\tthis.dy = dy;\r\n\r\n\t\t\tthis.props.onPan(\r\n\t\t\t\tmouseXY, panStartXScale, { dx, dy }, chartsToPan, e\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\thandlePanEnd() {\r\n\t\tconst e = d3Event;\r\n\t\tconst { pan: panEnabled, onPanEnd } = this.props;\r\n\r\n\t\tif (isDefined(this.state.panStart)) {\r\n\t\t\tconst { panStartXScale, chartsToPan } = this.state.panStart;\r\n\r\n\t\t\tconst win = d3Window(this.node);\r\n\t\t\tselect(win)\r\n\t\t\t\t.on(MOUSEMOVE, this.mouseInside ? this.handleMouseMove : null)\r\n\t\t\t\t.on(MOUSEUP, null)\r\n\t\t\t\t.on(TOUCHMOVE, null)\r\n\t\t\t\t.on(TOUCHEND, null);\r\n\r\n\t\t\tif (this.panHappened\r\n\t\t\t\t\t// && !this.contextMenuClicked\r\n\t\t\t\t\t&& panEnabled\r\n\t\t\t\t\t&& onPanEnd) {\r\n\t\t\t\tconst { dx, dy } = this;\r\n\r\n\t\t\t\t// console.log(dx, dy)\r\n\t\t\t\tdelete this.dx;\r\n\t\t\t\tdelete this.dy;\r\n\t\t\t\tonPanEnd(this.lastNewPos, panStartXScale, { dx, dy }, chartsToPan, e);\r\n\t\t\t}\r\n\r\n\t\t\tthis.setState({\r\n\t\t\t\tpanInProgress: false,\r\n\t\t\t\tpanStart: null,\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\thandleTouchMove(e) {\r\n\t\tconst { onMouseMove } = this.props;\r\n\t\tconst touchXY = touchPosition(getTouchProps(e.touches[0]), e);\r\n\t\tonMouseMove(touchXY, \"touch\", e);\r\n\t}\r\n\thandleTouchStart(e) {\r\n\t\tthis.mouseInteraction = false;\r\n\r\n\t\tconst { pan: panEnabled, chartConfig, onMouseMove } = this.props;\r\n\t\tconst { xScale, onPanEnd } = this.props;\r\n\r\n\t\tif (e.touches.length === 1) {\r\n\r\n\t\t\tthis.panHappened = false;\r\n\t\t\tconst touchXY = touchPosition(getTouchProps(e.touches[0]), e);\r\n\t\t\tonMouseMove(touchXY, \"touch\", e);\r\n\r\n\t\t\tif (panEnabled) {\r\n\t\t\t\tconst currentCharts = getCurrentCharts(chartConfig, touchXY);\r\n\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tpanInProgress: true,\r\n\t\t\t\t\tpanStart: {\r\n\t\t\t\t\t\tpanStartXScale: xScale,\r\n\t\t\t\t\t\tpanOrigin: touchXY,\r\n\t\t\t\t\t\tchartsToPan: currentCharts,\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tconst win = d3Window(this.node);\r\n\t\t\t\tselect(win)\r\n\t\t\t\t\t.on(TOUCHMOVE, this.handlePan, false)\r\n\t\t\t\t\t.on(TOUCHEND, this.handlePanEnd, false);\r\n\r\n\t\t\t}\r\n\t\t} else if (e.touches.length === 2) {\r\n\t\t\t// pinch zoom begin\r\n\t\t\t// do nothing pinch zoom is handled in handleTouchMove\r\n\t\t\tconst { panInProgress, panStart } = this.state;\r\n\r\n\t\t\tif (panInProgress && panEnabled && onPanEnd) {\r\n\t\t\t\tconst { panStartXScale, panOrigin, chartsToPan } = panStart;\r\n\r\n\t\t\t\tconst win = d3Window(this.node);\r\n\t\t\t\tselect(win)\r\n\t\t\t\t\t.on(MOUSEMOVE, this.mouseInside ? this.handleMouseMove : null)\r\n\t\t\t\t\t.on(MOUSEUP, null)\r\n\t\t\t\t\t.on(TOUCHMOVE, this.handlePinchZoom, false)\r\n\t\t\t\t\t.on(TOUCHEND, this.handlePinchZoomEnd, false);\r\n\r\n\t\t\t\tconst touch1Pos = touchPosition(getTouchProps(e.touches[0]), e);\r\n\t\t\t\tconst touch2Pos = touchPosition(getTouchProps(e.touches[1]), e);\r\n\r\n\t\t\t\tif (this.panHappened\r\n\t\t\t\t\t\t// && !this.contextMenuClicked\r\n\t\t\t\t\t\t&& panEnabled\r\n\t\t\t\t\t\t&& onPanEnd) {\r\n\r\n\t\t\t\t\tonPanEnd(this.lastNewPos, panStartXScale, panOrigin, chartsToPan, e);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tpanInProgress: false,\r\n\t\t\t\t\tpinchZoomStart: {\r\n\t\t\t\t\t\txScale,\r\n\t\t\t\t\t\ttouch1Pos,\r\n\t\t\t\t\t\ttouch2Pos,\r\n\t\t\t\t\t\trange: xScale.range(),\r\n\t\t\t\t\t\tchartsToPan,\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\thandlePinchZoom() {\r\n\t\tconst e = d3Event;\r\n\t\tconst [touch1Pos, touch2Pos] = touches(this.node);\r\n\t\tconst { xScale, zoom: zoomEnabled, onPinchZoom } = this.props;\r\n\r\n\t\t// eslint-disable-next-line no-unused-vars\r\n\t\tconst { chartsToPan, ...initialPinch } = this.state.pinchZoomStart;\r\n\r\n\t\tif (zoomEnabled && onPinchZoom) {\r\n\t\t\tonPinchZoom(initialPinch, {\r\n\t\t\t\ttouch1Pos,\r\n\t\t\t\ttouch2Pos,\r\n\t\t\t\txScale,\r\n\t\t\t}, e);\r\n\t\t}\r\n\t}\r\n\thandlePinchZoomEnd() {\r\n\t\tconst e = d3Event;\r\n\r\n\t\tconst win = d3Window(this.node);\r\n\t\tselect(win)\r\n\t\t\t.on(TOUCHMOVE, null)\r\n\t\t\t.on(TOUCHEND, null);\r\n\r\n\t\tconst { zoom: zoomEnabled, onPinchZoomEnd } = this.props;\r\n\r\n\t\t// eslint-disable-next-line no-unused-vars\r\n\t\tconst { chartsToPan, ...initialPinch } = this.state.pinchZoomStart;\r\n\r\n\t\tif (zoomEnabled && onPinchZoomEnd) {\r\n\t\t\tonPinchZoomEnd(initialPinch, e);\r\n\t\t}\r\n\r\n\t\tthis.setState({\r\n\t\t\tpinchZoomStart: null\r\n\t\t});\r\n\t}\r\n\tsetCursorClass(cursorOverrideClass) {\r\n\t\tif (cursorOverrideClass !== this.state.cursorOverrideClass) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tcursorOverrideClass\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\trender() {\r\n\t\tconst { height, width, disableInteraction, useCrossHairStyleCursor } = this.props;\r\n\t\tconst className = this.state.cursorOverrideClass != null\r\n\t\t\t? this.state.cursorOverrideClass\r\n\t\t\t: !useCrossHairStyleCursor ? \"\" : this.state.panInProgress\r\n\t\t\t\t? \"react-stockcharts-grabbing-cursor\"\r\n\t\t\t\t: \"react-stockcharts-crosshair-cursor\";\r\n\r\n\t\tconst interactionProps = disableInteraction || {\r\n\t\t\tonWheel: this.handleWheel,\r\n\t\t\tonMouseDown: this.handleMouseDown,\r\n\t\t\tonClick: this.handleClick,\r\n\t\t\tonContextMenu: this.handleRightClick,\r\n\t\t\tonTouchStart: this.handleTouchStart,\r\n\t\t\tonTouchMove: this.handleTouchMove,\r\n\t\t};\r\n\r\n\t\treturn (\r\n\t\t\t<rect ref={this.saveNode}\r\n\t\t\t\tclassName={className}\r\n\t\t\t\twidth={width}\r\n\t\t\t\theight={height}\r\n\t\t\t\tstyle={{ opacity: 0 }}\r\n\t\t\t\t{...interactionProps}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n\r\n// \t\t\t\tonMouseEnter={this.handleEnter}\r\n//\t\t\t\tonMouseLeave={this.handleLeave}\r\n\r\n\r\nEventCapture.propTypes = {\r\n\tmouseMove: PropTypes.bool.isRequired,\r\n\tzoom: PropTypes.bool.isRequired,\r\n\tpan: PropTypes.bool.isRequired,\r\n\tpanSpeedMultiplier: PropTypes.number.isRequired,\r\n\tfocus: PropTypes.bool.isRequired,\r\n\tuseCrossHairStyleCursor: PropTypes.bool.isRequired,\r\n\r\n\twidth: PropTypes.number.isRequired,\r\n\theight: PropTypes.number.isRequired,\r\n\tchartConfig: PropTypes.array,\r\n\txScale: PropTypes.func.isRequired,\r\n\txAccessor: PropTypes.func.isRequired,\r\n\tdisableInteraction: PropTypes.bool.isRequired,\r\n\r\n\tgetAllPanConditions: PropTypes.func.isRequired,\r\n\r\n\tonMouseMove: PropTypes.func,\r\n\tonMouseEnter: PropTypes.func,\r\n\tonMouseLeave: PropTypes.func,\r\n\tonZoom: PropTypes.func,\r\n\tonPinchZoom: PropTypes.func,\r\n\tonPinchZoomEnd: PropTypes.func.isRequired,\r\n\tonPan: PropTypes.func,\r\n\tonPanEnd: PropTypes.func,\r\n\tonDragStart: PropTypes.func,\r\n\tonDrag: PropTypes.func,\r\n\tonDragComplete: PropTypes.func,\r\n\r\n\tonClick: PropTypes.func,\r\n\tonDoubleClick: PropTypes.func,\r\n\tonContextMenu: PropTypes.func,\r\n\tonMouseDown: PropTypes.func,\r\n\tchildren: PropTypes.node,\r\n};\r\n\r\nEventCapture.defaultProps = {\r\n\tmouseMove: false,\r\n\tzoom: false,\r\n\tpan: false,\r\n\tpanSpeedMultiplier: 1,\r\n\tfocus: false,\r\n\tonDragComplete: noop,\r\n\tdisableInteraction: false,\r\n};\r\n\r\nexport default EventCapture;\r\n"],"mappings":"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"}