{"version":3,"file":"OHLCTooltip.js","names":["OHLCTooltip","props","renderSVG","bind","moreProps","displayValuesFor","xDisplayFormat","accessor","volumeFormat","ohlcFormat","percentFormat","displayTexts","chartConfig","width","height","displayXAccessor","currentItem","displayDate","open","high","low","close","volume","percent","na","isDefined","item","originProp","origin","functor","x","y","itemsToDisplay","children","Component","propTypes","className","PropTypes","string","func","oneOfType","array","fontFamily","fontSize","number","onClick","textFill","labelFill","object","displayTextsDefault","d","o","h","l","c","v","defaultProps","date","timeFormat","format","defaultDisplay"],"sources":["../../../src/lib/tooltip/OHLCTooltip.js"],"sourcesContent":["\r\n\r\nimport React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { format } from \"d3-format\";\r\nimport { timeFormat } from \"d3-time-format\";\r\nimport displayValuesFor from \"./displayValuesFor\";\r\nimport GenericChartComponent from \"../GenericChartComponent\";\r\n\r\nimport { isDefined, functor } from \"../utils\";\r\nimport ToolTipText from \"./ToolTipText\";\r\nimport ToolTipTSpanLabel from \"./ToolTipTSpanLabel\";\r\n\r\nclass OHLCTooltip extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.renderSVG = this.renderSVG.bind(this);\r\n\t}\r\n\trenderSVG(moreProps) {\r\n\t\tconst { displayValuesFor } = this.props;\r\n\t\tconst {\r\n\t\t\txDisplayFormat,\r\n\t\t\taccessor,\r\n\t\t\tvolumeFormat,\r\n\t\t\tohlcFormat,\r\n\t\t\tpercentFormat,\r\n\t\t\tdisplayTexts\r\n\t\t} = this.props;\r\n\r\n\t\tconst { chartConfig: { width, height } } = moreProps;\r\n\t\tconst { displayXAccessor } = moreProps;\r\n\r\n\t\tconst currentItem = displayValuesFor(this.props, moreProps);\r\n\r\n\t\tlet displayDate, open, high, low, close, volume, percent;\r\n\t\tdisplayDate = open = high = low = close = volume = percent = displayTexts.na;\r\n\r\n\t\tif (isDefined(currentItem) && isDefined(accessor(currentItem))) {\r\n\t\t\tconst item = accessor(currentItem);\r\n\t\t\tvolume = isDefined(item.volume) ? volumeFormat(item.volume) : displayTexts.na;\r\n\r\n\t\t\tdisplayDate = xDisplayFormat(displayXAccessor(item));\r\n\t\t\topen = ohlcFormat(item.open);\r\n\t\t\thigh = ohlcFormat(item.high);\r\n\t\t\tlow = ohlcFormat(item.low);\r\n\t\t\tclose = ohlcFormat(item.close);\r\n\t\t\tpercent = percentFormat((item.close - item.open) / item.open);\r\n\t\t}\r\n\r\n\t\tconst { origin: originProp } = this.props;\r\n\t\tconst origin = functor(originProp);\r\n\t\tconst [x, y] = origin(width, height);\r\n\r\n\t\tconst itemsToDisplay = {\r\n\t\t\tdisplayDate,\r\n\t\t\topen,\r\n\t\t\thigh,\r\n\t\t\tlow,\r\n\t\t\tclose,\r\n\t\t\tpercent,\r\n\t\t\tvolume,\r\n\t\t\tx,\r\n\t\t\ty\r\n\t\t};\r\n\t\treturn this.props.children(this.props, moreProps, itemsToDisplay);\r\n\t}\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<GenericChartComponent\r\n\t\t\t\tclip={false}\r\n\t\t\t\tsvgDraw={this.renderSVG}\r\n\t\t\t\tdrawOn={[\"mousemove\"]}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nOHLCTooltip.propTypes = {\r\n\tclassName: PropTypes.string,\r\n\taccessor: PropTypes.func,\r\n\txDisplayFormat: PropTypes.func,\r\n\tchildren: PropTypes.func,\r\n\tvolumeFormat: PropTypes.func,\r\n\tpercentFormat: PropTypes.func,\r\n\tohlcFormat: PropTypes.func,\r\n\torigin: PropTypes.oneOfType([PropTypes.array, PropTypes.func]),\r\n\tfontFamily: PropTypes.string,\r\n\tfontSize: PropTypes.number,\r\n\tonClick: PropTypes.func,\r\n\tdisplayValuesFor: PropTypes.func,\r\n\ttextFill: PropTypes.string,\r\n\tlabelFill: PropTypes.string,\r\n\tdisplayTexts: PropTypes.object,\r\n};\r\n\r\nconst displayTextsDefault = {\r\n\td: \"Date: \",\r\n\to: \" O: \",\r\n\th: \" H: \",\r\n\tl: \" L: \",\r\n\tc: \" C: \",\r\n\tv: \" Vol: \",\r\n\tna: \"n/a\"\r\n};\r\n\r\nOHLCTooltip.defaultProps = {\r\n\taccessor: d => {\r\n\t\treturn {\r\n\t\t\tdate: d.date,\r\n\t\t\topen: d.open,\r\n\t\t\thigh: d.high,\r\n\t\t\tlow: d.low,\r\n\t\t\tclose: d.close,\r\n\t\t\tvolume: d.volume\r\n\t\t};\r\n\t},\r\n\txDisplayFormat: timeFormat(\"%Y-%m-%d\"),\r\n\tvolumeFormat: format(\".4s\"),\r\n\tpercentFormat: format(\".2%\"),\r\n\tohlcFormat: format(\".2f\"),\r\n\tdisplayValuesFor: displayValuesFor,\r\n\torigin: [0, 0],\r\n\tchildren: defaultDisplay,\r\n\tdisplayTexts: displayTextsDefault,\r\n};\r\n\r\nfunction defaultDisplay(props, moreProps, itemsToDisplay) {\r\n\r\n\t/* eslint-disable */\r\n\tconst {\r\n\t\tclassName,\r\n\t\ttextFill,\r\n\t\tlabelFill,\r\n\t\tonClick,\r\n\t\tfontFamily,\r\n\t\tfontSize,\r\n\t\tdisplayTexts\r\n\t} = props;\r\n\t/* eslint-enable */\r\n\r\n\tconst {\r\n\t\tdisplayDate,\r\n\t\topen,\r\n\t\thigh,\r\n\t\tlow,\r\n\t\tclose,\r\n\t\tvolume,\r\n\t\tx,\r\n\t\ty\r\n\t} = itemsToDisplay;\r\n\treturn (\r\n\t\t<g\r\n\t\t\tclassName={`react-stockcharts-tooltip-hover ${className}`}\r\n\t\t\ttransform={`translate(${x}, ${y})`}\r\n\t\t\tonClick={onClick}\r\n\t\t>\r\n\t\t\t<ToolTipText\r\n\t\t\t\tx={0}\r\n\t\t\t\ty={0}\r\n\t\t\t\tfontFamily={fontFamily}\r\n\t\t\t\tfontSize={fontSize}\r\n\t\t\t>\r\n\t\t\t\t<ToolTipTSpanLabel\r\n\t\t\t\t\tfill={labelFill}\r\n\t\t\t\t\tkey=\"label\"\r\n\t\t\t\t\tx={0}\r\n\t\t\t\t\tdy=\"5\">{displayTexts.d}</ToolTipTSpanLabel>\r\n\t\t\t\t<ToolTipTSpanLabel fill={labelFill} key=\"label_O\">{displayTexts.o}</ToolTipTSpanLabel>\r\n\t\t\t\t<ToolTipTSpanLabel fill={labelFill} key=\"label_H\">{displayTexts.h}</ToolTipTSpanLabel>\r\n\t\t\t\t<ToolTipTSpanLabel fill={labelFill} key=\"label_L\">{displayTexts.l}</ToolTipTSpanLabel>\r\n\t\t\t\t<ToolTipTSpanLabel fill={labelFill} key=\"label_C\">{displayTexts.c}</ToolTipTSpanLabel>\r\n\t\t\t\t<ToolTipTSpanLabel fill={labelFill} key=\"label_Vol\">{displayTexts.v}</ToolTipTSpanLabel>\r\n\t\t\t\t<tspan key=\"value\" fillRule={textFill}>{displayDate}</tspan>\r\n\t\t\t\t<tspan key=\"value_O\" fillRule={textFill}>{open}</tspan>\r\n\t\t\t\t<tspan key=\"value_H\" fillRule={textFill}>{high}</tspan>\r\n\t\t\t\t<tspan key=\"value_L\" fillRule={textFill}>{low}</tspan>\r\n\t\t\t\t<tspan key=\"value_C\" fillRule={textFill}>{close}</tspan>\r\n\t\t\t\t<tspan key=\"value_Vol\" fillRule={textFill}>{volume}</tspan>\r\n\t\t\t</ToolTipText>\r\n\t\t</g>\r\n\t);\r\n}\r\n\r\nexport default OHLCTooltip;\r\n"],"mappings":"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"}