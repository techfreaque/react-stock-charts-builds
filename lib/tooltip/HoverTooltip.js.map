{"version":3,"file":"HoverTooltip.js","names":["HoverTooltip","props","renderSVG","bind","drawOnCanvas","ctx","moreProps","pointer","helper","height","isNotDefined","context","bgFill","bgOpacity","backgroundShapeSVG","tooltipSVG","bgheight","bgwidth","x","y","content","centerX","pointWidth","bgSize","bgShape","isDefined","width","Component","propTypes","chartId","PropTypes","oneOfType","number","string","yAccessor","func","isRequired","tooltipContent","origin","array","fontFamily","fontSize","contextTypes","margin","object","ratio","defaultProps","tooltipCanvas","fill","stroke","fontFill","opacity","backgroundShapeCanvas","PADDING","X","Y","tspans","startY","i","length","textY","push","label","value","fillStyle","hexToRGBA","strokeStyle","beginPath","rect","font","textAlign","fillText","measureText","originX","left","originY","top","save","setTransform","scale","translate","restore","calculateTooltipSize","canvas","document","createElement","getContext","str","map","reduce","res","size","sumSizes","String","sizes","Math","max","sum","d","normalizeX","normalizeY","mouseXY","xAccessor","currentItem","xScale","chartConfig","last","xValue","round","findIndex","yValue","chartIndex","id","yScale","show","plotData","displayXAccessor","abs","first"],"sources":["../../../src/lib/tooltip/HoverTooltip.js"],"sourcesContent":["\r\n\r\nimport React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport GenericComponent from \"../GenericComponent\";\r\nimport { sum } from \"d3-array\";\r\n\r\nimport { first, last, isNotDefined, isDefined, hexToRGBA } from \"../utils\";\r\n\r\nclass HoverTooltip extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.renderSVG = this.renderSVG.bind(this);\r\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\r\n\t}\r\n\tdrawOnCanvas(ctx, moreProps) {\r\n\t\tconst pointer = helper(this.props, moreProps, ctx);\r\n\t\tconst { height } = moreProps;\r\n\r\n\t\tif (isNotDefined(pointer)) return null;\r\n\t\tdrawOnCanvas(ctx, this.props, this.context, pointer, height, moreProps);\r\n\t}\r\n\trender() {\r\n\t\treturn <GenericComponent\r\n\t\t\tsvgDraw={this.renderSVG}\r\n\t\t\tcanvasDraw={this.drawOnCanvas}\r\n\t\t\tdrawOn={[\"mousemove\", \"pan\"/* , \"mouseleave\" */]}\r\n\t\t/>;\r\n\t}\r\n\trenderSVG(moreProps) {\r\n\t\tconst pointer = helper(this.props, moreProps);\r\n\r\n\t\tif (isNotDefined(pointer)) return null;\r\n\r\n\t\tconst { bgFill, bgOpacity, backgroundShapeSVG, tooltipSVG } = this.props;\r\n\t\tconst { bgheight, bgwidth } = this.props;\r\n\t\tconst { height } = moreProps;\r\n\r\n\t\tconst { x, y, content, centerX, pointWidth, bgSize } = pointer;\r\n\r\n\t\tconst bgShape = isDefined(bgwidth) && isDefined(bgheight)\r\n\t\t\t? { width: bgwidth, height: bgheight }\r\n\t\t\t: bgSize;\r\n\r\n\t\treturn (\r\n\t\t\t<g>\r\n\t\t\t\t<rect x={centerX - pointWidth / 2}\r\n\t\t\t\t\ty={0}\r\n\t\t\t\t\twidth={pointWidth}\r\n\t\t\t\t\theight={height}\r\n\t\t\t\t\tfill={bgFill}\r\n\t\t\t\t\topacity={bgOpacity} />\r\n\t\t\t\t<g className=\"react-stockcharts-tooltip-content\" transform={`translate(${x}, ${y})`}>\r\n\t\t\t\t\t{backgroundShapeSVG(this.props, bgShape)}\r\n\t\t\t\t\t{tooltipSVG(this.props, content)}\r\n\t\t\t\t</g>\r\n\t\t\t</g>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nHoverTooltip.propTypes = {\r\n\tchartId: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\r\n\tyAccessor: PropTypes.func,\r\n\ttooltipSVG: PropTypes.func,\r\n\tbackgroundShapeSVG: PropTypes.func,\r\n\tbgwidth: PropTypes.number,\r\n\tbgheight: PropTypes.number,\r\n\tbgFill: PropTypes.string.isRequired,\r\n\tbgOpacity: PropTypes.number.isRequired,\r\n\ttooltipContent: PropTypes.func.isRequired,\r\n\torigin: PropTypes.oneOfType([\r\n\t\tPropTypes.array,\r\n\t\tPropTypes.func\r\n\t]).isRequired,\r\n\tfontFamily: PropTypes.string,\r\n\tfontSize: PropTypes.number,\r\n};\r\n\r\nHoverTooltip.contextTypes = {\r\n\tmargin: PropTypes.object.isRequired,\r\n\tratio: PropTypes.number.isRequired,\r\n};\r\n\r\nHoverTooltip.defaultProps = {\r\n\t// bgwidth: 150,\r\n\t// bgheight: 50,\r\n\ttooltipSVG: tooltipSVG,\r\n\ttooltipCanvas: tooltipCanvas,\r\n\torigin: origin,\r\n\tfill: \"#D4E2FD\",\r\n\tbgFill: \"#D4E2FD\",\r\n\tbgOpacity: 0.5,\r\n\tstroke: \"#9B9BFF\",\r\n\tfontFill: \"#000000\",\r\n\topacity: 0.8,\r\n\tbackgroundShapeSVG: backgroundShapeSVG,\r\n\tbackgroundShapeCanvas: backgroundShapeCanvas,\r\n\tfontFamily: \"Helvetica Neue, Helvetica, Arial, sans-serif\",\r\n\tfontSize: 12,\r\n};\r\n\r\nconst PADDING = 5;\r\nconst X = 10;\r\nconst Y = 10;\r\n\r\n\r\n/* eslint-disable react/prop-types */\r\nfunction backgroundShapeSVG({ fill, stroke, opacity }, { height, width }) {\r\n\treturn <rect\r\n\t\theight={height}\r\n\t\twidth={width}\r\n\t\tfill={fill}\r\n\t\topacity={opacity}\r\n\t\tstroke={stroke} />;\r\n}\r\n\r\nfunction tooltipSVG({ fontFamily, fontSize, fontFill }, content) {\r\n\tconst tspans = [];\r\n\tconst startY = Y + fontSize * 0.9;\r\n\r\n\tfor (let i = 0; i < content.y.length; i++) {\r\n\t\tconst y = content.y[i];\r\n\t\tconst textY = startY + (fontSize * (i + 1));\r\n\r\n\t\ttspans.push(<tspan key={`L-${i}`} x={X} y={textY} fill={y.stroke}>{y.label}</tspan>);\r\n\t\ttspans.push(<tspan key={i}>: </tspan>);\r\n\t\ttspans.push(<tspan key={`V-${i}`}>{y.value}</tspan>);\r\n\t}\r\n\treturn <text fontFamily={fontFamily} fontSize={fontSize} fill={fontFill}>\r\n\t\t<tspan x={X} y={startY}>{content.x}</tspan>\r\n\t\t{tspans}\r\n\t</text>;\r\n}\r\n/* eslint-enable react/prop-types */\r\n\r\nfunction backgroundShapeCanvas(props, { width, height }, ctx) {\r\n\tconst { fill, stroke, opacity } = props;\r\n\r\n\tctx.fillStyle = hexToRGBA(fill, opacity);\r\n\tctx.strokeStyle = stroke;\r\n\tctx.beginPath();\r\n\tctx.rect(0, 0, width, height);\r\n\tctx.fill();\r\n\tctx.stroke();\r\n}\r\n\r\nfunction tooltipCanvas({ fontFamily, fontSize, fontFill }, content, ctx) {\r\n\tconst startY = Y + fontSize * 0.9;\r\n\tctx.font = `${fontSize}px ${fontFamily}`;\r\n\tctx.fillStyle = fontFill;\r\n\tctx.textAlign = \"left\";\r\n\tctx.fillText(content.x, X, startY);\r\n\r\n\tfor (let i = 0; i < content.y.length; i++) {\r\n\t\tconst y = content.y[i];\r\n\t\tconst textY = startY + (fontSize * (i + 1));\r\n\t\tctx.fillStyle = y.stroke || fontFill;\r\n\t\tctx.fillText(y.label, X, textY);\r\n\r\n\t\tctx.fillStyle = fontFill;\r\n\t\tctx.fillText(\": \" + y.value, X + ctx.measureText(y.label).width, textY);\r\n\t}\r\n}\r\n\r\nfunction drawOnCanvas(ctx, props, context, pointer, height) {\r\n\r\n\tconst { margin, ratio } = context;\r\n\tconst { bgFill, bgOpacity } = props;\r\n\tconst { backgroundShapeCanvas, tooltipCanvas } = props;\r\n\r\n\tconst originX = 0.5 * ratio + margin.left;\r\n\tconst originY = 0.5 * ratio + margin.top;\r\n\r\n\tctx.save();\r\n\r\n\tctx.setTransform(1, 0, 0, 1, 0, 0);\r\n\tctx.scale(ratio, ratio);\r\n\r\n\tctx.translate(originX, originY);\r\n\r\n\tconst { x, y, content, centerX, pointWidth, bgSize } = pointer;\r\n\r\n\tctx.fillStyle = hexToRGBA(bgFill, bgOpacity);\r\n\tctx.beginPath();\r\n\tctx.rect(centerX - pointWidth / 2, 0, pointWidth, height);\r\n\tctx.fill();\r\n\r\n\tctx.translate(x, y);\r\n\tbackgroundShapeCanvas(props, bgSize, ctx);\r\n\ttooltipCanvas(props, content, ctx);\r\n\r\n\tctx.restore();\r\n}\r\n\r\nfunction calculateTooltipSize({ fontFamily, fontSize, fontFill }, content, ctx) {\r\n\tif (isNotDefined(ctx)) {\r\n\t\tconst canvas = document.createElement(\"canvas\");\r\n\t\tctx = canvas.getContext(\"2d\");\r\n\t}\r\n\r\n\tctx.font = `${fontSize}px ${fontFamily}`;\r\n\tctx.fillStyle = fontFill;\r\n\tctx.textAlign = \"left\";\r\n\r\n\tconst measureText = str => ({\r\n\t\twidth: ctx.measureText(str).width,\r\n\t\theight: fontSize,\r\n\t});\r\n\r\n\tconst { width, height } = content.y\r\n\t\t.map(({ label, value }) => measureText(`${label}: ${value}`))\r\n\t\t// Sum all y and x sizes (begin with x label size)\r\n\t\t.reduce((res, size) => sumSizes(res, size), measureText(String(content.x)))\r\n\t;\r\n\r\n\treturn {\r\n\t\twidth: width + 2 * X,\r\n\t\theight: height + 2 * Y\r\n\t};\r\n}\r\n\r\nfunction sumSizes(...sizes) {\r\n\treturn {\r\n\t\twidth: Math.max(...sizes.map(size => size.width)),\r\n\t\theight: sum(sizes, d => d.height),\r\n\t};\r\n}\r\n\r\nfunction normalizeX(x, bgSize, pointWidth, width) {\r\n\t// return x - bgSize.width - pointWidth / 2 - PADDING * 2 < 0\r\n\treturn x < width / 2\r\n\t\t? x + pointWidth / 2 + PADDING\r\n\t\t: x - bgSize.width - pointWidth / 2 - PADDING;\r\n}\r\n\r\nfunction normalizeY(y, bgSize) {\r\n\treturn y - bgSize.height <= 0\r\n\t\t? y + PADDING\r\n\t\t: y - bgSize.height - PADDING;\r\n}\r\n\r\nfunction origin(props, moreProps, bgSize, pointWidth) {\r\n\tconst { chartId, yAccessor } = props;\r\n\tconst { mouseXY, xAccessor, currentItem, xScale, chartConfig, width } = moreProps;\r\n\tlet y = last(mouseXY);\r\n\r\n\tconst xValue = xAccessor(currentItem);\r\n\tlet x = Math.round(xScale(xValue));\r\n\r\n\tif (isDefined(chartId) && isDefined(yAccessor)\r\n\t\t\t&& isDefined(chartConfig) && isDefined(chartConfig.findIndex)) {\r\n\t\tconst yValue = yAccessor(currentItem);\r\n\t\tconst chartIndex = chartConfig.findIndex(x => x.id === chartId);\r\n\r\n\t\ty = Math.round(chartConfig[chartIndex].yScale(yValue));\r\n\t}\r\n\r\n\tx = normalizeX(x, bgSize, pointWidth, width);\r\n\ty = normalizeY(y, bgSize);\r\n\r\n\treturn [x, y];\r\n}\r\n\r\nfunction helper(props, moreProps, ctx) {\r\n\tconst { show, xScale, currentItem, plotData } = moreProps;\r\n\tconst { origin, tooltipContent } = props;\r\n\tconst { xAccessor, displayXAccessor } = moreProps;\r\n\r\n\tif (!show || isNotDefined(currentItem)) return;\r\n\r\n\tconst xValue = xAccessor(currentItem);\r\n\r\n\tif (!show || isNotDefined(xValue)) return;\r\n\r\n\tconst content = tooltipContent({ currentItem, xAccessor: displayXAccessor });\r\n\tconst centerX = xScale(xValue);\r\n\tconst pointWidth = Math.abs(xScale(xAccessor(last(plotData))) - xScale(xAccessor(first(plotData)))) / (plotData.length - 1);\r\n\r\n\tconst bgSize = calculateTooltipSize(props, content, ctx);\r\n\r\n\tconst [x, y] = origin(props, moreProps, bgSize, pointWidth);\r\n\r\n\treturn { x, y, content, centerX, pointWidth, bgSize };\r\n}\r\n\r\nexport default HoverTooltip;\r\n"],"mappings":"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"}